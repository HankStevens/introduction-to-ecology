[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Basic Ecological Concepts and Data in R",
    "section": "",
    "text": "Preface\nThis book provides an activity-based approach introduction to the science and practice of ecology. It is designed to form the basis of an undergraduate general ecology course. It includes real-world assessment activities, and so answer keys are not generally available, even if they might be appropriate in some situations.\nEach chapter provides,\nEach chapter mixes (i) ecological content and (ii) coding practices. Students will get the most out of the content if they understand and accept this from the start. Avoiding one or the other reduces their ability to understand, appreciate, and use both.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#guidance",
    "href": "index.html#guidance",
    "title": "Basic Ecological Concepts and Data in R",
    "section": "Guidance",
    "text": "Guidance\nUse these tips to help reduce frustration and make things work better:\n\nThe book should be read and the code implemented in sequence. For example, you should complete chapter 1 before chapter 2, complete chapter 2 before chapter 3, and so on. That is for two reasons. First, you will learn things about R and your computer in earlier chapters that you may need to know for later chapters. This is especially true for the first few chapters. Second, you will gain ecological knowledge in earlier chapters that enrich your experience in later chapters.\nWhen the text provides an enumerated list or numbered bullet items (e.g., 1, 2, 3 or a, b, c), it is usually very important or even essential to do these steps in sequence. There will be times that it is impossible to succeed unless you do the steps in sequence.\nWhen the text provides a simple, unnumbered list, it is usually not important to consider these items as representing a sequence.\nI included a few sections entitled Overthinking. I stole this idea from Richard McElreath (McElreath 2020), and these are sections that you can skip on the first read, and are not essentially for getting things to work. They provide deeper, more detailed explanations than is typically required.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#other-books",
    "href": "index.html#other-books",
    "title": "Basic Ecological Concepts and Data in R",
    "section": "Other books",
    "text": "Other books\nMy other books include A Primer of Ecology using R and A Primer of Ecosystem Modeling. The former (Primer of Ecology) is designed primarily for beginning graduate students as a primer to theory in population and community ecology. It was first published with Springer in 2009, and the current GitHub version is quite updated. I use the latter (ecosystem modeling) when I co-instruct a graduate course led by colleagues who are real ecosystem ecologists (Drs. Melany Fisk, Mike Vanni, and Lesley Knoll).\nMazel tov!\n\n\n\n\nMcElreath, Richard. 2020. Statistical Rethinking: A Bayesian Course with Examples in R and Stan. Second Edition. Texts in Statistical Science. Boca Raton, FL: CRC Press.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "01-computer-setup.html",
    "href": "01-computer-setup.html",
    "title": "1  Computer setup and first R script",
    "section": "",
    "text": "1.1 Goals",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-computer-setup.html#goals",
    "href": "01-computer-setup.html#goals",
    "title": "1  Computer setup and first R script",
    "section": "",
    "text": "Learn about your computer and how to organize its files.\nInstall R, an open source programming language.\nBegin to use R effectively.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-computer-setup.html#background",
    "href": "01-computer-setup.html#background",
    "title": "1  Computer setup and first R script",
    "section": "1.2 Background",
    "text": "1.2 Background\nIn this project, you will begin to use tools for data exploration and analysis. This tools and your computer are really important for helping you make sense of our really complicated world. Ecology is way more complicated than physics or engineering, and the data are noisy and often unpredictable. We need to use computers to make sense of it.\nWe will use open source and free software to help us understand ecological systems. You will download and install R, known formally as the R programming language and environment. You will also install RStudio, an integrated development environment (IDE), designed to be used with R. The R interface looks a little different on Windows, Macs, and Linux computers. RStudio will allow us all share an identical appearance and user experience. You will use R by opening RStudio.\nIn this class, you will use the English language to write about ecology, and the R language to explore and analyze ecological data.\n\n1.2.1 Understanding you computer\nFirst, we need to make sure we know some basics about computers.\n\n\n1.2.2 Folders, directories, and directory structure\nOn your computer,\n\na folder is a place to put files and other folders,\n“a directory is a file system cataloging structure that contains references to other computer files, and possibly other directories.” (Wikipedia)\nA folder is a part of your computer’s directory system.\n\nIf you have not already done so, you need to organize your computer.\nDo these:\n\nMake different folders (or directories) for different classes that you are taking.\nMake different folders for different kinds of content (e.g., data, articles, your writing).\n\nIn addition,\n\ndo not use the Downloads folder to store anything important, and\ndo not mix personal content and course content.\n\nWatch one of these to help you understand how your computer is organized. This will save you hours of time and frustration throughout your life.\n\nFor Windows users (PCs)\nFor Mac users\nIf you are a Linux user, I am betting that you already know this stuff.\n\n\n\n1.2.3 The location of a folder or file: The Path\nA “path” is the complete location and name of a file, starting from the hard drive, down to the file or folder of interest. Here are a two examples:\n\n(Windows 11) C:/BIO209W\n(Mac) /Users/stevenmh/courses/209W/\n\nNote they both start big and get more narrow. On Windows, the directory for the harddrive is typically “C:” and on a Mac it is just “/”.\nHere are ways to find those paths.\n\n1.2.3.1 File paths in Windows 11 operating system\nOpen File Explorer, navigate to the file, and click the three-dot menu (…) in the top toolbar to select Copy path. Alternatively, right-click the file and select “Copy as path” (or “Show more options” then “Copy as path”) to paste the full location.\nHere are the fastest methods to find a file path on Windows 11:\n\nCopy as Path (Fastest): Right-click the file in File Explorer and select Copy as path. If you don’t see it, select “Show more options” first.\nTop Menu Option: Click the file, then click the three dots (…) in the top menu and select Copy path.\nAddress Bar Method: Navigate to the file in File Explorer, click the blank space in the address bar at the top, and it will highlight the full path, which you can copy with Ctrl+C.\nProperties Menu: Right-click the file, select Properties, and look at the “Location” field to see the folder path.\n\n\n\n1.2.3.2 File paths on Mac Tahoe operating system\nTo find a file’s path on a Mac, select the file in Finder and press Option-Command-C to copy the path directly. Alternatively, right-click (or Control-click) the file and select “Copy” while holding the Option key to change it to “Copy as Pathname”.\nOther Methods to Find File Paths:\n\nPath Bar: In Finder, select View &gt; Show Path Bar to see the file location at the bottom of the window.\nGet Info: Select the file and press Command-I, then look under “Where”.\nIn the Terminal app: Drag and drop the file into the Terminal window to display its full path.\n\n\n\n\n1.2.4 File types and file name extensions\nFile extensions are little tags at the end of file names taht identify the type of file it is. You will need to be able to see file extensions on your computer. A file extension is the little label at the end of a file name that comes after the dot, such as\n\n.jpg or .jpeg is the extension for JPEG image files.\n.docx is the extension for Microsoft Word document files.\n.txt is the extension for plain text files.\n.xlsx is the extension for Microsoft Excel files. You will work with these.\n.csv is the extension for Comma Separated Value text files - these can be produced by spreadsheet applications. You will work with these.\n.R is the extension for R scripts. You will work with these.\n\n\n1.2.4.1 Windows\nNote that, by default, Windows hides these from the user. Here is how we fix that on Windows.\nOn Windows 10, you need to make changes to see file extensions by revealing “hidden items”. Windows 10:\n\nOpen File Explorer; if you do not have an icon for this in the task bar; click Start, click Windows System, and then File Explorer.\n\n\n\n\nFinding File Explorer on Windows.\n\n\n\nClick the View tab in File Explorer\n\n\n\n\nView tab in File Explorer\n\n\n\nClick the box next to File name extensions to see file extensions.\nClick the box next to Hidden items to see hidden files.\n\nYou should now be able to see file name extensions (e.g., .docx, .R) and hidden files.\nWindows 11 has a similar, and slightly less complicated layout. In File Explorer, select “Show” and then “File extensions”.\n\n\n1.2.4.2 Macs\nTo show all file extensions in macOS (including the latest Tahoe version), open Finder, select Finder &gt; Settings (or Preferences, Command-,) in the top menu bar, click the Advanced tab, and check the box for “Show all filename extensions”.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-computer-setup.html#installing-r",
    "href": "01-computer-setup.html#installing-r",
    "title": "1  Computer setup and first R script",
    "section": "1.3 Installing R",
    "text": "1.3 Installing R\nArmed with a little knowledge of your computer, you now install R.\n\n1.3.1 What and Why\nWe will use the Open Source R programming language and environment for doing science, including,\n\nexploring data,\ntesting ideas, and\nmodeling dynamical systems like populations of rare and endangered species, disease dynamics, and ecosystems.\n\nYou need to download the application to get started.\n\nR is free.\nR runs on all operating systems.\nR is powerful.\n\n\n\n1.3.2 How-to videos (optional)\nThe following videos might be useful, but they are not required! The next sections describe (in words) how to install R and RStudio.\nOptional videos:\n\nInstalling R and RStudio\nSet up your computer and start to use R via RStudio\nSaving figures made with ggplot()\nIntroduction to ggplot2 (20 min)\n\n\n\n1.3.3 How-to instructions\n\nFind out what version of operating system (OS) your computer is using (e.g., Windows 10 or 11, or Linux Ubuntu, or Mac Sonoma, or other recent editions). This will help determine which version of R to use. If you are using a Mac, this also requires that you determine which version of processor or chip your computer uses (Intel processor vs. Apple M1 chip or higher). Check the processor or chip under “About this Mac” in the Apple icon menu in the upper left corner of your screen.\nGoogle R (just the letter “R”) to navigate to the R Project for Statistical Computing.\nFind the link in the left Task Bar for CRAN (Comprehensive R Archive Network).\nFind and navigate to a CRAN site near you (e.g., United States or Midwest US or Ohio). These are called mirrors because they are copies of each other.\nDownload and install the latest release of R for your operating system (Mac, Windows, or Linux).\nAs of January 2026, it was version 4.5.2. It is a single file to download. You should use whatever the latest version is.\nIn January 2026, it was worked like this:\n\nMac - select R-4.2.2.arm64.pkg (for the Apple M1, M2, etc. chip) or R-4.5.2-x86_.pkg (for the older Intel chip)\nWindows - select the “base” package, then “Download R-4.5.2 for Windows”.\nLinux - select your flavor, and follow instructions.\n\n\n\n\n1.3.4 Where\nR (and RStudio) will be installed along with all your other applications.\n\n\n1.3.5 Installing RStudio\nRStudio is an integrated development environment (IDE), designed to be used with R. Most importantly for us, it provides a graphical user interface (GUI) that appears identical on Windows, Mac, and Linux computers.\n\nNavigate online to the RStudio website.\nUnder Products find RStudio IDE.\nSelect and download the Open Source Edition (RStudio Desktop). You want the desktop version (not the server version).\nFollow instructions to install on your computer.\n\n\n\n1.3.6 R \\(\\neq\\) RStudio\nRStudio is an interface to R. When we use R in this class, we will use RStudio as our interface, but you need to realize that we are primarily using R. We don’t need RStudio to do the work, but it makes my job as instructor easier, and makes it a little easier for you as well. So, when you start to use R, just open RStudio, and it will load R for you.\nAs we said at the beginning, you will use the English language to write about ecology, and the R language to explore and analyze ecological data.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-computer-setup.html#set-up-two-folders-for-this-class",
    "href": "01-computer-setup.html#set-up-two-folders-for-this-class",
    "title": "1  Computer setup and first R script",
    "section": "1.4 Set up two folders for this class",
    "text": "1.4 Set up two folders for this class\n\nSet up a folder for this class. Call it “BIO209W”. Do not name it “BIO_209W” or “Bio209W” or “ecology”. Just “BIO209W”. It will help us. I don’t really care where you put this folder, but you should have a place for all of your classes, and you could put it there. Don’t put it in “Downloads”.\nNext, set up a subfolder inside BIO209W called “Rwork”. Do not call it “RWORK” or “R_work” or anything else - just “Rwork”. It will help us. A lot. Rwork will be your working directory, which is where R looks automatically for data and where it automatically puts output.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-computer-setup.html#working-in-r",
    "href": "01-computer-setup.html#working-in-r",
    "title": "1  Computer setup and first R script",
    "section": "1.5 Working in R",
    "text": "1.5 Working in R\nTo work in R in this class, we will open RStudio. It will open R for you.\n\n1.5.1 Set your “working directory”\nIn this section, we learn what the “working directory” is and how to set it.\nYour working directory is where R looks to find stuff by default. R can look anywhere you tell it to, but it looks automatically in your “working directory”.\nIn this class, you should always use “Rwork” as your working directory.\nI can find out where my working directory is by using getwd() to get my working directory:\n\ngetwd()\n\n[1] \"/Users/stevenmh/projects/intro_to_ecology\"\n\n\nThis tells me what R is using as my working directory right now. My current working directory will differ from yours.\nYou should run this code, and see what you get. What do you get when you run this code (getwd())?\nNext, use the “Session” in pulldown menu in RStudio to Set Working Directory and then Choose your working directory and always choose Rwork (which should be inside BIO209W).\n\n\n1.5.2 Create a project\nRStudio allows you to organize your work in projects. Here we create a new project that we will call Rwork.\nThis requires that you already have a folder called “BIO209W” and a subfolder in that called “Rwork”.\n\nIn RStudio, use the File menu to select “New Project”, and select “Existing Directory”.\nIn that dialogue, navigate to “Rwork”, and select “Open.”\nSelect “Create Project”.\n\nRStudio will now shift the working directory to your Rwork directory. You can see evidence of this: in the upper right pane which should have Rwork identified in the upper right corner, or in the lower right pane in the Files tab.\nFrom now on in this course, make sure that you are using this project. You can open R by clicking the “Rwork.proj” file in your Rwork directory, or opening RStudio, and selecting the Rwork project in the upper right corner.\n\n\n1.5.3 Scripts: Start and save a script\nGoal: Write a script in R and learn several important programming operations.\nAfter you have prepared your computer as above, you are ready to begin exploring and modeling data. We do that using scripts.\nA script is a plain text file that contains the code and and your own comments that you use to address your questions.\nThe following steps will let you accomplish the goal of this section. The video above showed me opening R with RStudio, and starting a new script.\nWriting comments Anything following a hashtag (#) is a comment and R ignores it. You and I will use lots of comments to ask questions of ourselves, and to describe what we are trying to do.\n\nUse the File menu in RStudio to start a New File, specifically, an R Script. This will open a file in the upper left of RStudio.\nwrite the following in the new script, and include the hashtags.\n\n\n## [title] e.g., My first R script in BIO 209W\n## [Date]\n## [your name]\n## [the full path to your Rwork directory]\n\nMake sure to start each comment with at least one hashtag, #, and remove the square brackets seen above.\nALL OF THE WORK YOU DO MUST BE IN A SCRIPT.\n\n\n1.5.4 Entering and running code\nTo enter code, place your cursor on any line in the script, and type, like this.\n\n-1:5\n\nTo run code, simply place you cursor anywhere on a line of code and hit Control-Enter or Control-Return or Command-return (Mac).\nTry it with this:\n\n-1:5\n\n[1] -1  0  1  2  3  4  5\n\n\nThis will pop up in the Console, which is the lower left pane in RStudio.\nWhat did this create? Do you get what I got above?\n\n\n1.5.5 Assignment operator\nW?hen we create something, we typically want to assign it to a labeled object. In this class, we will use an arrow to indicate that we are putting a creation into an object. We create the arrow on our keyboard using shift-comma and a dash (‘less than’ and a dash)\n\na &lt;- -1:5\n\nThis puts the series of integers from -1 to 5 into the object a.\n\n\n1.5.6 Examining objects\nIf we have an object, like a, how can we figure out what it is? There are several ways of doing that. The simplest is to “print” it out. This doesn’t mean that we print it on paper. Rather we are printing it to the console, like this:\n\n# show or 'print' a\na\n\n[1] -1  0  1  2  3  4  5\n\n\nAnother way is to look at its “structure”:\n\nstr(a)\n\n int [1:7] -1 0 1 2 3 4 5\n\n\nThis tells us that this is a vector of integers that is 7 elements long.\nAnother way is to look in the RStudio Environment pane in the upper right hand side of RStudio.\n\n\n1.5.7 Things you’ll find out about R\nIf you are not used to writing code (and nobody is born that way), here are some thing to keep in mind about R and about coding in general.\n\nComputers do exactly what you tell them. This is both frustrating and also satisfying.\nR does not know anything or do anything until you run the code. Typing or pasting code into a script is just the first step; you also need to run the code, with Control-return (Windows or Mac) or Command-return (Mac).\nA corollary of no. 5 is that you usually need to run lines of code in sequence. For instance, R won’t be able to run str(a) unless you previously defined a, such as a &lt;- -1:5 (this is because R is an interpreted language - R interprets it one line at a time).\nCase matters in R. R interprets a as something completely different than A.\nSpaces between things usually don’t matter in R. R interprets 2+3 the same as 2 + 3.\nSpace within things usually breaks them, just the way “thin” “gs” is not the same as “things”. For example, the pseudo-arrow we use in f &lt;- 9 is a thing. The compound symbol &lt;- means something different than &lt; -.\n\n&lt;- is the assignment operator and assigns values to objects.\n&lt; - means “less than, minus”, where 2 &lt; -3 tests whether 2 is less than minus 3 (it isn’t).\n\n\nTry it.\n\nf &lt;- 9\nf\n\n[1] 9\n\n\nNow f has the value of 9.\nTry this:\n\n2 &lt; -3\n\n[1] FALSE\n\n\nThat tested whether 2 is less than -3.\nMoving on….\nNow let’s create a set of 7 uniformly distributed random numbers that are between 0 and 1.\n\nb &lt;- runif(7, min=0, max=1)\nb\n\n[1] 0.40911941 0.74043324 0.63500304 0.58884755 0.21525272 0.88151916 0.06416091\n\n\nThese will differ every time you do this.\nNow we multiply each element in a times the corresponding elements in b.\n\n# multiply a and b\nab &lt;- a * b\n## Show a, b, and ab\na\n\n[1] -1  0  1  2  3  4  5\n\nb\n\n[1] 0.40911941 0.74043324 0.63500304 0.58884755 0.21525272 0.88151916 0.06416091\n\nab\n\n[1] -0.4091194  0.0000000  0.6350030  1.1776951  0.6457582  3.5260766  0.3208045\n\n\nYou can confirm at a glance that the first and second elements in a times the first and second elements in b equal the first and second elements in ab.\n\n\n1.5.8 Combining vectors into a data frame\nWe will use lots of data frames in this course. Think of a data frame as a kind of spreadsheet of data, in which every column has the same number of entries and every row is an observation comprising all of the variables across all the columns.\nHere is one way to create a data frame. We assign variables using “=”.\n\nd &lt;- data.frame(a=a, b=b, a_times_b = ab)\nd\n\n   a          b  a_times_b\n1 -1 0.40911941 -0.4091194\n2  0 0.74043324  0.0000000\n3  1 0.63500304  0.6350030\n4  2 0.58884755  1.1776951\n5  3 0.21525272  0.6457582\n6  4 0.88151916  3.5260766\n7  5 0.06416091  0.3208045\n\n\nYou could examine the structure of this data frame with str().\n\nstr(d)\n\n'data.frame':   7 obs. of  3 variables:\n $ a        : int  -1 0 1 2 3 4 5\n $ b        : num  0.409 0.74 0.635 0.589 0.215 ...\n $ a_times_b: num  -0.409 0 0.635 1.178 0.646 ...\n\n\nYou will also notice now that you can see all of our objects in the Environment pane, in the upper right of RStudio.\nYou can export data frames from R as well, and programmers call that “writing” a file. The command below will save our data frame as .CSV files that you could open in a spreadsheet application.\n\n# export or write a file\nwrite.csv(x=d, file=\"myDataframe.csv\", row.names=FALSE)\n# including row.names=FALSE prevents R from adding row names.\n\nThis should cause the data frame d to get saved to your working directory. Did it work for you?\n\n\n1.5.9 Plotting data\nNow let’s plot some data, including both points and lines connecting them.\n\n# type='p' is for points only\nplot(a, ab, type='p') \n\n\n\n\n\n\n\n\nR is well known for its graphics capabilities, and we will only just scratch the surface in this course.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-computer-setup.html#install-an-r-package",
    "href": "01-computer-setup.html#install-an-r-package",
    "title": "1  Computer setup and first R script",
    "section": "1.6 Install an R package",
    "text": "1.6 Install an R package\nR is open source, and its strength derives in part from the thousands of scientists creating extensions or add-on packages to do particular tasks. By itself, R can do amazing things. With thousands of contributed packages (as they are known), R’s capabilities have exploded.\nYou can add a package in a few ways, including.\n\nUse the Tools menu, select “install packages” and type the name of the package you want.\nuse a function, “install.packages(”[packagename]“), with quotes but without brackets.\n\nIn this class, you will need to install several packages. Let’s try installing “ggplot2”.\n\ninstall.packages(\"ggplot2\")\n\nThis will install ggplot2, and it will also install anything upon which ggplot2 depends. It will install all of its dependencies.\nOnce you have installed a package, it is on your computer for good. You do not have to install it again, although you may want to update it once in a while to stay current.\nNow let’s use the plotting functions in the ggplot2 package.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-computer-setup.html#load-and-use-an-r-package",
    "href": "01-computer-setup.html#load-and-use-an-r-package",
    "title": "1  Computer setup and first R script",
    "section": "1.7 Load and use an R package",
    "text": "1.7 Load and use an R package\nTo use a contributed package, we need to load it. This simply means waking it up, and putting its code in R’s working memeory. We do that with library().\n\nlibrary(ggplot2)\n\nHere we use ggplot() and geom_smooth() to plot our data, and add a fitted curve.\nWhen we use ggplot(), we tell it the name of our data frame and the variables we want to use go inside aes(), which stands for “aesthetics”. We also begin to add bells and whistles.\n\n## plot data and fit a curve\nggplot(data=d, aes(x=a, y=a_times_b)) + \n  geom_line() +\n  labs(x=\"a\", y=\"Product of a and b\")\n\n\n\n\n\n\n\n\nNote that with ggplot, we use the plus sign (+) to add elements to our graph.\n\n1.7.1 Saving your graphs\nWe can save this figure as well, in a variety of formats and sizes. By default, these are saved to our working directory, though we can change that if we want to.\n\nggsave(\"myPlot.png\")\n\nSaving 7 x 5 in image\n\nggsave(\"myPlot.jpg\", width=7, height = 3)\nggsave(\"myPlot.pdf\", width=3, height = 5)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-computer-setup.html#getting-help",
    "href": "01-computer-setup.html#getting-help",
    "title": "1  Computer setup and first R script",
    "section": "1.8 Getting help",
    "text": "1.8 Getting help\nR has a bit of a learning curve. What should you do if you get stuck? It all depends what sort of problem it is.\n\nFirst, ask a classmate.\nUse the Help tab in the lower right pane in RStudio. (Similarly, type ?mean in the Console to get help on the function mean().)\nAsk another classmate.\nAsk me.\nSearch online.\nDid I mention you could ask me?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-computer-setup.html#deliverables",
    "href": "01-computer-setup.html#deliverables",
    "title": "1  Computer setup and first R script",
    "section": "1.9 Deliverables",
    "text": "1.9 Deliverables\nFor this assignment, upload to the LMS three files that you created:\n\nmyPlot.png\nmyDataframe.csv\nthe R script, into which you wrote all your code.\n\nThis file must be written in R/RStudio, and the name must end with the file name extension, “.R”, such as “Stevens_script_1.R”,\ncomments, including at least a title, the date, your name, and the path to your Rwork folder.\n\n\nCongratulations. C’est fini!",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Computer setup and first R script</span>"
    ]
  },
  {
    "objectID": "01-trees_and_people.html",
    "href": "01-trees_and_people.html",
    "title": "2  Environmental Justice: How income relates to environment.",
    "section": "",
    "text": "2.1 Background\nThe types of places that organisms live–their habitats–depends on a variety factors. Habitat selection, the selection of particular habitats, results from real and perceived tradeoffs between the benefits from foraging and reproducing versus perceived risks of mortality (Stephens and Krebs 1986; Morin 1999).\nIn addition to selecting their habitats, organisms also construct elements of their own habitats, including nests and burrows, as well as broader habitat alteration. This is known as niche construction (Odling-Smee and Erwin 2013). Beavers build dens and dams, birds and wasps build nests, and bacteria, ants, and humans all construct elaborate multi-layered cities of thousands or millions of individuals. At the same time, organisms often damage the very habitats they create, through over-consumption of resources and over-production of waste products.\nWe know a great deal about how our own species (H. sapiens) construct elements of their own habitats. We also know a lot about how we migrate and disperse from place to place. Nonetheless, we have a lot to learn about our own species, and, in particular, about which factors determine the our preferred habitats and determine the changes we make to those habitats.\nEconomic wealth seems to influence many of choices by H sapiens, including our preferred habitats. Ed Wilson (1984), a famous evolutionary biologist, have proposed the Biophilia hypothesis, that humans love nature. Biomedical researchers have shown that we are happier and heal from injury and illness faster when we have access to plants and to the outdoors (Franklin 2012). If wealth generally gives us greater access to what we want, will wealthier people more often put themselves in closer connection to nature?\nSpecific socioeconomic data about H. sapiens populations may be particularly useful understanding both the causes and consequences of relations between wealth and nature. Wealth can be measured in a variety of ways. Median income, and percent of the population below the poverty line are common ways to measure the average wealth of individuals or small family groups.\nSpecific data about our landscapes maybe be particularly useful in generating ecological understanding of H. sapiens. Tree cover is the two-dimensional coverage of tree canopies that you would perceive in an aerial photo in seasons when trees have their leaves. Tree cover is relatively easy to measure from satellite imagery. Temperature, or the heat experienced by residents, can be a serious problem in urban areas because they create heat “islands”. Urban heat islands are areas which tend to absorb more solar radiation than would a natural landscape and then re-radiate this as heat experienced by its human and non-human residents. During heat waves, residents in urban areas who are especially vulnerable can suffer severe heat exhaustion or death. Some urban areas tend to get much hotter than others, and it is often related to tree cover and green space generally.\nTrees provide enormous ecosystem service benefits, including to help mitigate pollution via uptake of carbon dioxide and carbon monoxide (CO\\(_2\\) and CO) and other greehouse gases. Trees can also help reduce pollutants that cause direct negative effects on human health, such as fine and ultrafine particulate matter (PM\\(_{2.5}\\), PM\\(_{0.1}\\)).\nIn this research project, we will use freely available online data to address whether there is an association between wealth and the wild. Specifically, we will address whether, if we compare different geographic locations, will we see a relationship between the median income of an area, and the percent cover of trees? The data we collect will allow us to explore a variety of related ideas, but we will start with testing Wilson’s biophilia hypothesis, which predicts that humans love nature. We will test my corollary of this, that humans who have the greatest degree of freedom of choice (the wealthy) will tend to live in areas with the greatest connection to Nature (a lot of trees).\nView your mission here:\nor here:",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Environmental Justice: How income relates to environment.</span>"
    ]
  },
  {
    "objectID": "01-trees_and_people.html#methods",
    "href": "01-trees_and_people.html#methods",
    "title": "2  Environmental Justice: How income relates to environment.",
    "section": "2.2 Methods",
    "text": "2.2 Methods\nWork in pairs. Share introductions with someone and get to work.\nWe will collect data on tree cover (%), heat, and wealth using two different platforms:\n\nTree Equity Score website\nOurTrees application in i-Tree\n\nThe first of these two platforms, Tree Equity Score, gives fairly detailed information on cities over 50,000 residents in size. It provides information related to environmental justice, including levels of poverty, tree cover, and heat. Our second data source is from i-Tree.org and it provides fairly detailed information about tree cover and the ecosystem services they provide. (Ecosystem services are features of ecosystems that benefit humans, such as storm water protection, and shade for buildings). i-Tree also provides median household income.\n\n2.2.1 Instructions\nTree Equity Score data\n\nGo to our class Google Sheet for Tree Equity Score cities, and enter the name of a city (pop. &gt; 50,000) that you will investigate. It must be different than what anyone else has selected. Add your name to your selected city.\nGo to the Tree Equity Score website.\nSearch for your city.\nFind the data for the city: click on the map inside the area of your city. Note that a map will typically display more than just your city. It will also display adjacent regions. For instance, the map for “Cincinnati, OH” displays Hamilton County and Covington, KY. Selecting an area will cause a data summary window to pop up on the left side. Confirm that when you click on an area of the map, it is inside the city you intended.\nSelecting an area link to a Municipal Report. This report provides information for the city as a whole. Confirm that when you click on an area of the map, it is inside the city you intended. Select the link, Municipal Report.\nPick the data most relevant to our question: adjust the setting for the right-hand column graph to show Tree Cover (%) vs. People in Poverty %. You will use this column graph in addressing our overall question.\nThe Municipal Report provides a Tree Equity Score, urbanized area population estimate, percent seniors, and a percentage of people in poverty. Enter these into the Google Sheet. Add one Miami uniqueID per group to each observation (row).\nSave the web page as a PDF, and name it with the city name and “TES” (e.g., “Cincinnati_TES.pdf”). If you would like assistance saving the PDF, read the instructions under the button “Share report -&gt;”. Make sure to close the instructions before you save the page. This file will be a record of your data.\nMake sure that you have entered the Tree Equity score and poverty percentage in the Google Sheet, and that you saved to your own computer your column graph of tree cover vs. percent of people in poverty.\n\nOurTrees app, in i-Tree\n\nOurTrees application in i-Tree. Select a location in which you are interested. Start with any location name, and select “Search”. The app will show you a location. If you would like to, you can change the location by simply clicking somewhere else on the map. You can choose either Street view or Satellite view (the data will be the same).\nEnter the name of your selected location into our class a new spreadsheet, Google Sheet for OurTrees.\nIn the OurTrees app, select “Get Results! -&gt;”.\nFrom the “Benefits” tab, collect data on tree canopy cover (%), annual uptake of CO\\(_2\\) equivalents and 2.5 micron particulate matter (PM\\(_{2.5}\\)). Enter these into the OurTrees Google Sheet.\nFrom the “Community” tab, collect data on total population size, number of seniors (&gt;64), percent minority, median annual income, and percent impoverished. Enter these into the OurTrees Google Sheet.\nRepeat the above steps for nine more locations anywhere in the world. Your locations must be different than what anyone else has selected in the OurTrees spreadsheet. Add one Miami uniqueID per group to each observation (row).\n\n\n\n2.2.2 Graphing data to assess our predictions\nI argued that the Biophilia Hypothesis leads to the prediction that tree cover will correlate positively with wealth. To evaluate this prediction, we should make a graph in which wealth is on the x-axis (horizontal axis) and tree cover is y-axis (vertical axis).\nA couple of minor points: (1) Our prediction also implies that we should see a negative relation between poverty and tree cover. (2) We typically assume that the variable on the y-axis is a response to the variable on the x-axis, that is, that the x variable is causing variation in the y variable.\nGiven our data are continuous variables rather than categories, we should start by making a scatterplot of median income (x) vs. tree cover (y).\nAs the semester progresses, you will find R is very useful. Below, I provide you with code for an R script to easily make this graph.\n\n# if needed, install these packages\n# install.packages(\"googlesheets4\")\n# install.packages(\"ggplot2\")\n\n# load these packages\nlibrary(googlesheets4)\nlibrary(ggplot2)\n\n# Import data. \n# This code will require that you have permission to access our G-Sheet.\n# You may be asked to select various options and/or sign in to your\n# Miami Google account.\n\n# The function read_sheet() requires a Google Sheet URL in quotes, and\n# allows you to skip lines that are not data, \n# such as a table description.\n\nd &lt;- read_sheet(\"https://docs.google.com/spreadsheets/d/1uYCuTziJiLNvVOQ9Q65BxdWcNgDF6EnF8L1T3O_yATw/edit#gid=0\",\n                skip=2)\n\n✔ Reading from \"iTree_OurTrees\".\n\n\n✔ Range '3:10000000'.\n\n# Uncomment to show us the names of the variables\n# names(d)\n\n# make a scatterplot\nplot1 &lt;- ggplot(data=d, aes(x=Median_Income, \n                   y=Tree_canopy_cover, \n                   label=`City (only)`)) + geom_text() +\n  labs(y=\"Tree cover (%)\", x=\"Median income\", title=\"No relation twixt tree cover and income?\")\n\nggsave(\"myCoverIncome_text.png\", plot=plot1, width=10, height = 10)\n\nplot2 &lt;- ggplot(data=d, aes(x=Median_Income, \n                   y=Tree_canopy_cover, \n                   label=`City (only)`)) + \n  geom_point() +\n  labs(y=\"Tree cover (%)\", x=\"Median income\", title=\"No relation twixt tree cover and income?\")\n\n# save the figure (dimensions in inches)\nggsave(\"myCoverIncome_points.png\", plot=plot2, width=7, height = 7)\n\nHere is a subset of data I collected on the places where members of my family lives.\n\nd10 &lt;- d[1:10,]\nmyPlot &lt;- ggplot(data=d10, aes(x=Median_Income, \n                   y=Tree_canopy_cover, \n                   label=`City (only)`)) + geom_text() +\n  labs(y=\"Tree cover (%)\", x=\"Median income\", title=\"No relation twixt tree cover and income?\")\n\nmyPlot\n\n\n\n\n\n\n\nFigure 2.1: The noisy but perhaps positive relation between percent of an location covered in trees and the median income of that location.\n\n\n\n\n\nRefer to the scatterplot of my data (Figure 2.1). What do we find? Discuss the following questions with your colleagues, and propose and explain some possible answers.\n\nIs there a relationship that is consistent with our hypothesis? Does tree cover increase with income?\nNotice the cities that I selected. What else do you know about these locations, aside from income, that might influence tree cover?\nWhat else might be going on that helps create this relation or might obscure a stronger relation?\nAfter looking at these data, would you want to select locations in a different way?",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Environmental Justice: How income relates to environment.</span>"
    ]
  },
  {
    "objectID": "01-trees_and_people.html#deliverables",
    "href": "01-trees_and_people.html#deliverables",
    "title": "2  Environmental Justice: How income relates to environment.",
    "section": "2.3 Deliverables",
    "text": "2.3 Deliverables\nResults and discussion\n\nIn one document, put two figures side-by-side:\n\nyour bargraph of % tree cover vs. % people in poverty (copied from the Tree Equity site) side-by-side, and\nyour scatterplot of tree cover vs. median income that you made using everyone’s data, based on the iTree/OurTrees website that you shared in the Google spreadsheet.\ninclude a figure legend that states what the graphs are in a way that is intelligible to a naive reader.\n\nProvide a brief explanation of your findings, including\n\nthe results described in a factual manner, without interpretation,\nan explanation of whether the results are consistent with the biophilia hypothesis, and\na new question that emerges due to the inconsistencies between the data and the hypothesis; explain why this question is a logical extension of your current results and interpration.\n\n\n\n\n\n\nFranklin, Deborah. 2012. “Nature That Nutures.” Scientific American 306 (3): 24–25.\n\n\nMorin, P J. 1999. Community Ecology. Malden, MA: Blackwell Science, Inc.\n\n\nOdling-Smee, J, and DH Erwin. 2013. “Niche Construction Theory: A Practical Guide for Ecologists.” The Quarterly Review of Biology 88 (1): 3–28. https://www.jstor.org/stable/10.1086/669266.\n\n\nStephens, D W, and J R Krebs. 1986. Foraging Theory. Edited by J. R. Krebs and T. H. Clutton-Brock. Monographs in Behavior and Ecology. Princeton, University Press, Princeton, NJ, USA: Princeton University Press.\n\n\nWilson, Edward O. 1984. Biophiia. Cambridge, MA: : Harvard University Press.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Environmental Justice: How income relates to environment.</span>"
    ]
  },
  {
    "objectID": "02-global_temp_anomalies.html",
    "href": "02-global_temp_anomalies.html",
    "title": "3  Physical Environment: A Fate of Earth",
    "section": "",
    "text": "3.1 Goals\n…in which we reveal part of our climate reality.\nIn this assignment, you will",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Physical Environment: A Fate of Earth</span>"
    ]
  },
  {
    "objectID": "02-global_temp_anomalies.html#goals",
    "href": "02-global_temp_anomalies.html#goals",
    "title": "3  Physical Environment: A Fate of Earth",
    "section": "",
    "text": "Learn about the history of our perspective on global warming.\nUse R to display estimates of global temperature anomalies.\nDescribe the current temperature trajectory.\nCompare and contrast changes in temperature between humans and Earth.\nVideo lecture on global warming and climate change: TBA\nBackground reading: Hansen et al. (2012). Perception of climate change. *Proceedings of teh National Academy of Sciences, U.S.A.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Physical Environment: A Fate of Earth</span>"
    ]
  },
  {
    "objectID": "02-global_temp_anomalies.html#background",
    "href": "02-global_temp_anomalies.html#background",
    "title": "3  Physical Environment: A Fate of Earth",
    "section": "3.2 Background",
    "text": "3.2 Background\nThe year that you were born was much warmer than usual–and it won’t ever be that cool again in your lifetime.\nEarth is getting warmer due to human activities, it will push it well beyond what earth has experienced in hundreds of thousands of years. How and why Earth is warming has been known for many decades. In the early 1980’s, even Exxon’s scientists accurately predicted the global warming that has occurred because we failed to act to change our behavior.1\nIn this exercise, you’ll graph data from the National Centers for Environmental Information, part of NOAA (US Dept of Commerce). These temperatures are anomalies from a long term mean. The reference they use is the period from 1951-1980.\nUsing the R script, you will construct a 95% confidence interval on expected mean surface anomalies. A “95% confidence interval of a mean” is an interval, if so constructed, that would tend to include the true mean about 95% of the time, given many, many repeated experiments conducted under identical conditions. It is based on frequentist statistical methods. It is actually pretty difficult to interpret, but it is a standard measure of uncertainty. You will construct such an interval for past and future global surface temperature anomalies.\nOverthinking: Frequentist statistical methods (those that you will all attempt to learn in intro stats class) give you a P-value, which is the probability of your data or more extreme data, given that your null hypothesis is true (i.e., your model is correct). That’s weird. The data are real - they don’t need a probability. A 95% confidence interval is an interval that we construct in a way where we would capture a “true” effect 95% of the time we repeat the same experiment under the same conditions. In contrast, Bayesian statistics would give us what we actually want: the probability that our model or hypothesis is correct, given our data. That is called conditional probability and is what a Bayesian analysis would give you. We might do that later in the course.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Physical Environment: A Fate of Earth</span>"
    ]
  },
  {
    "objectID": "02-global_temp_anomalies.html#activity",
    "href": "02-global_temp_anomalies.html#activity",
    "title": "3  Physical Environment: A Fate of Earth",
    "section": "3.3 Activity",
    "text": "3.3 Activity\nIn this activity, you will download and import data, and then make a forecast about future temperatures. That forecast will include an expected value and a measure of uncertainty. The expected value is the most likely value, but we also acknowledge that any time we estimate a most-likely value that there is always uncertainty.\nBelow, we set up or work environment, load data, work with data, and then save deliverables. This work flow will be natural after a while.\n\n3.3.1 Set up\nFirst, if you have not already done so, create a script file that you will call global_anomalies_YourUniqueID.R.\nAfter starting a script, we always select the appropriate project and working directory. I do this by…\n…glancing at the upper right corner:\n\n\n\nRStudio shows which project you are using in the upper-right corner\n\n\n…and by looking in the File tab in the lower right pane - that should be your working directory, which should be Rwork.\nThe next thing we do is load packages that we know we will need. Remember, you only need to install a package onto your computer once. We load contributed packages in each session that we need them. In this course, you should always load tidyverse, at a minimum.\n\n## load R packages\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\n\n\n3.3.2 Import data\n\nGo to our class data repository, and download global_surface_anomalies_2025.csv.\nMake sure the file remains in the same simple format, “comma separated values” (.csv).\nPut global_surface_anomalies_2025.csv in your working directory, Rwork.\nOpen global_surface_anomalies_2025.csv in a spreadsheet application. Don’t save the file in the spreadsheet application. Do not save it in the spreadsheet application because it will try to change the format.\nWith the file open, learn what is on\n\nthe first three lines\nthe fourth line\nthe remaining lines.\n\nDo not save the file in the spreadsheet application. Just close and don’t save it - it will still be there, unchanged.\nContinue to make sure the file remains in the same simple format, “comma separated values” (.csv).\n\nWe import or “read in” the data so that R can work on it. Here we put it in an object called temps. We skip lines in the file\n\n# read in data\ntemps &lt;- read.csv(file = \"global_surface_anomalies.csv\", # full file name\n                  skip=3, # skip these lines because they contain metadata.\n                  header = TRUE # Tell R that the first row is column namaes\n                  ) # last parenthesis\n\n\n\n3.3.3 Finding out information about the temperature anomalies\nNext we take a peek at the data with a summary.\n\nsummary(temps)\n\n      year          deg_C         \n Min.   :1880   Min.   :-0.48000  \n 1st Qu.:1916   1st Qu.:-0.20000  \n Median :1952   Median :-0.04500  \n Mean   :1952   Mean   : 0.06771  \n 3rd Qu.:1987   3rd Qu.: 0.28000  \n Max.   :2023   Max.   : 1.17000  \n\n\nThis shows us the minimum, maximum and mean of each numeric variable.\nIt also shows us the 1st, 2nd, and 3rd quartiles. The median is the 2nd quartile. Quartiles are three divisions in ranked data, such they divide the data into four equal parts, or quarters. The 1st quartile is the value that divides the lowest 25% of the values from the larger values. The 2nd quartile (i.e.) is the value that divides the lower 50% from the upper 50% of the observations. The 3rd quartile is the value that divides the highest 25% of the observations from the lower values.\n\n\n3.3.4 Minimum and maximum\nI’d like to know when the minimum and the maximum occurred. To find this out, I’ll use a two step process: I will find the min and the max, and then I will use those to take a subset of the data frame where the anomaly is equal to either the minimum or equal to the maximum.\nFirst, I find the minimum and the maximum.\n\n## get the min and max\nmin.anomaly &lt;- min(temps$deg_C)\nmax.anomaly &lt;- max(temps$deg_C)\n\nNow, I will use these to take a subset of the data frame where the anomaly is equal to either the minimum or equal to the maximum. The “OR” operator is the vertical line that programmers call a pipe. On your keyboard, it is above the return or enter key.\n\n## use the min and the max\n# note the two equal signs, a pipe, and then two more equals signs.\nsubset(temps, deg_C==min.anomaly | deg_C==max.anomaly ) \n\n    year deg_C\n30  1909 -0.48\n144 2023  1.17\n\n\nThese show us all of the entries in our data that the anomaly is equal to the minimum OR equal to the maximum.\n\n\n3.3.5 Using a year\nHere I find out the average temperature anomaly in the year I was born. I want YOU to find out the anomaly in the year you were born.\n\n## Find the anomaly in the year you were born\nsubset(temps, year==1960) # use your year with two equal signs\n\n   year deg_C\n81 1960 -0.03\n\n\nIn my birth year, it was just a touch below the 1951-1980 average.\n\n\n3.3.6 Plotting information\nHere we are going to start visually examining the anomalies.\nWe will create a linegraph using ggplot(). Our first step will create the graph, but it won’t display it right away. I include comments on each line to remind you what everything does.\n\n## we will create a plot object and stick it in \"p\"\np &lt;- ggplot(data=temps, # the data frame to use\n       ## aes() stand for \"aesthetics\"\n       aes(x=year, y=deg_C), # define x and y variables to plot\n       ) + # closing parenthesis and add a plus sign to add another graphical element\n  geom_line() # the type of graph to plot using x and y\n\nIf you do this correctly it will seem as though nothing happened. If you did something wrong, you might get an error message in the console. If R can’t find the function “ggplot”, that is because you didn’t load tidyverse (or ggplot2 which is a subset of tidyverse). Another common error is an incomplete statement that might come from a missing parensthesis or something. In that case, R might think that you are not finished making your statement and it will keep adding plus signs so that you can finish your coding statement.\nNow we display the graph.\n\np\n\n\n\n\n\n\n\n\nHere we add a trend line using a fancy statistical smoothing technique. By default, it will include a grey uncertainty region.\n\n## add a trend line\np + geom_smooth(linetype=\"dashed\") \n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\n\n\n\n\nHere we add prettier, more descriptive labels. Add a line for the anomaly in 2002.\n\n# first find the anomaly in 2002\nanomaly.2002 &lt;- temps$deg_C[temps$year==2002]\nanomaly.2002\n\n[1] 0.63\n\np + geom_smooth() + \n  labs(\n    y=\"Surface temp. anomaly (deg C)\", \n    subtitle=\"Relative to average 1951-1980\"\n    ) +\n  geom_hline(yintercept = anomaly.2002, linetype=3)\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Physical Environment: A Fate of Earth</span>"
    ]
  },
  {
    "objectID": "02-global_temp_anomalies.html#predicting-future-anomalies",
    "href": "02-global_temp_anomalies.html#predicting-future-anomalies",
    "title": "3  Physical Environment: A Fate of Earth",
    "section": "3.4 Predicting future anomalies",
    "text": "3.4 Predicting future anomalies\nMajor goals of science are understanding and prediction. We could spend a long time discussing the connection between these two, but form now, we just want to forecast want our future might look like.\nThe statistical details of this are way beyond this course, and they are not even the way you would do it if you were serious about. Nonetheless, it won’t be too far off, and the intuitive part applies generally to making any set of predictions. We will merely ask the computer to do some math to accomplish the following:\n\ncreate an educated guess for the temperature trend. This will include,\n\nuncertainty that comes from how much the anomalies bounce up and down from year to year, and\na trend that comes from averaging nearby values.\ninformation that nearby years may be more similar to each other than years that are really far apart.\n\ngiven the observed uncertainty and the trend, make an educated guess for future obervations, taking into account that each future year adds uncertainty that we can only guess at.\nMake a figure showing the future forecast.\n\nSo, lets start with step one. and create a statistical model of the observations. We start by loading another package.\n\n## Load a necessary R package\nlibrary(mgcv) # stands for \"Mixed Generalized Additive Model Computation Vehicle\"\n\nLoading required package: nlme\n\n\n\nAttaching package: 'nlme'\n\n\nThe following object is masked from 'package:dplyr':\n\n    collapse\n\n\nThis is mgcv 1.9-3. For overview type 'help(\"mgcv-package\")'.\n\n\nNow we ask R to fit the model. Don’t worry about the details of the code. You can ask me if you are interested.\n\n## Create the model\nmod &lt;- gamm(deg_C ~ s(year),  # \"deg_C as a function of year\n            data=temps, # data frame\n          correlation = corCAR1(form=~year), # specify autocorrelation among samples\n          method=\"REML\" # fit using restricted maximum likelihood\n          )\n\nNext we have to decide what years we want predictions for. Let’s go for 50 more years, to 2072\n\n## years for fit and prediction\nyears = data.frame(year=1880:2072)\n\nNow we apply the model to past and future years and make a data frame and keep the uncertainty estimates it generates. We also combine our specified years with the model.\n\n## include uncertainty with se.fit = TRUE\npreds &lt;- data.frame(\n  predict(mod$gam, newdata=years, type=\"response\", se.fit=TRUE) \n  )\n\n# combine columns of data frames\nmy.predictions &lt;- cbind(years, preds)\n\nLet’s look at the first three rows of what we’ve made.\n\n# first three lines , and all columns\nmy.predictions[1:3, ]\n\n  year        fit     se.fit\n1 1880 -0.1871517 0.06106168\n2 1881 -0.1918986 0.05677760\n3 1882 -0.1966483 0.05272457\n\n\nThis shows that the first column is the year, the second (fit) is the expected local estimate, and the third (se.fit) is the estimate of the uncertainty, which is the standard error of the expected value.\nNow we’ll create 95% confidence intervals for each year. Confidence intervals are intervals which would contain the “true” value (if there is one) a specified proportion of times, if you repeated the experiment a really, really large number of times. Ninety-five percent confidence intervals exclude the lowest 2.5% and the upper 97.5% regions.\n\n### Create 95% confidence intervals\ncrit.t.low &lt;- qt(0.025, df = df.residual(mod$gam))\ncrit.t.high &lt;- qt(0.975, df = df.residual(mod$gam))\n\n### this requires that you loaded the tidyverse package\nmy.predictions &lt;- my.predictions %&gt;% # my data\n  ## transform the data set to include two new columns\n  transform(\n    upper.conf.lim=fit + (crit.t.high * se.fit),\n    lower.conf.lim=fit + (crit.t.low * se.fit))\n### \n## view the first three rows\nmy.predictions[1:3, ]\n\n  year        fit     se.fit upper.conf.lim lower.conf.lim\n1 1880 -0.1871517 0.06106168    -0.06640801     -0.3078953\n2 1881 -0.1918986 0.05677760    -0.07962626     -0.3041709\n3 1882 -0.1966483 0.05272457    -0.09239046     -0.3009061\n\n\nNow we see we’ve added upper and lower confidence intervals. Next we’ll create a graph of our predictions, using several particular graphical features.\n\n## basic data and x, y values\ng &lt;- ggplot(data = my.predictions, aes(x = year, y = fit)) +\n  ## adding a wide region or band (a ribbon)\n  geom_ribbon(aes(ymin = lower.conf.lim, ymax = upper.conf.lim, \n                  x = year), \n              alpha = 0.2, fill = \"black\") + \n  ## add the expected local trend\n  geom_line() +\n  ## adding the points for each year\n  geom_point(data = temps, mapping = aes(x = year, y = deg_C),\n               inherit.aes = FALSE) + \n  ## add a better label for the y axis\n  labs(y = \"Global temp. anomaly\")  \n  ## simplify the image\n\nNow we show the graph we created.\n\ng\n\n\n\n\n\n\n\n\n\n\nThe grey area represents the 95% confidence interval for the trend observed years, and also for the trend in the future years. It gets wider because each year’s uncertainty compunds with the next year’s uncertainty. [Your figure will look a little different the this one.]\nFinally, we save your figure. This is the graph you should use for your assignment.\n\n## Save a PNG file to your working directory\n## THIS IS THE GRAPH TO INSERT INTO YOUR ASSIGNMENT\nggsave(\"Global_temps.png\", # name for your figure\n       plot=g, ## identify which graph you want to save,\n       height=5, width=5)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Physical Environment: A Fate of Earth</span>"
    ]
  },
  {
    "objectID": "02-global_temp_anomalies.html#does-earth-have-a-fever",
    "href": "02-global_temp_anomalies.html#does-earth-have-a-fever",
    "title": "3  Physical Environment: A Fate of Earth",
    "section": "3.5 Does Earth have a fever?",
    "text": "3.5 Does Earth have a fever?\nIn this last section, we ask whether Earth’s temperature may be a little too high by comparing it to a human who has a fever.\nFirst we calculate the percent increase in temperature for Earth over the past 70 years and a human experiencing a serious fever.\nAverage temperature for humans is 37 C, and a serious fever is considered 39 C, so an increase of 2 C.\nEarth’s 20th century average temperature is 13.9 C. Let’s calculate the increase since 1950.\n\n## First we take a subset of our data set.\na &lt;- subset(temps, year==1950) \nb &lt;- subset(temps, year==2022)\nincrease &lt;- b$deg_C - a$deg_C\nincrease\n\n[1] 1.06\n\n\nNext we calculate these increases (fever and global warming) as percentage change.\n\n## percent increase for Earth\nperc.Earth &lt;- increase / 13.9 * 100\n\n## percent increase for humans\nperc.fever &lt;- 2/37 * 100\n\nperc.Earth; perc.fever\n\n[1] 7.625899\n\n\n[1] 5.405405\n\n\nSo, what do you think? Does Earth have a fever? In what ways do you think comparing temperature variation of Earth to that of a human is or is not a useful thing to do.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Physical Environment: A Fate of Earth</span>"
    ]
  },
  {
    "objectID": "02-global_temp_anomalies.html#questions-to-answer",
    "href": "02-global_temp_anomalies.html#questions-to-answer",
    "title": "3  Physical Environment: A Fate of Earth",
    "section": "3.6 Questions to answer",
    "text": "3.6 Questions to answer\n\nWhat is a temperature anomaly?\nIn the file “global_surface_anomalies.csv”, what is on\n\nthe first three lines?\nthe fourth line?\nthe rest of the data?\n\nWhat are the minimum, median, and maximum anomalies?\nWhen (in what year) were the minimum and maximum anomalies?\nWhat was the global average surface temperature anomaly in the year you were born? Provide the year and the anomaly.\nWhat does the grey band in the figure represent, and why does it get wider in future years?\nExplain whether you think Earth currently does or does not have a fever, and whether comparing temperature variation of Earth to that of a human is or is not a useful thing to do.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Physical Environment: A Fate of Earth</span>"
    ]
  },
  {
    "objectID": "02-global_temp_anomalies.html#deliverables",
    "href": "02-global_temp_anomalies.html#deliverables",
    "title": "3  Physical Environment: A Fate of Earth",
    "section": "3.7 Deliverables",
    "text": "3.7 Deliverables\nTurn these into the relevant Canvas assignment before the due date.\n\nFirst, put all your answers, including your graph with the confidence interval, into a .doc or .docx file and make fit on a single page. Turn in your answers and your graph to the relevant Canvas assignment Make sure that your name is on the file in the header!\nSecond, turn in your R script, named global_temps_YourUniqueID.R as a second file. This must NOT be a Word document. It must be a .R file.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Physical Environment: A Fate of Earth</span>"
    ]
  },
  {
    "objectID": "02-global_temp_anomalies.html#footnotes",
    "href": "02-global_temp_anomalies.html#footnotes",
    "title": "3  Physical Environment: A Fate of Earth",
    "section": "",
    "text": "Exxon suppressed these internal reports, and they became available only due to a lawsuit.↩︎",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Physical Environment: A Fate of Earth</span>"
    ]
  },
  {
    "objectID": "03-liana-phys.html",
    "href": "03-liana-phys.html",
    "title": "4  Individual responses to the environment: What makes lianas relatively successful in stressful habitats?",
    "section": "",
    "text": "4.1 Goals\nIn this assignment, you will",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span>"
    ]
  },
  {
    "objectID": "03-liana-phys.html#goals",
    "href": "03-liana-phys.html#goals",
    "title": "4  Individual responses to the environment: What makes lianas relatively successful in stressful habitats?",
    "section": "",
    "text": "Investigate reasons for the unreasonable success of lianas.\nDevelop and use your understanding of plant growth and responses to water deficits to help make predictions about the relative success of lianas and trees.\nEvaluate scientific hypotheses and predictions by (i) enhancing your data visualization skills using ggplot(), and (ii) making graphs of your own design.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span>"
    ]
  },
  {
    "objectID": "03-liana-phys.html#background",
    "href": "03-liana-phys.html#background",
    "title": "4  Individual responses to the environment: What makes lianas relatively successful in stressful habitats?",
    "section": "4.2 Background",
    "text": "4.2 Background\n\nWatch videos on responses by organisms to temperature and water (videos 1e and 1f)\nDownload Smith-Martin et al. (2019), which is available in our PDF archive. Read the introduction to help you understand the context of this chapter.\n\nThe term “liana” refers to tropical woody vines, which can be very common and can account for as much as 25% of the woody plant biodiversity in some tropical forests. They achieve some of their highest abundance in seasonal subtropical forests Figure 4.1. These are regions with distinct wet and dry seasons; why are lianas successful in these seasonal subtropical forests?\n\n\n\n\n\n\n\n\n\n\n\n(a) Lianas across a gradient\n\n\n\n\n\n\n\n\n\n\n\n(b) Lianas vs. trees\n\n\n\n\n\n\n\nFigure 4.1: Lianas increase in abundance and grow better than trees in the the dry season in seasonal subtropical forests. Figures 1-3 from Schnitzer (2005).\n\n\n\nOne possible explanation for lianas’ success in sesonal forests might have to do with their physiology and architecture (Schnitzer 2005). Lianas may possess an unusual ability to regulate their water potential (Smith-Martin et al. 2019). In order for plants to grow and reproduce, they undergo photosynthesis, and maintaining a less negative water potential may help lianas perform better than trees in seasonal environments. (See video lectures on soils, plant photosynthesis, water potential, and heat regulation). This ability may come from the depth at which their roots grow and forage for water, their very large vessels (xylem) that carry water up through the stems, or it could be something else.\nChristine Smith-Martin and her colleagues (2019, Figure 4.2) hypothesized that lianas can photosynthesize and grow better than trees during the dry season because lianas can maintain a less negative water potential than trees. To test their ideas, they set up a common garden experiment with, six liana and six tree species in replicate plots, in region of Panama with highly seasonal precipitation (Figure 4.2). They watered half of the plots, and measured a wide variety of variables including photosynthetic rate, pre-dawn and midday leaf water potential, water use efficiency, many other variables about lianas and trees.\n\n\n\n\n\n\nFigure 4.2: Geographic location of study sites in Smith-Martin et al. (2019). Inset, Chris Smith-Martin, seen here in a tree crane. There is a strong seasonality gradient from the Atlantic to Pacific coasts of Panama.\n\n\n\nYou will evaluate the hypothesis proposed by Smith-Martin and her colleagues using their publicly available data. These data are also available in the data repository for this book.\n\n4.2.1 Predictions\nA hypothesis is an educated guess about a mechanism. The mechanism should be relatively general and could apply to a variety of species or ecosystems. In contrast, a prediction is a specific measurable result that will occur in your system if the hypothesis is correct.1\nIf the hypothesis of Smith-Martin and her colleagues is correct, what should happen in their experiment? What does the hypothesis will predict should happen?\nRemember, they set up an outdoor experiment using lianas and trees. The factors that they controlled included,\n\nthe growth habit (lianas and trees),\nspecies of the lianas and trees, and\nwhether they watered to plants or not (all plants were outside and received ambient rainfall).\n\nOf course, they had replicate plants in every condition.\nIn each plot and for each plant, they measured,\n\npre-dawn water potential,\nmidday water potential,\ndifference between pre-dawn and midday water potential\nphotosynthetic rate\n\nThey collected these observations in five different months:\n\nduring the dry season (March and April),\nin the transition period between dry wet seasons (May), and\nduring the wet season (September and October).",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span>"
    ]
  },
  {
    "objectID": "03-liana-phys.html#predictions-1",
    "href": "03-liana-phys.html#predictions-1",
    "title": "4  Individual responses to the environment: What makes lianas relatively successful in stressful habitats?",
    "section": "4.3 Predictions",
    "text": "4.3 Predictions\nFirst, describe the hypothesis (i.e. how lianas vs. tress cope with dry periods) in your own words.\nSecond, state two different predictions about how the factors they controlled would influence the responses they measured. Each prediction should\n\nbe consistent with the hypothesis, and\nshow the differences between lianas and trees.\n\nRemember, they were trying to figure out why lianas are so successful in highly seasonal environments. Explain the logic of each prediction.\nThird, draw with with pen(cil) and paper graphs illustrating your predictions. Take pictures of these graphs so that you can include them in your deliverables. The goal is to place side-by-side the independent variables that should differ - perhaps lianas and trees side-by-side, in a variety of situations.\nYour job is to summarize the data in a way to evaluate and communicate the hypotheses. Think about how you can represent the prediction in a graph. Each graph should use variables that you think will show lianas outperforming trees under the relevant conditions.\nTo evaluate a hypothesis and display it visually, we generally put a cause or independent variable on the horizontal \\(x\\)-axis and the response or dependent variable on the \\(y\\)-axis. For example, in the graphs above (Figure 4.1), Schnitzer evaluated and then revealed to us the relations between deterministic causes on the x-axes and the biological responses on the y-axes.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span>"
    ]
  },
  {
    "objectID": "03-liana-phys.html#methods",
    "href": "03-liana-phys.html#methods",
    "title": "4  Individual responses to the environment: What makes lianas relatively successful in stressful habitats?",
    "section": "4.4 Methods",
    "text": "4.4 Methods\n\n4.4.1 Getting organized\nFirst, we need to confirm that we are in the Rwork working directory, and import data. In RStudio, you should open your Rwork project.\nCheck the working directory.\n\ngetwd()\n\nYour working directory should be Rwork.\nLoad packages you need.\n\nlibrary(ggplot2)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n## alternatively you could load the entire tidyverse,\n## which includes ggplot2 and dplyr\n# library(tidyverse)\n\n\n\n4.4.2 Import the data\n\nGo to our class data repository, and download SmithMartin.csv.\nMake sure the file remains in the same simple format, “comma separated values” (.csv).\nPut SmithMartin.csv in your working directory, Rwork.\nContinue to make sure the file remains in the same simple format, “comma separated values” (.csv).\n\nThe first five lines contain metadata, so we skip those when we load the data.\n\nliana &lt;- read.csv(\"SmithMartin.csv\", # the CSV file name\n                  skip=5 # skip the 5 lines of metadata\n                  )\n## Check the names of variables in the data frame \n## so you know what you have\nnames(liana)\n\n [1] \"Plot\"                  \"Tag\"                   \"Season\"               \n [4] \"Month\"                 \"Treatment\"             \"Habit\"                \n [7] \"Species\"               \"PredawnMPa\"            \"MiddayMPa\"            \n[10] \"MiddayMinusPredawnMPa\" \"Photo.umolCO2\"        \n\n\nSee for yourself the range in the numeric variables in the data set.\n\nNumericVars &lt;- liana[, 8:11]\nsummary(NumericVars)\n\n   PredawnMPa        MiddayMPa      MiddayMinusPredawnMPa Photo.umolCO2    \n Min.   :-3.5500   Min.   :-4.942   Min.   :-3.3510       Min.   : 0.0483  \n 1st Qu.:-0.6990   1st Qu.:-1.918   1st Qu.:-1.3690       1st Qu.: 4.9650  \n Median :-0.3940   Median :-1.472   Median :-1.0000       Median : 8.9600  \n Mean   :-0.5411   Mean   :-1.578   Mean   :-1.0365       Mean   : 8.9573  \n 3rd Qu.:-0.2060   3rd Qu.:-1.105   3rd Qu.:-0.6438       3rd Qu.:12.6500  \n Max.   :-0.0200   Max.   :-0.197   Max.   : 0.0420       Max.   :21.6000  \n NA's   :11        NA's   :11       NA's   :11            NA's   :912      \n\n\nSee for yourself the species of lianas and trees in the data set. This table() will count the number of rows associated with each species, whether it is a tree or a liana.\n\n# use 'with' to name a data frame\nwith( liana,\n      # do something with variables in that data frame\n      table(Species, Habit) \n      # close the parenthesis\n      )\n\n                        Habit\nSpecies                  liana tree\n  Callichlamyslatifolia     83    0\n  Crescentiacujete           0   78\n  Davillakunthii           118    0\n  Dipteryxoleifera           0   89\n  Doliocarpusmajor         114    0\n  Hieronymaalchorneoides     1   81\n  Huracrepitans              0   65\n  Machaeriummilleflorum    116    0\n  Maripapanamensis         105    0\n  Paulliniapinnata          98    0\n  Swieteniamacrophylla       0   97\n  Terminaliaamazonia         0  118\n\n\nUnless we tell it otherwise, R tends to sort words alphabetically. Months (January, February,…) have an order that is not alphabetical. Here, we make the variable Month a little more useful to us by turning it into a factor so that we can tell R how to order months.\n\nliana &lt;- liana %&gt;% # Start with your data frame\n  ## and make the change we want to the Month variable\n  mutate(\n    Month = factor(Month, levels=c(\"Mar\", \"Apr\", \"May\", \"Sep\", \"Oct\"))\n  )\n\n##...and show the unique values in Month, and also \n## show us the sequential order\nunique(liana$Month)\n\n[1] Apr Mar May Oct Sep\nLevels: Mar Apr May Sep Oct",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span>"
    ]
  },
  {
    "objectID": "03-liana-phys.html#graphics",
    "href": "03-liana-phys.html#graphics",
    "title": "4  Individual responses to the environment: What makes lianas relatively successful in stressful habitats?",
    "section": "4.5 Graphics",
    "text": "4.5 Graphics\nIn this section, we continue to develop our expertise and comfort in making graphs of predictions and also in using the grammer of the ggplot2 package (Wilkinson 2005; Wickham 2016). ggplot() graphics are designed for\n\nmaximum communication: the goal of data display is communication, to ourselves and others,\ntransparency of coding: the code should be easy to read, so that the analyst and others can see what has been done, and\nease of use: the analyst and do a lot of different things relatively easily.\n\n\n4.5.1 Anatomy of ggplot()\nIn making a graph, we specify,\n\nthe main function: ggplot()\nthe data frame: data=\nthe variables for each axis and any conditioning (these are named, oddly, “aesthetics”): aes(...)\nx and y variables: aes(x=, y=)\nconditioning variables, which allow us to show differences between levels of an independent variable : aes(x=, y=, color=, linetype=,...)\nthe type of geometric display (e.g., box-and-whisker plot, scatterplot, columns, histogram, line graph, etc.): geom_boxplot, geom_point(), geom_line(), etc.\naxis labels and other annotations: labs(x=, y=,...)\nfacets (how we cut the data up top show different sides of the data): facet_wrap( ~ groups) or facet_grid(row_groups ~ column_groups).\n\nSo, let’s try some of this.\n\n\n4.5.2 Examples of ggplot()\nHere we go.\nA simple plot.\n\nggplot(data=liana, # we specify the data frame\n      aes(x = Month, # x-axis\n          y= PredawnMPa # y-axis\n          ) ) + # close parentheses and add a plus sign to add box and whisker plot \n  geom_boxplot() \n\nWarning: Removed 11 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\nExample of a simple box and whisker plot in ggplot(). Note the correspondance between the code and the figure. The data frame is ‘liana’. The x-axis is defined by x = Month. The y-axis (predawn water potential, in megapascals) is defined by y=PredawnMPa.\n\n\n\n\nCoding: Note the correspondence between the graph and the elements of the code that made the graph.\nEcology: Note the difference in predawn water potential in March and April, compared to September and Oct. What is water potential, and how does it change from the soil, to the root, stem, and leaf, and finally to the air? Remember that water moves from areas of higher moisture to areas of lower moisture, that is, down gradients of water potential from higher values to lower value, just like a ball rolling downhill. In which months is the soil driest?\nNow let’s try a more complex figure, in which we add two conditioning variables, and more description label on the \\(y\\)-axis. We color-code the first conditioning variable is the treatment, in which plants are watered or not. The second conditioning variable is season (dry, wet or transition), and we make separate facets or panels for that.\n\n## specifiy the data and most of the variables\nggplot(data=liana, # we specify the data frame\n      aes(x = Habit, # x-axis\n          y= MiddayMPa, # y-axis\n          color = Treatment # conditioning variable. Examine the output to figure out what this does.\n          ) ) + # close parentheses and add a plus sign to add box and whisker plot \n  geom_boxplot() + # and add \"faceting\" to break it up by season.\n  facet_wrap(~Season) + # the season\n  labs(y=\"Midday water potential (MPa)\")\n\nWarning: Removed 11 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\nExample of a box and whisker plot in ggplot(). Note the correspondance between the code and the figure. The x-axis is defined by x = Habit. The y-axis (midday water potential, in megapascals) is defined by y=MiddayMPa. The data are further split by experimental treatment (watered vs. not watered), and that is defined by color = Treatment.\n\n\n\n\nAnd remember that you can save a graph to your wrorking directory using ggsave() right after you make your graph, like this.\n\nggplot(data=liana, # we specify the data frame\n      aes(x = Month, # x-axis\n          y= MiddayMPa, # y-axis\n          ) ) + # close parentheses and add a plus sign to add box and whisker plot \n  geom_boxplot()\n\nWarning: Removed 11 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\nggsave(\"myMiddayPlot.png\", width=4, height=4)\n\nWarning: Removed 11 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\nThe dimensions (in inches) of your saved graph dictate how big the labels and points look. If you make a small graph (e.g., width=3, height=3), the labels will look big by comparison. If you make a small graph (e.g., width=10, height=10), the labels will look small by comparison. Try it, and see for yourself.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span>"
    ]
  },
  {
    "objectID": "03-liana-phys.html#deliverables",
    "href": "03-liana-phys.html#deliverables",
    "title": "4  Individual responses to the environment: What makes lianas relatively successful in stressful habitats?",
    "section": "4.6 Deliverables",
    "text": "4.6 Deliverables\nTwo documents:\nA. The first document will contain:\n\nA restatement, in your own words, of the hypothesis of Smith-Martin and her colleagues.\nTwo predictions of the hypothesis that you can evaluate using the data we have (see above).\nTwo graphs done in R that evaluate the hypothesis of Smith-Martin and her colleagues. The variables in the graphs must match the variables in you predictions.\nFor each graph, identify the independent variable(s) and the dependent variable(s).\nFor each graph, explain what the graph shows and what it tells us about the hypothesis. We can’t draw firm conclusions, so use terms such as “suggests”, “is consistent with”, “seems to show”, or others, which help avoid expressing unwarranted certainty. Even with careful analysis, we always have to be cautious.\n\nB. Your second document is your R script.\n\n\n\n\nSchnitzer, S A. 2005. “A Mechanistic Explanation for Global Patterns of Liana Abundance and Distribution.” American Naturalist 166 (2): 262–76.\n\n\nSmith-Martin, Chris M., Carolina L. Bastos, Omar R. Lopez, Jennifer S. Powers, and Stefan A. Schnitzer. 2019. “Effects of Dry-Season Irrigation on Leaf Physiology and Biomass Allocation in Tropical Lianas and Trees.” Ecology 100.\n\n\nWickham, Hadley. 2016. Ggplot2: Elegant Graphics for Data Analysis. New York, NY: Springer-Verlag.\n\n\nWilkinson, Leland. 2005. The Grammar of Graphics. Second. Statistics and Computing. New York, NY: Spinger.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span>"
    ]
  },
  {
    "objectID": "03-liana-phys.html#footnotes",
    "href": "03-liana-phys.html#footnotes",
    "title": "4  Individual responses to the environment: What makes lianas relatively successful in stressful habitats?",
    "section": "",
    "text": "Note these explanations for hypothesis and prediction may differ from those often described in statistics classes.↩︎",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span>"
    ]
  },
  {
    "objectID": "04-extrapair_copulation.html",
    "href": "04-extrapair_copulation.html",
    "title": "5  Behavior: Extra-pair copulation in a monogamous species",
    "section": "",
    "text": "5.1 Goals\nIn this assignment, you will",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Behavior: Extra-pair copulation in a monogamous species</span>"
    ]
  },
  {
    "objectID": "04-extrapair_copulation.html#goals",
    "href": "04-extrapair_copulation.html#goals",
    "title": "5  Behavior: Extra-pair copulation in a monogamous species",
    "section": "",
    "text": "Develop and use your understanding of evolution, behavior, and prairie voles to make predictions about determinants of extra-pair copulation in a monogamous species.\nEnhance your quantitative reasoning and data analytic skills.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Behavior: Extra-pair copulation in a monogamous species</span>"
    ]
  },
  {
    "objectID": "04-extrapair_copulation.html#preparatory-steps",
    "href": "04-extrapair_copulation.html#preparatory-steps",
    "title": "5  Behavior: Extra-pair copulation in a monogamous species",
    "section": "5.2 Preparatory Steps",
    "text": "5.2 Preparatory Steps\n\nWatch three video lectures on evolution, life history, and behavior\nDownload Solomon and Keane (2018), which is available in our PDF archive. Read the introduction to help you understand the context of this chapter.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Behavior: Extra-pair copulation in a monogamous species</span>"
    ]
  },
  {
    "objectID": "04-extrapair_copulation.html#background-what-causes-extra-pair-copulation-in-prairie-voles",
    "href": "04-extrapair_copulation.html#background-what-causes-extra-pair-copulation-in-prairie-voles",
    "title": "5  Behavior: Extra-pair copulation in a monogamous species",
    "section": "5.3 Background: What causes extra pair copulation in prairie voles?",
    "text": "5.3 Background: What causes extra pair copulation in prairie voles?\nMonogamy, the mating system in which individuals pair-bond to raise offspring, is relatively rare. We don’t know what causes this rarity, and nor do we know why it persists where it do occur. Prairie voles (Microtus ochrogaster), like humans, are famously monogamous, and behavioral ecologists have studied them for that reason. And, just like humans, voles also engage in extra-pair copulations that result in offspring, and scientists have been trying to understand the causes and consequences of those extra-pair copulations (Solomon and Keane 2018).\nMonogamy is a mating system (sexual monogamy), but it is also one of many types of social system (social monogamy). Different species of animals engage in many forms of sociality (Nowak, Tarnita, and Wilson 2010; Nordell and Valone 2014; Kappeler 2019). For example, all species of ants and many species of bees live in large colonies with several castes of individuals (eusociality). Most species are entirely solitary (think grasshoppers, frogs, flies). Many species live in family social units or have primitive forms of eusociality (Nordell and Valone 2014). Social monogamy is the particular form of sociality in which a female-male pair lives together, often resulting in more successful rearing of offspring.\nSo why would socially monogamous individuals engage in extra-pair copulation?\nOne reason that individuals engage in extra-pair copulations is in order to avoid inbreeding depression. Breeding that results from matings between highly related individuals typically causes a decline in vigor and health of individual offspring and a reduction in fitness for those phenotypes. Inbreeding depression is the reduction in fitness due to breeding among relatives.\nFitness is the quantitative representation of natural and sexual selection within evolutionary biology. It can be defined either with respect to a genotype or to a phenotype in a given environment. In either case, it describes individual reproductive success and is equal to the average contribution to the gene pool of the next generation that is made by individuals of the specified genotype or phenotype. The fitness of a genotype is manifested through its phenotype, which is also affected by the developmental environment. The fitness of a given phenotype can also be different in different selective environments. (Quoted from Wikipedia)\n\n5.3.1 Tinbergen’s four questions\nThis section is from an online course at Oxford University\nIn 1963 Niko Tinbergen published a seminal paper entitled On the aims and methods of ethology, which laid the foundation for how to conduct research in the fledging field of animal behaviour. The lasting contribution of the paper is that in it Tinbergen formulated four different, albeit somewhat interlinked, approaches to the study of animal behaviour, or four different types of questions we can ask about an observed behaviour.\nThe four questions are:\n\nFunction (or adaption)\n\nWhy is the animal performing the behaviour? In which way does the behaviour increase the animal’s fitness (i.e. its survival and reproduction)? Examples are plentiful and include, among many others, nurturing of young to increase their chance of survival, migration to warmer (and more food rich) habitats, escaping or avoiding attention from predators etc.\n\nEvolution (or phylogeny)\n\nHow did the behaviour evolve? How has natural selection modified the behaviour over evolutionary time? This is typically addressed by the comparative approach, where the behaviour in question is compared among closely related species. Examples include how flight in birds may have evolved from gliding in dinosaurs or how the vertebrate and cephalopod eyes have evolved by convergent evolution, with the former having a blind spot, while the latter does not.\n\nCausation (or mechanism)\n\nWhat causes the behaviour to be performed? Which stimuli elicit or what physiological mechanisms cause the behaviour? Examples include the role of pheromones and hormones, such as increasing testosterone levels (caused by increasing day length) causing male display behaviour in many species of birds, moving shadows causing ragworms to withdraw into their burrows or contrast on beaks causing herring gull chicks to peck.\n\nDevelopment (or ontogeny)\n\nHow has the behaviour developed during the lifetime of the individual? In what way has it been influenced by experience and learning? Examples include how courtship behaviour improves with age in many birds and how predators learn to avoid toxic or dangerous prey with experience.\nThe four types of questions operate at two different levels. Questions 1 and 2 give ultimate or evolutionary explanations. These are answers that take a longer perspective and try to explain why the behaviour has evolved. On the other hand, questions 3 and 4 give proximate explanations. These are answers that look into the immediate mechanical reasons for how a behaviour is expressed. To obtain a full understanding of the costs, benefits and constraints that have shaped a given behaviour both ultimate and proximate answers must be obtained.\n\n\n5.3.2 Determinants of extra-pair copulation in voles\nSo, what causes extra-pair copulation? What influences the probability that an individual enages in extra-pair copulation? We can think about these questions in any of the four contexts that Tinbergen’s questions provide.\nHere are some factors that may help determine to the probability of extra-pair copulation:\n\nthe relatedness of the extra-pair partner, and avoidance of inbreeding.\nthe relatedness of the nest- vs. extra-pair partner.\nsex (perhaps females are more or less likely than males to seek opportunities)\nnumber in nest, if crowding is a proximate cue to mate with a nest partner or extra-pair individual.\n\nIt is not always clear how animals and plants identify individuals that are closely related or not related, but under many circumstances, they somehow seem to mate with individuals that are less related than by chance alone.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Behavior: Extra-pair copulation in a monogamous species</span>"
    ]
  },
  {
    "objectID": "04-extrapair_copulation.html#data-from-the-solomonkeane-lab",
    "href": "04-extrapair_copulation.html#data-from-the-solomonkeane-lab",
    "title": "5  Behavior: Extra-pair copulation in a monogamous species",
    "section": "5.4 Data from the Solomon/Keane lab",
    "text": "5.4 Data from the Solomon/Keane lab\nDr. Nancy Solomon and Dr. Brain Keane have been studying prairie voles for decades, and here we investigate our questions using one of their data sets.\nThe data file epr_209.csv contains observations on voles related to those we read about in Solomon and Keane (2018). These data are from sampling of voles from the Indiana site, collected over three years (2006-2008). This data file is available in our data repository\nEach row in the data set is a record of a succesful copulation that resulted in at least one offspring. Included in each row we have the ofllowing columns:\n\nid - identification number of the individual\nsex - biological sex of the individual\nyear - calendar year of data collection\nnest - the identity of the home nest of the individual\nsize - number of individuals in the nest\nr - relatedness to the partner.\npairtype - nest partner or extra-pair copulation.\n\nRelatedness to a partner varies between -1 and +1. A value near zero indicates no more related than expected by chance; 1 is self-identity (e.g., clone) and negative values indicate even less related than we expect due to chance.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Behavior: Extra-pair copulation in a monogamous species</span>"
    ]
  },
  {
    "objectID": "04-extrapair_copulation.html#your-objectives",
    "href": "04-extrapair_copulation.html#your-objectives",
    "title": "5  Behavior: Extra-pair copulation in a monogamous species",
    "section": "5.5 Your objectives",
    "text": "5.5 Your objectives\nAsk yourself, “what the heck are these voles doing? is there anything in particular that seems related to the probability that an individual engages or does not engage in extra-pair copulation.\nYou will come up with a hypothesis about the conditions to might lead to more extra-pair copulations.\n\nPose a question that you can express in a graph using these data. Rely on your understanding of evolution, behavior, and prairie voles to justify your question.\nMake a prediction. Draw a mock-up of the graph that is consistent with the mechanism you propose.\nCreate R code to create the graph you want.\nFigure out what the graph tells you about the answer to your question. Does it match you expectations? Rely on your understanding of evolution, behavior, and prairie voles to interpret your result.\n\nPut all of the above (question, hand-drawn graph mock-up, R figure of data, data-based answer to your question) in a document, and turn it in online. See Deliverables at the end of this chapter.\n\n5.5.1 Write your own script\nTo create the graph, you will write your own script. Start as uysual, by finding out what your current working directory. Make sure it is Rwork. The read in your data and look at the variables. Then create the graph you want.\nFirst we check the current working directory.\n\ngetwd()\n\nThis should show a path to Rwork. If not, use the “Session” menu to set your working directory. If you don’t have an Rwork folder, see Chapter 1.\nNext we load some packages that we will use.\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nNext, we get the data.\n\nGo to our class data repository, and download epr.csv.\nMake sure the file remains in the same simple format, “comma separated values” (.csv).\nPut epr.csv in your working directory, Rwork.\nContinue to make sure the file remains in the same simple format, “comma separated values” (.csv).\n\nNow import the data.\n\nd209 &lt;- read.csv(\"epr_209.csv\")\nstr(d209)\n\n'data.frame':   250 obs. of  7 variables:\n $ id      : chr  \"101\" \"101\" \"1021\" \"1021\" ...\n $ sex     : chr  \"male\" \"male\" \"female\" \"female\" ...\n $ year    : int  2006 2006 2007 2006 2006 2007 2007 2006 2006 2006 ...\n $ nest    : chr  \"19/20/21\" \"19/20/21\" \"29\" \"32\" ...\n $ size    : int  7 7 3 2 2 2 2 7 7 2 ...\n $ r       : num  0.378 -0.183 0.321 -0.109 -0.032 ...\n $ pairtype: chr  \"nest\" \"nest\" \"nest\" \"extra\" ...\n\n\nUse everything you have learned thus far, and the tutorial below to make the graph you want. After you make the graph you want, you can use ggsave(\"myVoles.png\") to save the graph to your working directory.\n\n\n5.5.2 Recoding “pairtype”\nWe can estimate the probability of something happening or not happening based on a series of successes and failures, like a coin coming up heads. A coin either comes up heads or it doesn’t - success or failure.\nWe need to create a variable that represents either an extra-pair copulation or a nest-pair copulation. We will code extra-pair copulation as 1 (success) and nest-pair copulation (failure).\n\nd209 &lt;- d209 %&gt;%\n  mutate(\n    epc = ifelse(pairtype==\"extra\", 1, 0)\n  )\nstr(d209)\n\n'data.frame':   250 obs. of  8 variables:\n $ id      : chr  \"101\" \"101\" \"1021\" \"1021\" ...\n $ sex     : chr  \"male\" \"male\" \"female\" \"female\" ...\n $ year    : int  2006 2006 2007 2006 2006 2007 2007 2006 2006 2006 ...\n $ nest    : chr  \"19/20/21\" \"19/20/21\" \"29\" \"32\" ...\n $ size    : int  7 7 3 2 2 2 2 7 7 2 ...\n $ r       : num  0.378 -0.183 0.321 -0.109 -0.032 ...\n $ pairtype: chr  \"nest\" \"nest\" \"nest\" \"extra\" ...\n $ epc     : num  0 0 0 1 1 1 1 0 0 1 ...\n\n\nNow we see that extra-pair copulation is coded as a number, just 0 or 1.\nSee below for an example of graphing zeros and ones on the y-axis, and a continuous variable on the x-axis, where we describe the probability that a car model has front wheel drive (y-axis), based its city gas mileage.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Behavior: Extra-pair copulation in a monogamous species</span>"
    ]
  },
  {
    "objectID": "04-extrapair_copulation.html#graphing-in-ggplot",
    "href": "04-extrapair_copulation.html#graphing-in-ggplot",
    "title": "5  Behavior: Extra-pair copulation in a monogamous species",
    "section": "5.6 Graphing in ggplot()",
    "text": "5.6 Graphing in ggplot()\nHere is some general guidance for using ggplot():\nggplot(data= myDataset, aes(x= X-variable, y= Y-variable)) + geom_typeOfPlot()\n\nfor a box-and-whisker plot: geom_boxplot() This is a more transparent and useful alternative to standard barplot or column graph.\nfor a scatterplot geom_point()\nfor a scatterplot with a fitted straight line geom_point() + geom_smooth(method=\"lm\")\n\nFirst, we load the packages of the tidyverse. If you already loaded this package as part of tidyverse, then you have already done this step.\n\nlibrary(tidyverse)\n\nHere we use a data set ( mpg) that comes with R to help demonstrate examples. This data set, mpg includes fuel economy data from 1999 to 2008 for 38 popular models of cars.\n\nglimpse(mpg)\n\nRows: 234\nColumns: 11\n$ manufacturer &lt;chr&gt; \"audi\", \"audi\", \"audi\", \"audi\", \"audi\", \"audi\", \"audi\", \"…\n$ model        &lt;chr&gt; \"a4\", \"a4\", \"a4\", \"a4\", \"a4\", \"a4\", \"a4\", \"a4 quattro\", \"…\n$ displ        &lt;dbl&gt; 1.8, 1.8, 2.0, 2.0, 2.8, 2.8, 3.1, 1.8, 1.8, 2.0, 2.0, 2.…\n$ year         &lt;int&gt; 1999, 1999, 2008, 2008, 1999, 1999, 2008, 1999, 1999, 200…\n$ cyl          &lt;int&gt; 4, 4, 4, 4, 6, 6, 6, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 8, 8, …\n$ trans        &lt;chr&gt; \"auto(l5)\", \"manual(m5)\", \"manual(m6)\", \"auto(av)\", \"auto…\n$ drv          &lt;chr&gt; \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"f\", \"4\", \"4\", \"4\", \"4\", \"4…\n$ cty          &lt;int&gt; 18, 21, 20, 21, 16, 18, 18, 18, 16, 20, 19, 15, 17, 17, 1…\n$ hwy          &lt;int&gt; 29, 29, 31, 30, 26, 26, 27, 26, 25, 28, 27, 25, 25, 25, 2…\n$ fl           &lt;chr&gt; \"p\", \"p\", \"p\", \"p\", \"p\", \"p\", \"p\", \"p\", \"p\", \"p\", \"p\", \"p…\n$ class        &lt;chr&gt; \"compact\", \"compact\", \"compact\", \"compact\", \"compact\", \"c…\n\n\nFor a box-and-whisker plot of highway mileage (hwy) vs. car type (class), with explicit labels.\n\nggplot(mpg, aes(x = class, y = hwy)) + geom_boxplot() + \n  labs(x=\"type of car\", y=\"highway mileage\")\n\n\n\n\nBox-and-whisker plot of highway mileage (hwy) vs. car type (class), with explicit labels. A boxplot shows the distribution of data, by groups.\n\n\n\n\n\n5.6.0.1 Scatterplots\n\nggplot(mpg, aes(x=cty, y=hwy)) + geom_point() + \n  labs(x=\"city mileage\", y=\"highway mileage\")\n\n\n\n\nScatterplot of highway mileage vs. city mileage (miles per gal).\n\n\n\n\n\nggplot(mpg, aes(x=cty, y=hwy)) + geom_point() + geom_smooth(method=\"lm\")\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nScatterplot with a fitted straight line, fitting a linear model.\n\n\n\n\n\n## for a scatterplot with a fitted curved line \nggplot(mpg, aes(x=cty, y=hwy)) + geom_point() + geom_smooth()\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\nScatterplot with a flexibly fitted line, using local polynomial regression fitting.\n\n\n\n\n\n\n5.6.0.2 Categorical responses\nOften we would like to predict whether individuals fall into one category or another, such as coin flips of heads vs. tails, success vs. failure, sick vs. healthy, or engaging in extra-pair copulation vs. remaining monogamous. These kind of dichotomous data are called binomial data, and we think of these data as zeros and ones (0, 1), perhaps zero for heads and one of tails.\nWhen we model binomial data (0,1), we put these 0s and 1s on the y-axis. Here is a worked example using mpg data.\nFirst, create a dichotomous variable (0, 1) indicating whether a car model is front wheel drive or other (rear- or 4-wheel drive). A plot like this puts probability on the y-axis. In this case it is the probability that a car with a given mileage is a front-wheel drive car.\nConvert a factor or character variable to zeros and ones. Here we convert the category of drive train (rear vs. front wheel drive) into ones for front wheel drive, and zeros for rear wheel drive. We use an “if-else” statement to do that.\n\nmpg2 &lt;- mpg %&gt;% \n  mutate(\n    prob.front.wheel.drive = ifelse(drv==\"f\", 1, 0)\n  )\n\nNext we plot the zeros and ones on the y-axis against city mileage on the x-axis. We also add a particular kind of fitted line that shows us the expected probability that a car with a particular city mileage is front wheel drive. This curve is the result of a logistic regression model that we use for binomial data. The graph tells us that\n\nggplot(mpg2, aes(cty, prob.front.wheel.drive)) + \n  geom_point() + \n  geom_smooth(method=\"glm\", \n              method.args = list(family = \"binomial\"))\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nHigher mileage cars tend to have front-wheel drive. Graph shows the probability that a car with a particular city mileage is front wheel drive. The curve is the result of a type of generalized linear model (glm) called logistic regression which assumes binomial data.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Behavior: Extra-pair copulation in a monogamous species</span>"
    ]
  },
  {
    "objectID": "04-extrapair_copulation.html#deliverables",
    "href": "04-extrapair_copulation.html#deliverables",
    "title": "5  Behavior: Extra-pair copulation in a monogamous species",
    "section": "5.7 Deliverables",
    "text": "5.7 Deliverables\nCreate one document (presentation slide or other document) that,\n\nplaces the hand-drawn graph of your predictions side by side with the graph of the observed data,\nincludes a succinct explanation of\n\nbasis of your original prediction; explain why voles would behave the way you predicted they would. Do not rely on your intuition. Instead, use your knowledge of evolutionary biology, behavior, and voles in your explanation, and\nyour observed result.\n\nincludes a headline, that is, a title that provides your result or takeaway message, such as “Living in small groups enhances monogamy”.\n\nTurn this in to the assignment on Canvas. (Previous versions asked to submit this to a Google Slide deck, but we will no longer do that.)\n\n\n\n\nKappeler, Peter M. 2019. “A Framework for Studying Social Complexity.” Behavioral Ecology and Sociobiology 73 (1): 13. https://doi.org/10.1007/s00265-018-2601-8.\n\n\nNordell, Shawn E., and Thomas J. Valone. 2014. Animal Behavior: Concepts, Methods, and Applications. New York: Oxford University Press.\n\n\nNowak, Martin A, Corina E Tarnita, and Edward O Wilson. 2010. “The Evolution of Eusociality.” Nature 466 (7310): 1057–62.\n\n\nSolomon, Nancy G., and Brian Keane. 2018. “Dispatches from the Field: Sociality and Reproductive Success in Prairie Voles.” Animal Behaviour 143 (September): 193–203. https://doi.org/10.1016/j.anbehav.2018.07.001.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Behavior: Extra-pair copulation in a monogamous species</span>"
    ]
  },
  {
    "objectID": "06-DI-pop-growth.html",
    "href": "06-DI-pop-growth.html",
    "title": "6  Density-independent Population Growth: Humans on the rise",
    "section": "",
    "text": "6.1 Goals\nReproduction helps define what we call “life”, and leads to exponential growth. This chapter introduces this concept and how we quantify it.\nIn this chapter, you will\nIn this chapter, we’ll use these techniques and data from Our World in Data to describe mathematically the growth rate of the world’s human population at different points in time over the last 10,000 years.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Density-independent Population Growth: Humans on the rise</span>"
    ]
  },
  {
    "objectID": "06-DI-pop-growth.html#goals",
    "href": "06-DI-pop-growth.html#goals",
    "title": "6  Density-independent Population Growth: Humans on the rise",
    "section": "",
    "text": "learn the two fundamental principles of population growth,\ndo a little math: practice calculating rates of population growth,\ndo a little programming: use a “for-loop” to do lots of work very easily,\ndetermine how the rate of human population growth has changed over time, and\nstart to develop a greater understanding and intuition for exponential rates.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Density-independent Population Growth: Humans on the rise</span>"
    ]
  },
  {
    "objectID": "06-DI-pop-growth.html#preparatory-steps",
    "href": "06-DI-pop-growth.html#preparatory-steps",
    "title": "6  Density-independent Population Growth: Humans on the rise",
    "section": "6.2 Preparatory Steps",
    "text": "6.2 Preparatory Steps\n\nWatch these videos: lectures 3a and 3b before proceeding.\n\n\nGo to our class data repository, and download HumanPopData-2023-0101.csv. Make sure the file remains in the same simple format, “comma separated values” (.csv).\n\n\nIf you are curious, check Deliverables, at the end.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Density-independent Population Growth: Humans on the rise</span>"
    ]
  },
  {
    "objectID": "06-DI-pop-growth.html#background",
    "href": "06-DI-pop-growth.html#background",
    "title": "6  Density-independent Population Growth: Humans on the rise",
    "section": "6.3 Background",
    "text": "6.3 Background\nGiven sufficient resources, life is autocatalytic – the products of reproduction (offspring) amplify the rate of reproduction, leading to exponential growth.\nAs ecologists, we can state this with the following propositions (Hastings 2011):\n\nA population grows exponentially in the absence of other forces.\nThere are forces that can prevent a population from growing exponentially.\n\nThis deceptively simple pair of propositions provides a basis for an enormous amount of ecology. They are analogous to Newton’s First Law of Motion:\nEvery body perseveres in its state of being at rest or of moving uniformly straight forward, except insofar as it is compelled to change its state by forces impressed. (The Principia: Mathematical Principles of Natural Philosophy (1687), 3rd edition (1726), trans. I. Bernard Cohen and Anne Whitman (1999), Axioms, or Laws of Motion, Law 1, 416.)\nNow we would say that a body remains at rest, or in motion at a constant speed in a straight line, unless acted upon by a force.\nThe first proposition of population growth can emerge as the consequence of the following assumptions:\n\nall individuals in a population are identical.\nthere is no migration in or out of the population.\n\nthe number of offspring per individual (or the per capita birth and death rates) are constant through time, and (ii) independent of the number of individuals in the population.\n\n\nDeviations from these assumptions lead to proposition 2, and most of the interesting parts of single species population dynamics (Hastings 2011).\nHowever, although propositions 1 and 2 can follow from assumptions a-c, these assumptions are not necessary. For instance, in some cases, individuals don’t need to be identical, and we deal with a big exception in the next chapter where we introduce structured population growth. Also, migration is admissible, provided immigration = emigration and that it doesn’t alter the rate of change. Nonetheless, other deviations from a and b can have very important consequences for single species population dynamics. We will get to those in later chapters.\nEven when populations don’t grow exponentially, we often describe population growth using the same mathematical approach. We do that for at least a few of reasons:\n\napproximations of more complicated dynamics often simplify to exponential growth under reasonable assumptions,\nover short periods of time, deviations to exponential growth still result in patterns that are very similar to exponential growth, and\nwe typically don’t know precisely what mechanisms limit exponential growth or by how much, and therefore exponential growth is as good a mathematical description as any.\n\nIf you have not already done so, watch lectures 3a and 3b before proceeding.\n\n6.3.1 Population growth of Homo sapiens: a case study\nThe human population shares many features with other populations. Like other species, humans are distributed unequally around our available habitats, we consume resources and produce waste products, and the size of our population changes over time.\nHumans, as we would we recognize ourselves, have been around for ~300,000 years. Since that time a lot has happened to us, and we have done a lot to alter the planet. About 10,000 years ago, we started to use agriculture to raise a lot of our food, in the agricultural revolution. Oddly, this seems to have contributed simultaneously to both a decline in life span due to poor health, and yet also an increase in population growth rate and a corresponding increase in population size. The state of the human population is dynamic and undergoing transitions that are in different stages in different places around the world (Lee 2011).\nHere we examine changes in human population size from 10,000 y ago to 2021. The data are estimates, and we have annual estimates with increasing greater frequency, up until 2021.\nWe will calculate the density-independent per capita growth rate for pairs of years in the data set. We’ll do this by written out by hand, and also in R, using code to do everything quickly, efficiently and, importantly, reproducibly, so that you–or anyone–could check your estimatation procedure.\nRecall from lecture (link above) that we often use estimates of \\(\\lambda\\) and \\(r\\) to quantify how rapidly a population is growing (or declining) at various points in time. For a population with overlapping generations and reproducing continuously, we can estimate the per capita exponential growth rate at a particular point in time (\\(r_t\\)) using the following equation:\n\\[r_t = \\frac{\\frac{\\ln N_{t+h}}{\\ln N_t}}{(t+h) - t} \\tag{6.1}\\]\nwhere \\(N_t\\) is the size of the population at some starting time point \\(t\\), and \\(N_{t+h}\\) is the size of the population after some time interval \\(h\\), and \\(\\ln\\) is the natural logarithm.\nFor example, imagine we that in 2020, we had 100 mice and exactly two years later, the population had grown to 150 mice. Here are the values that we would use to calculate \\(r_t\\):\n\n\\(t = 2020\\)\n\\(t+h = 2022\\)\n\\(h = (t+h) - t = 2022-2020 = 2\\)\n\\(N_t = 100\\)\n\\(N_{t+h} = 150\\)\n\nWe would substitute these values into the above formula (#eq-r) as,\n\\[\\begin{align*}\nr_t &= \\frac{ \\ln \\frac{150}{100}}{2022 - 2020}\\\\\n&=\\frac{\\ln 1.5}{2}\\\\\n&= 0.2027\n\\end{align*}\\]\nshowing each step of our work. Whenever you need to show how you arrived at an answer (such as in homework, research, or in a job), you should do something like this.\nWhen \\(r_t\\) is positive (\\(r_t &gt; 0\\)), this means that the population was growing, and quantifies how fast it grew and became larger.\nWhat if we reverse so the we started with \\(N_t = 150\\) and the population declined to \\(N_{t+h} = 100\\)?\n\\[\\begin{align*}\nr_t &= \\frac{\\ln \\frac{100}{150}}{2021 - 2020}\\\\\n&=\\frac{\\ln \\frac{2}{3}}{2}\\\\\n&= -0.2027\n\\end{align*}\\]\nending with a negative value (\\(r_t &lt; 0\\)), indicating that the population shrank. When \\(r_t &lt; 0\\), that means the population has decreased in size. Sometimes we call that “negative growth”.\nWhat do you think we we get if the population didn’t change, so that \\(N_t = N_{t+h} = 100\\)?\n\n\n6.3.2 Projecting population size into the future\nIf we make certain assumptions, we can make predictions about the future. In order to make predictions about the size of the population next year, or in 5, 10, or 20 years, we can extrapolate the current rate of change into the future. To do that, we can use the instantaneous rate of increase, \\(r\\), and the amount of time, and a solution from calculus.\nTo predict the size of a population to year \\(t\\) from some starting time, we rely on the rule that,\n\\[N_t = N_0 e^{rt} \\tag{6.2}\\]\nor equivalently,\n\\[N_{t+h} = N_t e^{rh}\\]\nwhere the parameter \\(r\\) is the per capita instantaneous rate of increase, and \\(t\\) is the amount of time, or time interval. The letter \\(e\\) is the exponential, or Euler’s constant. The exponential is the base of the natural logarithm. The important thing here is the time interval in the exponent (\\(t\\) or \\(h\\)) has to be the time interval from the starting value of \\(N\\) to the projected value of \\(N\\).\n\n\n\n\n\n\nFigure 6.2: Common duckweed (Lemna minor) populations can grow fast. Credit: https://commons.wikimedia.org/w/index.php?curid=1085476\n\n\n\nImagine we have a population of the small floating plant duckweed (Lemna minor), that can double in about two weeks . In that case, \\(r = 0.35\\) new lemna per old lemna per week. Pretend we start with a population of 100 lemna individuals (\\(N_0 = 100\\)). How many lemna should we have in three weeks? Show your work (e.g., Figure 6.3).\n\n\n\n\n\n\nFigure 6.3: Projecting the size of the duckweed population three weeks into the future.\n\n\n\n(Overthinking: Equation 6.2 is derived from the growth equation Equation 6.1 using integral calculus. It is the integral from 0 to t of Equation 6.1.)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Density-independent Population Growth: Humans on the rise</span>"
    ]
  },
  {
    "objectID": "06-DI-pop-growth.html#methods",
    "href": "06-DI-pop-growth.html#methods",
    "title": "6  Density-independent Population Growth: Humans on the rise",
    "section": "6.4 Methods",
    "text": "6.4 Methods\n\nMake sure your working directory is Rwork.\nLoad the necessary packages.\n\n\nlibrary(tidyverse) # for readr, dplyr and others\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(patchwork) # to combine ggplot2 figures\n\n\n6.4.1 Load data\nNext, we get the data, if you haven’t already done so.\n\nGo to our class data repository, and download HumanPopData-2023-01-01.csv. Make sure the file remains in the same simple format, “comma separated values” (.csv).\nPut HumanPopData-2023-01-01.csv in your working directory, Rwork.\nOpen HumanPopData-2023-01-01.csv and make note of the first three lines of metadata. When you close the file, do not save any changes, and make sure not to save it in a new format, such as “.xlsx” or “.numbers”.\nContinue to make sure the file remains in the same simple format, “comma separated values” (.csv).\n\nNow import the data into R, and glimpse the structure of the data frame.\n\nd &lt;- read_csv(\"HumanPopData-2023-01-01.csv\", \n              skip=3 # skip three lines of metadata\n              )\n\nRows: 259 Columns: 2\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (2): Year, est.N\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nglimpse(d)\n\nRows: 259\nColumns: 2\n$ Year  &lt;dbl&gt; -10000, -9000, -8000, -7000, -6000, -5000, -4000, -3000, -2000, …\n$ est.N &lt;dbl&gt; 4432266, 5616996, 7242892, 9577918, 13201832, 19075771, 28774661…\n\n\nNote that years before the current era (BCE) are negative numbers, while numbers in the current era (CE) are positive.\nLet’s also graph the data to see if it makes sense.\n\nd %&gt;% \n  ggplot(aes(x=Year, y=est.N)) + \n  geom_point() + geom_line() + \n  scale_y_log10() + labs(y=\"Estimated human population size\") \n\n\n\n\n\n\n\nFigure 6.4: The human population has increased over time. Note the common log scale on the y-axis. Note that years before the current era (BCE) are negative numbers, while numbers in the current era (CE) are positive.\n\n\n\n\n\n\n\n6.4.2 Simple math: Calculations by hand\nDoing math and arithmetic by hand is like learning music: you have to do it by hand, even when it feels like copying. This helps it become automatic, which leads to understanding.\nCalculate by hand the instantaneous per capita growth for these intervals:\n\n10000 to 9000 BCE (or -10000 to -9000),\n0 to 100 CE, and\n1960 to 1961 CE.\n\nI recommend letting R help you, but you will need to write it out on paper. Write down these calculations with pen(cil) and paper, and take a picture of it. As with all math and word problems,\n\nstart with a formula, in this case, (#eq-r),\nmake the relevant substitutions,\nperform the calculation, and\nthus show your work.\n\n\n\n\n\n\n\nFigure 6.5: Here I show my work to calculate r for the interval from 100 CE to 200 CE. I used my R script below to extract values from the data set and perform arithmetic.\n\n\n\nI would use the following code to give me the data I would need for the interval for the years 100 CE to 200 CE\nSpecify the times and the interval you want.\n\n## Get the right time points and find h\nt &lt;- 100\n# recall h = (t+h) - t\nt.plus.h &lt;- 200\nh  &lt;- t.plus.h - t\nt; t.plus.h; h\n\n[1] 100\n\n\n[1] 200\n\n\n[1] 100\n\n\nGrab the values of N, given the years you specified.\n\nFind a value of est.N when year equals 100\nFind a value of est.N when year equals 200\n\n\n## in base R\nNt &lt;- d$est.N[d$Year == t]\nNth &lt;- d$est.N[d$Year == t.plus.h]\nNt; Nth\n\n[1] 236904172\n\n\n[1] 240611571\n\n\nOverthinking: You could use the tidyverse syntax to get the same values.\n\n## using tidyverse syntax\nNt &lt;-  d %&gt;% # use d\n  filter(Year == t) %&gt;%  # use just values in this year\n   select(est.N) %&gt;% # select just N\n  as.numeric() # convert from a data frame to a numeric variable\n\nNth &lt;-  d %&gt;% # use d\n  filter(Year == t.plus.h) %&gt;%  # ue just values in this year\n   select(est.N) %&gt;% # select just N\n  as.numeric() # convert from a data frame to a numeric variable\nNt; Nth\n\n[1] 236904172\n\n\n[1] 240611571\n\n\nDo calculations to find \\(r\\), the instantaneous per capita population growth rate. Note that in R log() refers to the natural logarithm, while log10() refers to the common logarithm. For more information, type ?log.\n\n# the natural log of the ratio of population sizes\nlogNth.over.Nt &lt;- log(Nth / Nt)\nlogNth.over.Nt\n\n[1] 0.01552817\n\n\nLast, we find \\(r\\) for this particular time step of 1000 y.\n\n# finding r\nr &lt;- logNth.over.Nt / h\nr\n\n[1] 0.0001552817\n\n\nYou can use R as a calculator this way to make your pen and paper work easier.\n\n\n6.4.3 Programming: Use a for-loop to do all the calculations\nA benefit of programming is that we can create a statement to do all our work for use. A “for-loop” is a programming trick to do a repeated process, for instance, for each row of a dataset.\nBelow is code to calculate every value of \\(r\\) in the entire data set, except the last year. We have to exclude the last year because we don’t know how fast the population grew from the last year to the subsequent year.\n\nFirst we create an empty vector into which we will put our calculations of \\(r\\), one at a time.\nNext, we calculate \\(r\\) for each year, except the last.\nFinally, we combine our vector of \\(r_t\\) with the original data.\n\nHere we, create an empty vector of missing values. To start, this will have the same number of rows as our data set, d.\n\n# create an empty vector of missing values.\nr &lt;- rep(NA, nrow(d))\n\nNow we calculate \\(r\\) for each row of data except the last year. Here the letter i stands in for the number of each row.\n\n# Do the following steps FOR each row of our data.\n# Note we start with row 2, and use row 2 and row 1....\nfor(i in 2:nrow(d)) {\n  # the second, more recent, year\n  t.plus.h &lt;- d$Year[i]\n  # the previous year\n  t &lt;- d$Year[i-1]\n  \n  # the time interval in years\n  h &lt;- t.plus.h - t\n  \n  # the more recent N\n  Nth &lt;- d$est.N[i]\n  # the previous N\n  Nt &lt;- d$est.N[i-1]\n  \n  # the natural log ratio \n  logNth.over.Nt &lt;- log(Nth/Nt)\n  \n  # r, which we put in the appropriate slot, year t\n  r[i-1] &lt;- logNth.over.Nt/h\n  \n}\n\n# last, let's check the result\nglimpse(r)\n\n num [1:259] 0.000237 0.000254 0.000279 0.000321 0.000368 ...\n\n\nFinally, we combine this with our original data set. We use cbind() which stands for “bind columns”.\n\nd.r &lt;- cbind(d, r=r)\n\nIf you examine the last three rows of these data, you’ll see that we don’t have an estimate of \\(r_t\\) for the last year because we can’t calculate it without know the next year’s population size.\n\nd.r[257:259,]\n\n    Year      est.N           r\n257 2019 7764951040 0.009740210\n258 2020 7840952832 0.008678302\n259 2021 7909295104          NA\n\n\nFrom here on out, we are interested mostly with the growth rate, \\(r_t\\), so I will remove the last row of the data set, or keep only the first 258 rows.\n\nd.r &lt;- d.r[1:258,]",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Density-independent Population Growth: Humans on the rise</span>"
    ]
  },
  {
    "objectID": "06-DI-pop-growth.html#changes-in-human-population-growth-rate",
    "href": "06-DI-pop-growth.html#changes-in-human-population-growth-rate",
    "title": "6  Density-independent Population Growth: Humans on the rise",
    "section": "6.5 Changes in human population growth rate",
    "text": "6.5 Changes in human population growth rate\nLet’s graph our data to examine how the per capita growth rate of humans changed since the agricultural revolution. I’ll pair them with population size.\n\n# population size, using the first data frame\nggplot(data=d.r, aes(x=Year, y=r)) + geom_line() +\n  geom_point() + labs(title=\"Per capita growth rate\")\n\n\n\n\n\n\n\nFigure 6.6: Estimates of per capita growth are positive for nearly every time interval since the agricultural revolution.\n\n\n\n\n\nThis shows us the growth rate didn’t change much before the current era. However, it is hard to see what has been going on more recently. Therefore, let’s plot only the data starting in year 1.\n\n# filter in all years greater than or equal to 1\nd.r.y1 &lt;- d.r %&gt;% filter(Year &gt;= 1)\n\nggplot(data=d.r.y1, aes(x=Year, y=est.N)) + geom_line() +\n  geom_point() + labs(title=\"Population Size\")\nggplot(data=d.r.y1, aes(x=Year, y=r)) + geom_line() +\n  geom_point() + labs(title=\"Per capita growth rate since 1 CE\")\n\n\n\n\n\n\n\n\n\nFigure 6.7: In the current era, per capita growth remains mostly positive, and then rises sharply and begin to fluctuate dramatically after 1500.\n\n\n\n\n\n\n6.5.1 Your own interval\nMake a graph of per capita growth rate for a time period of your own choosing. Select a time that is different than any other that we have shown here, and make it at least 10 years\n\n\n6.5.2 How does per capita growth rate change with population size?\nLarge populations differ from small populations in a lot of ways. Large populations might make more waste products and do more damage to their own environment, and they also foster more interactions among individuals that might have positive or negative consequences.\nLet’s make a graph of per capita growth rate as a function of population size.\n\n\n\n\n\n\n\n\nFigure 6.8: Per capita growth rate vs. population size, since 1 CE after 1500. What do you make of this? :)",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Density-independent Population Growth: Humans on the rise</span>"
    ]
  },
  {
    "objectID": "06-DI-pop-growth.html#projecting-into-the-future",
    "href": "06-DI-pop-growth.html#projecting-into-the-future",
    "title": "6  Density-independent Population Growth: Humans on the rise",
    "section": "6.6 Projecting into the future",
    "text": "6.6 Projecting into the future\nHere we use our projection equation from above (\\(N_t=N_0 e^{rt}\\)) to make predictions about the future. Imagine a population of 100 individuals and \\(r=0.02\\) per year, and predict how big that population would become after thirty years. Assume that \\(r\\) is constant over that time period.\n\\[\\begin{align}\nN_t &= N_0 e^{rt}\\\\\n    &= 100 e^{0.02 \\cdot 30} = 182.21\n\\end{align}\\]\nWhen we take this approach, we are assuming that the population continues to grow at this rate over the projected time period. That can be a reasonable assumption over short time periods, but not over long time periods. Of course, “short” and “long” are both relative, and depend heavily of the context.\nWhat can we learn from (Figure 6.8)? Over what time periods would it seem reasonable to assume that the human population grows at a constant rate?",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Density-independent Population Growth: Humans on the rise</span>"
    ]
  },
  {
    "objectID": "06-DI-pop-growth.html#deliverables",
    "href": "06-DI-pop-growth.html#deliverables",
    "title": "6  Density-independent Population Growth: Humans on the rise",
    "section": "6.7 Deliverables",
    "text": "6.7 Deliverables\nTurn in two documents: (i) your R script, and (ii) a .docx or PDF formatted file containing the following:\n\nCalculate by hand the exponential growth rate (r) for the years listed above in Section 6.4.2. Write out the formula, substitute the values to show you know where they belong, and then finish with the arithmetic to find \\(r\\).\nA graph showing per capita growth rate for a time period of your own choosing, from Section 6.5.1.\nIf the human population continued to grow at the rate you calculated for 2020, how large would the population be in 2050? Calculate this and show your work.\nWhat assumptions did you make in answering Question 3? Based on results for questions 1 and 2, is it likely that the human population will reach the size that you calculated for 2050? Why or why not? Use evidence in the data and the graphs above to justify your explanation.\nHow many people were alive when you were born? How many people will there be at the end of your lifetime? Are you going to live through a doubling of the human population? Why or why not?\n\n\n\n\n\nHastings, A. 2011. “Single Species Population Dynamics and Its Theoretical Underpinnings.” In, edited by S. M. Scheiner and M. R. Willig. Chicago, IL, USA: University of Chicago Press.\n\n\nLee, Ronald. 2011. “The Outlook for Population Growth.” Science 333 (6042): 569–73. https://doi.org/10.1126/science.1208859.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Density-independent Population Growth: Humans on the rise</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html",
    "href": "07-structured-pop-growth_v2.html",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "",
    "text": "7.1 Goals\nIn this chapter, you’ll connect sea turtle natural history to a demographic model of population growth and learn how we all learned about how to help sea turtles. Along the way, you’ll learn about sea turtle natural history, demography, dynamics and model sensitivity.\nIf you successfully complete this chapter, you will",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#goals",
    "href": "07-structured-pop-growth_v2.html#goals",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "",
    "text": "discover key stages in a sea turtles life,\ndescribe population structure,\nuse natural history information to parameterize a mathematical model to make predictions about sea turtles,\ndistinguish between transient dynamics and long-term asymptotic dynamics, and\nrecommend management options for sea turtles conservation.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#preparatory-steps",
    "href": "07-structured-pop-growth_v2.html#preparatory-steps",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "7.2 Preparatory steps",
    "text": "7.2 Preparatory steps\n\nWatch the lecture video on Structured population growth, and the preceding population ecology videos (distribution and abundance, and density-independent population growth).\nDownload Crouse et al. (1987) from our article archive.\nThis chapter does not use a separate data set, but it does use demographic natural history information in Crouse et al. (1987).\nFind out what you need for the deliverables (Section 11.12).",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#demography",
    "href": "07-structured-pop-growth_v2.html#demography",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "7.3 Demography",
    "text": "7.3 Demography\nDeomgraphy includes the structure of a population which is the relative numbers of individuals of different ages or stages. Deomgraphy also includes the rates that control that structure which are primarily age- and stage-specific birth rates, death rates, and survival. We use this detailed information to make informed predictions about the population’s future state, including its overall size and its structure. Therefore, demography also includes the overall rates, including population growth, that emerge from all the detailed age/stage-specific information. The study of human demography helps nations make informed policy decisions that take into account how societies will change over time due to populations that are growing, shrinking, aging or getting younger on average (Lee 2011). The study of many rare, threatened or vulnerable species includes demography because demography helps us understand and manage populations (Caswell 2001).",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#loggerhead-sea-turtles",
    "href": "07-structured-pop-growth_v2.html#loggerhead-sea-turtles",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "7.4 Loggerhead sea turtles",
    "text": "7.4 Loggerhead sea turtles\nThe loggerhead sea turtle (Caretta caretta) is a widely distributed (i.e. cosmopolitan) species that lives in oceans around the world. The International Union for Conservation of Nature (IUCN, https://www.iucnredlist.org/) lists it as “vulnerable” to extinction, which, sadly, is pretty good these days. The fact that the species is not worse off is in part due to research like that of Crouse, Crowder, and Caswell (1987). This research by Deborah Crouse, Hal Caswell, and many others is the subject of what you will work with in this assignment.\nSea turtles live in warm oceans around the world and reproduce on sandy beaches. Females return to the same beaches most years to lay eggs in clutches. They come ashore, dig a hole in the sand, lay 10-100 eggs, and cover the nest, often disguising it from terrestrial predators who would like to dig them up to eat them. The female then returns to the sea to feed and ovoid enemies. If the everything goes right, the eggs hatch after incubation, hatchlings emerge together, struggle to the surf, and attempt to avoid the many predators (e.g., gulls, raccoons, crabs, people). Sea turtle hatchlings face many threats, including from humans who eat the eggs, and trucks or off-road vehicles can destroy the nests. In addition, lighting from nearby streets and homes can confuse hatchlings as they may crawl toward the lights as opposed to heading out to sea.\n\n7.4.1 Questions about loggerhead survival\nInclude answers to these in Deliverables. 1. Consult Table 3 (Crouse et al. 1987). a. Which two stages have the lowest annual survivorship? a. Which stages have the highest annual survivorship? 1. Why do you suppose that 1st year remigrants have such low fecundity?\nFishing trawlers, which drag nets for long distances to catch shrimp and fish create another source of mortality in juveniles and adults. The sea turtles get caught in these nets and drown. These dead turtles are referred to as “by-catch”, that is, animals killed unintentionally while fishing for other species.\nSea turtle populations have been on the decline for well over a century, and some species are more endangered than others. One common conservation strategy has been to protect the eggs and hatchlings. More recently, some countries have passed laws requiring fishing trawlers (fishing boats dragging huge nets for hours at a time) to use turtle excluders devices (TEDs). These spring-loaded devices fit at the end of a trawler net and will open up when they receive a big bump from a heavy sea turtle. This allows the turtle to escape, and the fishermen lose only a fraction of their catch.\nNo one really knew the value of TEDs until Deborah Crouse and others modeled sea turtle populations and showed clearly that (1) saving eggs and hatchlings was not enough, and (2) increasing survival of large turtles (large juveniles and adults) was required to save the turtles from continued declines and extinction.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#demographic-modeling",
    "href": "07-structured-pop-growth_v2.html#demographic-modeling",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "7.5 Demographic modeling",
    "text": "7.5 Demographic modeling\nWe use a square matrix to summarize a species’ age- or stage-specific demographic rates. A matrix is mathematical array of numbers with specified rows and columns. The dimension of a matrix is its number of rows and number of columns. A matrix with the same number rows as columns is called a square matrix.\nThe effect of a matrix element on long term asymptotic growth rate (lambda) is known as sensitivity or elasticity, depending on the details of the calculations. There are abstract ways to calculate those using linear algebra, but here we do it the easy and transparent way. We will change annual survivals of particular stages, and then recalculate lambda and r to examine the effect directly.\nCrouse, Crowder, and Caswell (1987) performed a demographic analysis of an endangered sea turtle species, the loggerhead (Caretta caretta). Management of loggerhead populations seemed essential for their long term survival, and a popular management strategy had been and still is to protect nesting females, eggs, and hatchlings. The ground breaking work by Crouse1 and her colleagues compiled data to create a stage-based projection matrix to analyze quantitatively which stages are most important and least important in influencing long-term growth rate. This work led to US Federal laws requiring that US shrimp fishermen use nets that include Turtle Excluder Devices (TEDs).\nA demographic transition matrix is merely a compact quantitative summary of a species’ life history events. It includes the annual probabilities that an individual remains in a particular stage, grows into a later stage, or even regresses back to an “earlier” stage. It also includes the fertility or number of progeny it contributes to the first stage. These stages may be age classes (e.g., 0-5 y), sizes (e.g., 2-4 leaves), or some other major life history stage (e.g., first year breeder).\nThe transition matrix holds each of the probabilities and fertilities in a way that the column identifies the stage at time \\(t\\) whereas the row identifies the next time period \\(t+1\\).\n\n\n\n\n\n\nFigure 7.2: A toy demographic transition matrix, with stages of hatchlings (H), juveniles (J), and adults (A). Elements represent the probability that an individual belonging to the stage in the column stays in or transitions to the stage in the row over a single year. Fecundity (f3) represents the total number of offspring that an individual contributes to the stage in that row.\n\n\n\nIn Figure 7.2, the element \\(s_2\\) is the probability that a juvenile in year 1 survives to remain a juvenile in year 2. The element \\(g_2\\) represents the probability that a juvenile in year 2 survives and also become a reproductively mature adult in year 2. The element \\(g_1\\) is the probability that a hatchling survives and becomes a juvenile in year 2. The element \\(s_3\\) is the probability that an adult survives and remains an adult. We refer to the elements on the diagonal (\\(s\\)) as stasis and the elements on the off-diagonal (\\(g\\)) as growth.\nFecundity or reproduction is seen as adults contributing the to smallest or youngest stage. The element \\(f_3\\) is the number of hatchlings that occur in year 2 based on the survival and reproduction of the average adult. The element \\(s_1\\) is the survival of hatchlings. If the stage only exists for one year, then \\(s_1=0\\) because, by definition, after one year a hatching is a juvenile, or it is dead.\n\n7.5.1 Connecting life history information to a model\nCrouse, Crowder, and Caswell (1987) gathered data from a variety of sources to estimate loggerhead turtle survival and fertility at different ages and stages. They organized these data in the form of a transition matrix, A. They then used this model to evaluate the relative importance of different stage transitions to the population gorwth rate.\nOn the basis of their analysis, they were able to identify that the survival of juveniles and subadults was the most important determinant of turtle growth rate, under the current circumstances. It was this insight, made possible only because of astructure population model, that led to changes in laws to require the use of turtle excluder devices (TEDs) in fishing and shrimpo trawlers.\nIn this assignment, you will walk through the types of analyses done by Deborah Crouse and her colleagues. They combed the literature to find information about survival and reproduction by loggerheads and summarized those findings in their tables 1 and 2. They then organized that information into a more con densed form and presented it in Table 3, shown here in Figure 7.3.\n\n\n\n\n\n\nFigure 7.3: Estimates of stage-specific survival and fecundity for loggerhead sea turtles, from Table 3 in Crouse et al. (1987). Based on information described in Tables 1 and 2 in Crouse et al. (1987).\n\n\n\nTheir transition matrix (Table 4):\n\\[\\begin{array}{c}\n\\\\H\\\\J_s\\\\J_l \\\\sub \\\\ B_1 \\\\B_2 \\\\ M\n\\end{array}\n\\left(\n\\begin{array}{cccccccc}\nH&J_s & J_l & sub & B_1 & B_2 & M\\\\\n     0&      0&      0&      0&    127&      4& 80\\\\\n0.6747& 0.7370&      0&      0&      0&      0& 0\\\\\n     0& 0.0486& 0.6610&      0&      0&      0& 0\\\\\n     0&      0& 0.0147& 0.6907&      0&      0& 0\\\\\n     0&      0&      0& 0.0518&      0&      0& 0\\\\\n      0&      0&      0&      0& 0.8091&      0& 0\\\\\n      0&      0&      0&      0&      0& 0.8091& 0.8089\n\\end{array}\n\\right)\\]\n\n\n7.5.2 Connecting life histories to demographic matrices\n\nCompare Table 3 and Table 4 (Crouse et al. 1987). What are the relationships between survival and fecundity in Table 3, and the diagonal (stasis) and off-diagonal elements (growth) of the matrix in Table 4? How are they related?\nWhy are the diagonal matrix elements (Table 4) not the same are the annual survivorship in Table 3?\n\nTo use the information in Table 3 to make predictions about the long-term viability of the population and to make recommendations for the conservation of the population, Crouse and colleagues need to combine these stage-specific demographic rates into a model, and summarize the behavior of that model.\nTheir first step was to put the above rates into a demographic transition matrix, where columns represent stages in one year, and the rows represent stages in the next year.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#analysis-of-a-demographic-matrix",
    "href": "07-structured-pop-growth_v2.html#analysis-of-a-demographic-matrix",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "7.6 Analysis of a demographic matrix",
    "text": "7.6 Analysis of a demographic matrix\nAs with all of our work, confirm you are in the correct working directory.\n\ngetwd()\n\n[1] \"/Users/stevenmh/projects/intro_to_ecology\"\n\n\nFix this, if necessary.\nLoad needed packages.\n\n## for graphics and data manipulation\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nTwo of the techniques we use to analyze a demographic matrix are simulation, and a mathematical technique called eigenanalysis. Simulation allows us to reveal the dynamics through time, year after year, generation after generation. Eigenanalysis allows us to very quickly quantify average characteristics of the population, including the population growth rate, \\(\\lambda\\), the stable stage distribution, and the elasticities.\n\npopulation growth rate, \\(\\lambda\\), is the long term finite rate of increase and assumes density-independent growth.\nstable stage distribution is the set of expected relative densities of the different stages.\nelasticies are the relative importances of the different transitions to determining the finite rate of increase, \\(\\lambda\\).\n\nWe will focus on lambda, and do some experiments playing around with survival and growth.\nFirst, we need to create the observed transition matrix.\n\nA &lt;- matrix(\n  c(0,      0,      0,      0,    127,      4,    80,\n    0.6747, 0.7370, 0,      0,      0,      0,     0,\n    0,      0.0486, 0.6610, 0,      0,      0,     0,\n    0,      0,      0.0147, 0.6907, 0,      0,     0,\n    0,      0,      0,      0.0518, 0,      0,      0,\n    0,      0,      0,      0,      0.8091, 0,      0,\n    0,      0,      0,      0,      0,      0.8091, 0.8089), \nnrow=7, ncol=7, byrow=TRUE)\nrownames(A) &lt;- colnames(A) &lt;- c(\"H\",\"J_s\",\"J_l\", \"sub\", \"B_1\", \"B_2\", \"M\")\nA\n\n         H    J_s    J_l    sub      B_1    B_2       M\nH   0.0000 0.0000 0.0000 0.0000 127.0000 4.0000 80.0000\nJ_s 0.6747 0.7370 0.0000 0.0000   0.0000 0.0000  0.0000\nJ_l 0.0000 0.0486 0.6610 0.0000   0.0000 0.0000  0.0000\nsub 0.0000 0.0000 0.0147 0.6907   0.0000 0.0000  0.0000\nB_1 0.0000 0.0000 0.0000 0.0518   0.0000 0.0000  0.0000\nB_2 0.0000 0.0000 0.0000 0.0000   0.8091 0.0000  0.0000\nM   0.0000 0.0000 0.0000 0.0000   0.0000 0.8091  0.8089\n\n\nThen we can calculate lambda. Remember that lambda is just the ratio of population sizes in sequential years (\\(\\lambda=N_{t+1}/N_{t}\\)).\n\noriginal_lambda &lt;- Re( eigen(A)$values[1] )\noriginal_lambda\n\n[1] 0.945031\n\n\nThis value, \\(\\lambda = 0.94\\), is less than \\(\\lambda=1\\), and therefore indicates a shrinking population. This shows that the loggerhead sea turtle was predicted to decline.\nWhat can we do?",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#finding-the-life-history-stage-that-could-make-the-biggest-difference",
    "href": "07-structured-pop-growth_v2.html#finding-the-life-history-stage-that-could-make-the-biggest-difference",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "7.7 Finding the life history stage that could make the biggest difference",
    "text": "7.7 Finding the life history stage that could make the biggest difference\nPart of managing rare species is figuring out which part of the population, the age, or the stage on which to concentrate your efforts.\nA good way to figure out where to focus our effort is to find out which stage could make the biggest difference to the growth rate, \\(\\lambda\\). If we improve survival of an stage and it helps \\(\\lambda\\) increase above 1, focusing on that stage could be a good strategy.\nYour strategy will be to improve the survival in each stage so that individuals in that stage do not die. They either survive and remain in that stage, or they grow into the next stage. That means that with perfect survival, stasis and growth sum to nearly one.\nFor each stage, we will pretend that we can improve annual survivale 99.9%. Some of our stages are only one year in duration, while others are 7, 8, or 30 years in duration. This makes it a little tricky to calculate our new simulated matrix elements. I will do that part for you.\nIn each of seven simulations, you will test the effect on growth rate (\\(\\lambda\\)) of improved survival.\n\n7.7.1 Helping hatchlings\nFor your first experiment, you will test the effect on lambda of improving survival and growth of eggs and hatchlings to 99.9%, or annual survivorship of 0.999. Here are the steps:\n\nCopy the old matrix and rename it (see below!).\nChange the new matrix to include survivorship of 0.999 for the hatchlings (see below!).\nCalculate lambda for the new matrix (see below).\n\n\n## new matrix \nA1 &lt;- A \n\n## Change just the hatchling survival/growth\nA1[2,1] &lt;- 0.999\n## look at the new matrix\nA1\n\n        H    J_s    J_l    sub      B_1    B_2       M\nH   0.000 0.0000 0.0000 0.0000 127.0000 4.0000 80.0000\nJ_s 0.999 0.7370 0.0000 0.0000   0.0000 0.0000  0.0000\nJ_l 0.000 0.0486 0.6610 0.0000   0.0000 0.0000  0.0000\nsub 0.000 0.0000 0.0147 0.6907   0.0000 0.0000  0.0000\nB_1 0.000 0.0000 0.0000 0.0518   0.0000 0.0000  0.0000\nB_2 0.000 0.0000 0.0000 0.0000   0.8091 0.0000  0.0000\nM   0.000 0.0000 0.0000 0.0000   0.0000 0.8091  0.8089\n\n\nIn our new matrix, we see that 99.9% of hatchlings (first column, H) survive to grow into being small juveniles that next year (second row, J_s), that is, \\(a_{2,1} = 0.999\\).\nNow calculate lambda of the new matrix.\n\n## using Re() extracts just the real part of the eigenvalue, and not the imaginary part\nRe( eigen(A1)$values[1] )\n\n[1] 0.964903\n\n\nThis is the new growth rate. Is it greater than 1? Does it suggest that improving hatchling survival will allow this turtle population to grow? How does this compare to the original value of lambda of 0.94? That is, how much did saving all the hatchlings help the loggerhead population? You’ll need this for deliverables.\n\n\n7.7.2 Helping small juveniles\nHere you will test the effect on lambda of improving survival and growth of small juveniles to 99.9%, or annual survivorship of 0.999. This stage lasts seven years, and so I calculated the new matrix elements for you (see the code).\nHere are the steps:\n\n## new matrix with NEW NAME, A2\n## make sure you start with the ORIGINAL matrix A \nA2 &lt;- A\n\n## Change just the stasis and growth for small juveniles\nA2[2,2] &lt;- 0.857 # stasis\nA2[3,2] &lt;-  0.142 # growth\nA2\n\n         H   J_s    J_l    sub      B_1    B_2       M\nH   0.0000 0.000 0.0000 0.0000 127.0000 4.0000 80.0000\nJ_s 0.6747 0.857 0.0000 0.0000   0.0000 0.0000  0.0000\nJ_l 0.0000 0.142 0.6610 0.0000   0.0000 0.0000  0.0000\nsub 0.0000 0.000 0.0147 0.6907   0.0000 0.0000  0.0000\nB_1 0.0000 0.000 0.0000 0.0518   0.0000 0.0000  0.0000\nB_2 0.0000 0.000 0.0000 0.0000   0.8091 0.0000  0.0000\nM   0.0000 0.000 0.0000 0.0000   0.0000 0.8091  0.8089\n\n\nNow that you have a new matrix, calculate the lambda for this matrix. Do that now by borrowing and editing code from above.\nNow calculate the finite rate of increase (\\(\\lambda\\))\n\nRe( eigen(A2)$values[1] )\n\n[1] 1.03806\n\n\nWhat does this value of lambda tell you about the effect of increasing survival of small juveniles (if we could do that)?",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#simulating-helping-other-stages",
    "href": "07-structured-pop-growth_v2.html#simulating-helping-other-stages",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "7.8 Simulating helping other stages",
    "text": "7.8 Simulating helping other stages\nRepeat a similar procedure for each stage, using these values:\n\n\n\n\nTable 7.1: New values to use in the loggerhead sea turtle transition matrix, changing only one stage at a time. These changes reflect 99.9% annual survival. Stasis values belong on the diagonal, such as A[5,5] &lt;- 0, and growth values belong below the diagonal, such as A[6,5]&lt;-0.999. Start with the original matrix, make a copy, and then change only one stage at a time.\n\n\n\n\n\n\nStage\nStasis\nGrowth\n\n\n\n\nH\n0.000\n0.999\n\n\nJ_s\n0.857\n0.142\n\n\nJ_l\n0.875\n0.124\n\n\nsub\n0.833\n0.166\n\n\nB_1\n0.000\n0.999\n\n\nB_2\n0.000\n0.999\n\n\nM\n0.966\n0.000\n\n\n\n\n\n\n\n\nRecord the new value of lambda for each separate simulation.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#sec-deliverables",
    "href": "07-structured-pop-growth_v2.html#sec-deliverables",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "7.9 Deliverables",
    "text": "7.9 Deliverables\nPut the following into a single document:\n\nA life cycle graph for the loggerhead population. On your figure, include the numerical elements associated with each transition, based on the original matrix.\nA table similar to Table 7.1 with all the stages, the provided values of stasis, and growth, and your new values of lambda.\nAssume it is your interest to maximize long-term population growth rate (\\(\\lambda\\)), for which stage or stages should you invest in protection measures? Explain why, and use your values of lambda as evidence in your answer.\n\nUpload this document and your R script to the appropriate site.\n\n\n\n\nCaswell, H. 2001. Matrix Population Models: Construction, Analysis, and Interpretation. Second. Sinauer Associates, Inc., Sunderland, MA, USA.\n\n\nCrouse, D T, L B Crowder, and H Caswell. 1987. “A Stage-Based Population Model for Loggerhead Sea Turtles and Implications for Conservation.” Ecology 68: 1412–23.\n\n\nLee, Ronald. 2011. “The Outlook for Population Growth.” Science 333 (6042): 569–73. https://doi.org/10.1126/science.1208859.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "07-structured-pop-growth_v2.html#footnotes",
    "href": "07-structured-pop-growth_v2.html#footnotes",
    "title": "7  Structured demography: How a graduate student helped save the loggerhead sea turtle",
    "section": "",
    "text": "Crouse was a graduate student at the time—graduate students are the life-blood of modern science, doing cutting edge work and pushing their fields forward.↩︎",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Structured demography: How a graduate student helped save the loggerhead sea turtle</span>"
    ]
  },
  {
    "objectID": "08-density-dep-pop-growth.html",
    "href": "08-density-dep-pop-growth.html",
    "title": "8  Density-dependence in population growth",
    "section": "",
    "text": "8.1 Goals\nIn this chapter, you’ll learn how we represent crowding in populations. Per capita population growth rate often depends on population density. Along the way, you’ll learn we take ideas seriously, and follow them to their logical conclusions.\nIf you successfully complete this chapter, you will",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Density-dependence in population growth</span>"
    ]
  },
  {
    "objectID": "08-density-dep-pop-growth.html#goals",
    "href": "08-density-dep-pop-growth.html#goals",
    "title": "8  Density-dependence in population growth",
    "section": "",
    "text": "extend exponential growth to include the effect of crowding,\ndefine density-dependence,\ndistinguish between transient dynamics and long-term asymptotic dynamics, and\ndiscover the consequences of crowding by solving a rate equation.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Density-dependence in population growth</span>"
    ]
  },
  {
    "objectID": "08-density-dep-pop-growth.html#preparatory-steps",
    "href": "08-density-dep-pop-growth.html#preparatory-steps",
    "title": "8  Density-dependence in population growth",
    "section": "8.2 Preparatory steps",
    "text": "8.2 Preparatory steps\n\nWatch the lecture videos on density-dependent population growth (parts 1 & 2). These videos assume that you watched the preceding population ecology videos.\nFind out what you need for the deliverables.\n\n\n\n\n\n\n\nFigure 8.2: The Hwange elephant population grew dramatically after the end of hunting (“culling”) that had kept the population size small (Chamaillé-Jammes et al. 2008).",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Density-dependence in population growth</span>"
    ]
  },
  {
    "objectID": "08-density-dep-pop-growth.html#models-as-assumptions",
    "href": "08-density-dep-pop-growth.html#models-as-assumptions",
    "title": "8  Density-dependence in population growth",
    "section": "8.3 Models as assumptions",
    "text": "8.3 Models as assumptions\nContinuous logistic population growth is just a set of assumptions about how a population grows. The rate of change in our population is determined by its birth rate and death rate, and how population size affects these.\nThe symbol \\(dN/dt\\) means “change in population size (N) per unit change in time (t)”.\nRecall exponential growth (J-shaped growth) is \\[\\frac{dN}{dt} = rN\\]\nLogistic growth adjusts exponential growth by penalizing it for population size.\n\\[\\frac{dN}{dt} = rN\\left(1-\\alpha N \\right)\\]\nwhere \\(\\alpha\\) is a small number much less than one, and it is the effect of one individual on the growth rate of the population. Thus, as \\(N\\) gets bigger, \\(\\alpha N \\rightarrow 1\\) (approaches 1), and \\(1-1=0\\).\n\n\n\n\n\n\n\n\nFigure 8.3: Logistic growth in a hypothetical population (parameters: \\(r=0.25\\), \\(\\alpha = 1/27000\\)).\n\n\n\n\n\nYou see that in Figure 8.3, the growth rate slows dramatically as the population size approaches some limit. We call that limit the carrying capacity of the population, and it is determined by the effects of individuals on the population growth rate, or \\(\\alpha\\).\n\n8.3.1 Math describes nature: on parameters and their meanings\nOften, we can describe a biological process in several different mathematical ways. Density-dependence in logistic growth is one such case.\nWe can define logistic growth in two ways that are opposite sides of the same coin. Above, we used \\(\\alpha\\) to quantify the average effect of one individual on the growth rate of the population. Another common way to define logistic growth is by the consequences of these average individual effects: the carrying capacity which we call \\(K\\). It turns out that the carrying capacity is the inverse of the effect of an individual, so that \\[K = \\frac{1}{\\alpha}\\] and as a result we can rewrite logistic growth as \\[\\frac{dN}{dt} = rN\\left(1-\\frac{ N}{K} \\right)\\]\nwhich is exactly equivalent to the first version we described above.\n\n\n8.3.2 Solving a rate equation\nWe solve a rate equation in order to learn something about it’s asymptotic behavior. By “learn something” we mean figure out what will determine the size of population. By “asymptotic”, we mean really, really, long-term. We hope to find out what will eventually happen to the population and what will control it’s destiny.\nAnother way to think about this is that we are seeking to find the equilibrium state, the state of the population toward which the population will tend to move. Imagine a marble in a wok or bowl. The marble will tend to move toward the bottom. When it finally settles down and stops moving, it is at its equilibrium state.\nWe solve a rate equation by setting it equal to zero, because we want to understand what determines when the population stops changing.\n\n\n8.3.3 Assignment 1: Use math to understand the consequences of our assumptions.\nNow solve for the equilibrium, when \\(dN/dt = 0\\). That is, let\n\\[0 = rN\\left(1-\\alpha N\\right)\\]\nand solve for \\(N\\). That is, rearrange to get \\(N\\) on the left side \\(N=\\) and other stuff on the right side, and then simplify. SHOW ALL THE STEPS IN YOUR WORK.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Density-dependence in population growth</span>"
    ]
  },
  {
    "objectID": "08-density-dep-pop-growth.html#discrete-difference-equations",
    "href": "08-density-dep-pop-growth.html#discrete-difference-equations",
    "title": "8  Density-dependence in population growth",
    "section": "8.4 Discrete difference equations",
    "text": "8.4 Discrete difference equations\nSometimes, it is simpler to think about rate equations in a step-wise annual fashion, where each change is a discrete step, rather than continuous change.\nN (this year) = N (last year) + births - deaths\nIn this case, the rate of change is a difference between \\(N\\) this year versus last year,\nN (this year) - N (last year) = \\(\\Delta\\)N = births - deaths\nIn this situation, we call this a difference equation.\nThe difference equation for logistic growth is\n\\[N_t - N_{t-1} = \\Delta N = r_d N_{t-1}\\left(1- \\alpha N_{t-1}\\right)\\]\nwhere the number of births and deaths is described by \\(r_d N_{t-1}\\left(1-N_{t-1}/K\\right)\\).\nNotice an important feature of this equation: the density-dependence \\((1-\\alpha N_{t-1})\\) depends on the size of the population at one point in time (\\(t-1\\)), but the population is projected out past this time. As a result, the dampening or slowly effect of density is delayed, always lagging behind just a little bit. You will investigate the consequences of this in your exrecise.\nWe can project the population dynamics using\n\\[N_t = N_{t-1}  +r_d N_{t-1}\\left(1-\\alpha N_{t-1}\\right)\\]\n\n8.4.1 Assignment 2: Explore delayed density-dependence\nHere you will explore the consequences delayed density-dependence. In this exercise, you will discover stable points in a stable limit cycle. These stable points are the values of \\(N\\) to which a population returns.\nYou will also discover mathematical chaos. In science, chaos is defined as a deterministic, non-repeating pattern that is bounded, and characterized by sensitivity to initial conditions.\nIn the code below, you will do several things. First, we set up things that won’t change,\n\nthe carrying capacity (\\(K=100\\)),\nthe number of generations (50).\nan empty vector that will eventually hold all of our values of \\(N\\).\nthe initial size of the population. For simplicity, keep this between 40 and 70.\n\nNext we do things to investigate the consequences of delayed density-dependence. Here we investigate what happens when populations grow slowly (small \\(r_d\\)) vs. quickly (large \\(r_d\\)).\nYou will do these things four times.\n\nSelect a value of \\(r_d\\). Pick four different values for rd , one each between\n\n0.2 and 1.5,\n2.1 and 2.4,\n2.45 - 2.56\n2.7- 3.\n\nFor your first value of \\(r_d\\), project the dynamics, graph the time series of the dynamics, and save the graph under a unique name.\nRepeat for the second, third, and fourth values of \\(r_d\\).\n\nWhen you are finished, you should have four graphs that each use a different value of \\(r_d\\) and each should look quite different.\nStep 1 Set up things that won’t change.\n\n## Define K, N0, the number of generations\nK &lt;- 100\ngens &lt;- 50\n## make numeric vector for each N in each generation, plus one more\nN &lt;- numeric(gens)\n\n## Start the population out at this number of individuals\nN[1] &lt;- 45\n\nSelect a value of \\(r_d\\) and use a for-loop to project the population through time, from one year to the next.\n\n############################################\n## THIS IS WHERE YOU PICK THE VALUE OF rd YOU WANT\nrd &lt;- 0.2\n############################################\n\n\n## project the population\nfor(t in 2:gens) { \n  N[t] &lt;- N[t-1] + N[t-1]*rd*(1-N[t-1]/K) \n}\n\n# store this result in a data frame\nmy.N &lt;- data.frame(year=1:gens, N=N)\n\n#for kicks, look at rows 1-3.\nmy.N[1:3,]\n\n  year     N\n1    1 45.00\n2    2 49.95\n3    3 54.95\n\n\nGraph the time series of the population dynamics, and change the name of the file that you save using ggsave().\n\n## graph your data\nggplot(data=my.N, aes(x=year, y=N )) + \n  geom_point() + \n  geom_line() +\n  labs(title = \"Discrete Logistic Growth\",\n       subtitle=paste(\"rd =\", rd))\n\n\n\n\n\n\n\n## save your graph USING A UNIQUE NAME\nggsave(\"dynamics-rd-0.2.png\", height=5, width=6)\n\nPut into one document your four graphs, and a description of how the graphs differ, including\n\nthe relationship between \\(r_d\\) and the year in which the carrying capacity is reached or exceeded,\nthe predictability of the dynamics, and\nthe number of stable points to which the population returns.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Density-dependence in population growth</span>"
    ]
  },
  {
    "objectID": "08-density-dep-pop-growth.html#sec-deliverables",
    "href": "08-density-dep-pop-growth.html#sec-deliverables",
    "title": "8  Density-dependence in population growth",
    "section": "8.5 Deliverables",
    "text": "8.5 Deliverables\nPut your work from section 8.3 (Assignment 1) and section 8.4 (Assignment 2) into one document and turn in by the due date.\n\n\n\n\nChamaillé-Jammes, Simon, Hervé Fritz, Marion Valeix, Felix Murindagomo, and Jean Clobert. 2008. “Resource Variability, Aggregation and Direct Density Dependence in an Open Context: The Local Regulation of an African Elephant Population.” Journal of Animal Ecology 77 (1): 135–44.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Density-dependence in population growth</span>"
    ]
  },
  {
    "objectID": "09-direct-interactions.html",
    "href": "09-direct-interactions.html",
    "title": "9  Direct species interactions: understanding mechanisms of invasion in mosquitoes",
    "section": "",
    "text": "9.1 Goals\nSpecies interact with each other. Sometimes those interactions are negative and cause population sizes to decline, and we call that competition. Other times, those interactions are positive and cause population sizes to increase, and we call that mutualism. This chapter explores an example of competition, in which investigators attempted to understand whether a native mosquito, Aedes triseriatus would compete with and inhibit the growth and spread of the Asian tiger mosquito, Aedes albopictus (Figure 9.1) (Livdahl and Willey 1991).\nIn this chapter, you will,",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Direct species interactions: understanding mechanisms of invasion in mosquitoes</span>"
    ]
  },
  {
    "objectID": "09-direct-interactions.html#goals",
    "href": "09-direct-interactions.html#goals",
    "title": "9  Direct species interactions: understanding mechanisms of invasion in mosquitoes",
    "section": "",
    "text": "learn a simple rule determining whether can species coexist,\ndo a little theory: extend density to include a second species,\ndo a little algebra: solve simultaneously two growth equations to determine coexistence criteria, and\nstart to develop a greater understanding and intuition for species interactions.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Direct species interactions: understanding mechanisms of invasion in mosquitoes</span>"
    ]
  },
  {
    "objectID": "09-direct-interactions.html#preparatory-steps",
    "href": "09-direct-interactions.html#preparatory-steps",
    "title": "9  Direct species interactions: understanding mechanisms of invasion in mosquitoes",
    "section": "9.2 Preparatory Steps",
    "text": "9.2 Preparatory Steps\n\nDownload the slides and watch the video on competition (4b) before proceeding.\nThis chapter does not use a separate data set, but it does use results from Livdahl and Willey (1991). Download Livdahl and Willey (1991) from our article archive.\nFind out what you need for the deliverables (Section 11.12).",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Direct species interactions: understanding mechanisms of invasion in mosquitoes</span>"
    ]
  },
  {
    "objectID": "09-direct-interactions.html#background",
    "href": "09-direct-interactions.html#background",
    "title": "9  Direct species interactions: understanding mechanisms of invasion in mosquitoes",
    "section": "9.3 Background",
    "text": "9.3 Background\nWe don’t often know for sure what determines the establishment and spread of non-native species in a novel environment, but a variety of mechanisms and factors have been shown to play important roles in some situations, includ ing,\n\nan environment similar to the home environment, or otherwise hospitable,\npresence of mutualists from which a species benefits,\nan absence of enemies that recognize a species,\nthe presence of competitors.\n\nHere we investigate the role of competition in potentially inhibiting the spread of the Asian tiger mosquito (Aedes albopictus) outside its native range, in North America (Livdahl and Willey 1991).\nTodd Livdahl and Michelle Willey (1991) investigated how intensely Aedes albopictus would compete with the North American species Aedes triseriatus to try to predict whether the native species would inhibit the spread of the non-native species. Generally, mosquitoes lay eggs on water, which hatch into aquatic larvae that feed on particles in the water. These larvae grow and eventually pupate, and then emerge as flying adults, when the males feed on plant nectar and the females obtain a blood meal. During the larval stage, if population densities are high, mosquitoes can compete for food resources and potentially limit their own growth and the growth of competitors. It was this stage during which Livdahl and Willey measure the strength of intraspecific and interspecific competition (Table 9.1).\nThe version of the two species Lotka-Volterra competition equations we will use are,\n\\[\\frac{dN_1}{dt} = r_1N_1 \\left( 1- \\frac{N_1 + \\alpha N_2}{K_1}\\right)\\]\n\\[\\frac{dN_2}{dt} = r_2N_2 \\left( 1- \\frac{N_2 + \\beta N_1}{K_2}\\right)\\]\n\n\n\n\nTable 9.1: Lotka-Volterra growth and competition parameters of A. triseriatus and A. albopictus in water from tree holes and from tires, based on Livdahl and willey (1991). Values of \\(r\\) and \\(K\\) refer to the species on the respective line. Values for alpha or beta refer to the effect of the competitor. For instance, K = 42.83 is the carrying capacity of A. triseriatus in tree hole water, and alpha = 0.4167 is the effect of A. albopictus on A. triseriatus, in tree hole water.\n\n\n\n\n\n\n\nr\nK\nalpha or beta\n\n\n\n\nA. triseriatus (in treehole water)\n0.0514\n42.8333\n0.4167\n\n\nA. albopictus (in treehole water)\n0.0798\n53.2000\n0.7333\n\n\nA. triseriatus (in tire water)\n0.0591\n32.8333\n0.8333\n\n\nA. albopictus (in tire water)\n0.0904\n45.2000\n0.2500",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Direct species interactions: understanding mechanisms of invasion in mosquitoes</span>"
    ]
  },
  {
    "objectID": "09-direct-interactions.html#invasion-criteria",
    "href": "09-direct-interactions.html#invasion-criteria",
    "title": "9  Direct species interactions: understanding mechanisms of invasion in mosquitoes",
    "section": "9.4 Invasion criteria",
    "text": "9.4 Invasion criteria\nRecall from lecture that if \\(K_2 &gt; \\beta K_1\\), then species 2 can invade a population of species. Similarly, if \\(K_1 &gt; \\alpha K_2\\), the species 1 can invade.\nWhat is the case here?",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Direct species interactions: understanding mechanisms of invasion in mosquitoes</span>"
    ]
  },
  {
    "objectID": "09-direct-interactions.html#sec-deliverables",
    "href": "09-direct-interactions.html#sec-deliverables",
    "title": "9  Direct species interactions: understanding mechanisms of invasion in mosquitoes",
    "section": "9.5 Deliverables",
    "text": "9.5 Deliverables\nIn one document include these two graphs and answers to these questions:\n\nDraw the isoclines for both species in water obtained from tree holes. Add one curved line for population trajectories starting at 5 A. triseriatus and 5 A. albopictus.\nDraw the isoclines for both species in water obtained from tires. Add one curved line for the population trajectories starting at 5 A. triseriatus and 5 A. albopictus.\nDo the invasion criteria match the figures? Explain.\nAnswer the original question for these two environments: will the native A. triseriatus inhibit the establishment of the non-native A. albopictus?\n\n\n\n\n\nLivdahl, Todd P., and Michelle S. Willey. 1991. “Prospects for an Invasion: Competition Between Aedes Albopictus and Native Aedes Triseriatus.” Science 253 (5016): 189–91. https://doi.org/10.1126/science.1853204.",
    "crumbs": [
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Direct species interactions: understanding mechanisms of invasion in mosquitoes</span>"
    ]
  },
  {
    "objectID": "10-mutualisms.html",
    "href": "10-mutualisms.html",
    "title": "10  Mutualisms: Do ants protect pea plants?",
    "section": "",
    "text": "10.1 Goals\nDo animals protect plants? If so, why and under what conditions would they do that? In this chapter, you’ll investigate these questions as the apply to partridge pea (Chamaecrista fasciculata Figure 10.1).\nIn this chapter, you will,",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Mutualisms: Do ants protect pea plants?</span>"
    ]
  },
  {
    "objectID": "10-mutualisms.html#goals",
    "href": "10-mutualisms.html#goals",
    "title": "10  Mutualisms: Do ants protect pea plants?",
    "section": "",
    "text": "evaluate whether or in what ways species help each other,\ndevelop testable hypotheses about species interactions,\ngenerate quantitative predictions from your hypothesis,\nrefine your data display expertise, and\nstart to develop a greater understanding and intuition for species interactions.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Mutualisms: Do ants protect pea plants?</span>"
    ]
  },
  {
    "objectID": "10-mutualisms.html#preparatory-steps",
    "href": "10-mutualisms.html#preparatory-steps",
    "title": "10  Mutualisms: Do ants protect pea plants?",
    "section": "10.2 Preparatory steps",
    "text": "10.2 Preparatory steps\n\nGeneral background on mutualisms: Download the slides and watch the video on mutualisms (4c) before proceeding.\nFor a quick summary on the species and experiment in this chapter, watch this five minute video. (This was presented at the 2021 Annual Conference of the Botanical Society of America by a Miami graduate student, Laura Fehling).\nData: go to our class data repository, and download ArthropodObservations.csv.\n\nMake sure the file remains in the same simple format, “comma separated values” (.csv).\nPut ArthropodObservations.csv in your working directory, Rwork.\nContinue to make sure the file remains in the same simple format, “comma separated values” (.csv).\n\nFind out what you need for the deliverables.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Mutualisms: Do ants protect pea plants?</span>"
    ]
  },
  {
    "objectID": "10-mutualisms.html#background-on-partridge-pea-and-friends",
    "href": "10-mutualisms.html#background-on-partridge-pea-and-friends",
    "title": "10  Mutualisms: Do ants protect pea plants?",
    "section": "10.3 Background on partridge pea and friends",
    "text": "10.3 Background on partridge pea and friends\nEcological mutualisms are mutually beneficial interactions between species (+,+). Mutualisms between terrestrial plants and fungi are hundreds of millions of years old and underlie Earth’s forests and grasslands. Symbiotic mutualisms between corals (which are animals) and dinoflagellates (a type of alga) allow for the coral reefs that structure Earth’s shallow tropical seas. Mutualisms are all around us, and often go underappreciated. This chapter brings our attention to a small annual plant that has mutualisms with four completely different types of organisms, with multiple species within each of those types.\nOne good way to think about mutualisms is to identify the types of rewards that species give to each other. Often those rewards are resources, such as when a plant gives sugar to mycorrhizal fungi and the fungus gives phosphorous to the plant. Sometimes a reward is a service, as when a bumblebee pollinates a plant by spreading pollen to the stigma of a female flower in return for nectar from the plant. In many parts of the world, acacia trees provide ants with hollow thorns in which they can build nests, and ants defend the trees from herbivores of all kinds, from caterpillars to elephants. In this case, the ants provide the service of defense, in return for a resource (the physical structure of a hollow thorn).\nFor her Master’s thesis at Miami university, Laura Fehling investigated the multimutualist interactions of partridge pea (Fehling 2022). Partridge pea (Chamaecrista fasciculata, “cam-ee-crist’-a fa-sick’-u-la’-ta”) has four mutualist partner groups: arbuscular mycorrhizal fungi, rhizobia bacteria (Bradyrhizobium sp.), ants, and pollinators Figure 10.2.\n\n\n\n\n\n\nFigure 10.2: The Chamaecrista fasciculata mutualism, showing the exchange of rewards from each partner (left to right, top to bottom: Bumblebee, ants, rhizobia nodules, arbuscular mycorrhizal fungi) to the focal plant (red arrows), and from the plant to the partners (black arrows).\n\n\n\nChamaecrista fasciculata is an annual legume1 that is native to the Midwestern and Eastern United States often occurring in prairies, old fields, and disturbed sites (Fehling 2022 and references therein). The C. fasciculata mutualist system is ideal for studying multiple mutualist effects given the diversity and manipulability of its partners. While all partners receive a form of plant carbon, each benefits the plant with a unique nutrition, protection, or transportation reward. These partners further represent diversity in their (i) physical association (symbiotic vs non-symbiotic), (ii) degree of obligacy, and (iii) specificity to the focal species. Mycorrhizae provide increased uptake of nutrients (esp. phosphorous) and water provided to the plant, and generally have beneficial effects on plant fitness as their supply of nutrients supports increased plant growth. Rhizobia form nodules in the roots of plants where they fix nitrogen into a form usable by plants, and the degree of benefits provided to the plant can vary. C. fasciculata depends primarily on bees for pollen transfer but can self-pollinate at very low rates (references in Fehling (2022)).\nIn addition to producing showy flowers to attract bees, establishing mycorrhizae, and rhizobial nodes, Chamaecrista fasciculata also produce nectar on their leaves in order to attract ants. At the base of the petiole of each compound leaf, they produce a small extrafloral nectary (EFN) which produces nectar to attract ants for defense against herbivory. Unlike acacia trees, the actual benefit of ants to the plant is not always clear. Sometimes they seem to help, and sometimes it is not clear whether they do.\nWhether this behavior by ants actually helps a plant may depend on several things including\n\nother interactions that the plant has,\nthe environmental conditions, and\nhow effective the ants are at removing herbivores.\n\nAs you saw in her video (prep.steps above), Laura set an experiment to test how mutualists interact and how the environmnet alters those interactions. In 2021, she established individual replicate C. fasciculata plants with and without Rhizobia, mycorrhizal fungi, ants, and dry and moist soils, for a total of 16 different experimental combinations (2 x 2 x 2 x 2). Along with lots of other data that Laura collected, she and her undergraduate field assistant observed and counted herbivorous insects every week all summer for two minutes in the morning and in the afternoon. You will analyze these data, the data on total herbivorous insects abundance.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Mutualisms: Do ants protect pea plants?</span>"
    ]
  },
  {
    "objectID": "10-mutualisms.html#your-hypothesis-and-predictions",
    "href": "10-mutualisms.html#your-hypothesis-and-predictions",
    "title": "10  Mutualisms: Do ants protect pea plants?",
    "section": "10.4 Your hypothesis and predictions",
    "text": "10.4 Your hypothesis and predictions\nThe data you have available are total counts of herbivores on each plant and the combination of experimental treatments associated with each plant.\nWhat you now know, based on the above text and preparatory information:\n\nHalf the plants have ants as normal, while half were prevented from having any ants.\nIn total, there were 16 combinations of conditions (what they?).\nWhat mycorrhizal fungi and Rhizobia provide to plants (refer to lecture).\nWhat ants are thought to do.\nYour data: the abundance of herbivores remaining on plants.\n\nQuestions you might consider:\n\nWhich plants would be the healthiest and potentially most attractive to herbivores?\nHalf the plants receive extra water - how might that influence the plants, the ants and ant behavior?\nHow will mycorrhizal fungi (AMF) and rhizobia affect plants and how might those affects alter ant behavior?\nwill the be some combination of factors (water, AMF, rhizobia) that alter the effects of ants?\n\nThink about what you know and ponder the above questions. Then generate a hypothesis about how various conditions might affect how ants protect plants. Recall a scientific hypothesis is a idea about how you think the world works. Remember that a hypothesis differs from predictions: a hypothesis is a mechanism that might operate generally with lots of different organisms, and it is not an observed result in a particular system.\nAfter you have written down your hypothesis, write down a prediction that follows logically and that you can evaluate with the data we have (herbivore abundance and experimental treatments). Once you have a prediction, sketch a graph of what your data would look like if your hypothesized mechanism operated in this partridge pea system.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Mutualisms: Do ants protect pea plants?</span>"
    ]
  },
  {
    "objectID": "10-mutualisms.html#data-analysis",
    "href": "10-mutualisms.html#data-analysis",
    "title": "10  Mutualisms: Do ants protect pea plants?",
    "section": "10.5 Data analysis",
    "text": "10.5 Data analysis\nFirst, open R using RStudio, and set your working directory. You can do this in two ways:\n\nusing the Session menu in RStudio, or\nwith code such as this, in which you customize it to your computer:\n\n\nsetwd(\"C:/Users/chenjoe/BIO209W/Rwork\")\n\nYou can confirm or get your current working directory using this:\n\ngetwd()\n\n[1] \"/Users/stevenmh/projects/intro_to_ecology\"\n\n\nso when I do that, you can see my working directory is the one for this book.\nBefore you proceed, make sure your working directory is your Rwork directory.\nSecond, use RStudio to create a new file of the type “R script”. Save it using a name that reflects this chapter, and end the file name with “.R” or “.r”.\nThird, add a comment as a brief description of the script, and load any R packages you know you will need.\n\n## This script is for chapter XX in Hank's Intro to Ecology primer.\n\n## We always use...\nlibrary(tidyverse)\n## or usually just ggplot2 and dplyr packages within the tidyverse.\n\n\n10.5.1 The data\nMake sure that your data file is in your Rwork directory. and is still just a CSV file.\nOpen the data file (.csv file) in a spreadsheet application, a text editor, or in RStudio. Do not save it the file the spreadsheet application because it will try to change the format.\n\nWith the file open, learn what is on the first several lines. Often, the first line or two will have metadata or information about the data (data about the data).\nBelow the metadata, you will see column headings, separated by commas, because the data are CSV or comma-separated-values.\nBelow the column headins are the data, with columns separated by commas.\n\nClose the data file, and do not save it. If you save it, chances are good that the application will try to save it in a different format.\nImport the data or read the data into R. Here is code for that. You will notice that we use a function that expects a CSV file. You will also notice that we use an argument to tell R how many lines of metadata to skip so it reads only the data and its column headings.\n\n## NOTE that we skip the first 2 lines because they are metadata\nd &lt;- read.csv(\"ArthropodObservations.csv\",\n              skip=2)\n\nLook at your data with one of these two:\n\n# glimpse(d)\n# or \nstr(d)\n\n'data.frame':   225 obs. of  5 variables:\n $ AMF     : chr  \"no_AMF\" \"no_AMF\" \"no_AMF\" \"no_AMF\" ...\n $ Rhizobia: chr  \"no_Rhiz\" \"no_Rhiz\" \"no_Rhiz\" \"no_Rhiz\" ...\n $ Ants    : chr  \"no_Ants\" \"no_Ants\" \"no_Ants\" \"no_Ants\" ...\n $ Drought : chr  \"Normal\" \"Normal\" \"Normal\" \"Normal\" ...\n $ Total   : int  1 1 0 1 1 0 3 1 2 2 ...\n\n\n\nAMF indicates whether a plant did have or did not have arbuscular mycorrhizal fungi.\nRhizobia indicates whether a plant had or did not have symbiotic nitrogen-fixing bacteria.\nAnts indicates whether ants did or did not have access to the plant.\nTotal is the total number of herbivores observed during the sample periods.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Mutualisms: Do ants protect pea plants?</span>"
    ]
  },
  {
    "objectID": "10-mutualisms.html#display-the-data-to-evaluate-your-predictions",
    "href": "10-mutualisms.html#display-the-data-to-evaluate-your-predictions",
    "title": "10  Mutualisms: Do ants protect pea plants?",
    "section": "10.6 Display the data to evaluate your predictions",
    "text": "10.6 Display the data to evaluate your predictions\nUse ggplot(data= ..., aes(x=..., y=...)) to create a data display that has the same structure or format as your sketched prediction. You can take advantage of features you have used before, including,\n\nmore than one independent variable (IV_1, IV_2, etc.),\na box-and-whisker plot of your dependent variable,\na notch in the box-and-whisker plot that gives you an approximate confidence interval on the median.\n\nHere is a generic example:\n\nggplot(data=DATA, aes(x=IV_1, y=DV, color=IV_2)) + \n  geom_boxplot(notch = TRUE) + \n  facet_grid( IV_3 ~ IV_4)\n\nYou would replace “DATA” with your data frame (d), and replace “IV_1” with one of the independent variables, such as Ants or Rhizobia.\nA box-and-whisker plot shows the central 50% of the observations (the box). The median, or central value, is the line across the middle of the box The tails of the distribution are the whiskers. The notch shows an approximate confidence interval on the median. If the notches of two plots don’t overlap, that is good evidence that the two medians differ.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Mutualisms: Do ants protect pea plants?</span>"
    ]
  },
  {
    "objectID": "10-mutualisms.html#deliverables",
    "href": "10-mutualisms.html#deliverables",
    "title": "10  Mutualisms: Do ants protect pea plants?",
    "section": "10.7 Deliverables",
    "text": "10.7 Deliverables\nTwo documents:\nOne document is the script you use to confirm your directory, load packages, import data, and create your graph.\nThe second document must include:\n\nYour hypothesis.\nYour prediction, in writing.\nYour prediction, as a graph.\nA plot of data that has the same structure or format as your sketched prediction.\nA paragraph that includes\n\nan interpretation of your results,\nwhether your results are consistent with your predictions, and in what ways,\na short statement about what your results say about the hypothesis.\n\n\n\n\n\n\nFehling, Laura Sharon. 2022. “Reward Complementarity and Context Dependency in Multispecies Mutualist Interactions in Partridge Pea (Chamaecrista Fasciculata).” PhD thesis, Miami University.",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Mutualisms: Do ants protect pea plants?</span>"
    ]
  },
  {
    "objectID": "10-mutualisms.html#footnotes",
    "href": "10-mutualisms.html#footnotes",
    "title": "10  Mutualisms: Do ants protect pea plants?",
    "section": "",
    "text": "Legumes are a group of plants including peas and beans that typically form rhizobia mutualisms.↩︎",
    "crumbs": [
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Mutualisms: Do ants protect pea plants?</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html",
    "href": "11-predator-prey.html",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "",
    "text": "11.1 Goals\nIn this chapter, you will,",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#goals",
    "href": "11-predator-prey.html#goals",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "",
    "text": "Test the hypothesis that moose and wolves regulate the size of each other’s population.\nUse algebra to estimate parameters in the mathematical model of predator-prey dynamics.\nUse specific quantitative and qualitative criteria to evaluate how well the model describes the dynamics of the population.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#preparatory-steps",
    "href": "11-predator-prey.html#preparatory-steps",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.2 Preparatory steps",
    "text": "11.2 Preparatory steps\n\nGeneral background lectures: Download the PDF slides and watch the video on predation and herbivory before proceeding.\nData: go to our class data repository, and download isleRoyaleData.csv.\n\nMake sure the file remains in the same simple format, “comma separated values” (.csv).\nPut isleRoyaleData.csv in your working directory, Rwork.\nContinue to make sure the file remains in the same simple format, “comma separated values” (.csv).\n\nFind out what you need for the deliverables.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#background",
    "href": "11-predator-prey.html#background",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.3 Background",
    "text": "11.3 Background\nWe have seen examples of how the distribution and abundance of organisms are influenced by\n\nthe physical environment,\nadaptations to the physical environment,\nthe density of individuals in the same population, and\ninteractions with other species which may be prey or enemies or mutualists.\n\nHere we take a closer look out how predator-prey interactions affect populations, and precisely how those interactions can be described.\nAs our example, we focus on the pair-wise predator-prey relationship between moose (Alces alces) and wolves (Canis lupus) on Isle Royale National Park (USA) in Lake Superior. The moose are herbivores, that is, plant enemies, particularly of balsam fir (Abies balsamea) which makes up about 50% of their diet. Aside from severe winter weather and wolves, another enemy of the moose is the winter tick (Dermacentor albipictus), which can sap the health of moose and reduce survival. The wolves have an enemy of their own, canine parvovirus which can kill wolves. In spite of all this complexity, here we investigate the mathematical mechanics of how predators and prey influence each others abundances, and whether we can learn anything about their biology.\nWhen we use mechanistic models in science, we are following the scientific method we may have first been exposed to in K-12 education:\n\nobserve a pattern in nature.\npropose an explanation (hypothesis) that can generate predictions.\ngather data to test the predictions.\nre-evaluate the hypothesis in light of the data.\n\nA mathematical model of predator and prey is a hypothesis about how species interact. You will informally evaluate how well a particular model can explain patterns in our data.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#details-about-our-data",
    "href": "11-predator-prey.html#details-about-our-data",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.4 Details about our data",
    "text": "11.4 Details about our data\nOur data set comes from censuses of moose and wolf populations on Isle Royale from 1959 to 2011 collected by a number of different researchers over that time (Vucetich and Peterson 2009).",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#your-hypothesis-and-predictions",
    "href": "11-predator-prey.html#your-hypothesis-and-predictions",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.5 Your hypothesis and predictions",
    "text": "11.5 Your hypothesis and predictions\nThe data you have available are numbers of moose and wolves each year, 1959-2011.\nWhat you know:\n\npredators can sometimes have negative numerical effects on their prey populations.\nprey can sometimes have positive numerical effects on their predator populations.\nratio-dependent and prey-dependent (Lotka-Volterra) mathematical models of predators and prey make different assumptions about whether the killing rate depends on the ratio of prey to predators, or simply the density of prey.\nThe ratio-dependent predator-prey model predicts that predators will be a constant fraction of the prey population, and does not generate oscillations. In contrast, the Lotka-Volterra predator-prey model predicts that predators are not a constant fraction of the prey population, the populations undergo regular oscillations, and the predator population lags behind the prey population.\nYour data include the abundances of moose and wolves.\n\nFor this chapter, our hypothesis is that the prey-dependent Lotka-Volterra predator-prey model is a reasonable description of the mechanisms driving moose-wolf dynamics. This model makes these predictions:\n\npredators are not a constant fraction of the prey population,\nthe populations undergo regular oscillations, and\nthe predator population lags behind the prey population.\n\nIn order to evaluate the hypothesis you will have to answer about a dozen questions along the way, as you go. Don’t skip these questions.\nThese questions will let you estimate the constant parameters of the Lotka-Volterra model:\n\n\\(r\\), the intrinsic rate of increase.\n\\(a\\), the attack rate, or the rate at which a predator kills a prey, given the prey density.\n\\(b\\), the conversion efficiency, or the rate at which predators makes more babies out of all the prey they kills.\n\\(m\\), per capita mortality rate of the predators.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#data-analysis",
    "href": "11-predator-prey.html#data-analysis",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.6 Data analysis",
    "text": "11.6 Data analysis\nFirst, open R using RStudio, and set your working directory. You can do this in two ways:\n\nusing the Session menu in RStudio, or\nwith code such as this, in which you customize it to your computer:\n\nsetwd(\"C:/Users/paltrowg/BIO209W/Rwork\")\nYou can confirm or get your current working directory using this:\n\ngetwd()\n\n[1] \"/Users/stevenmh/projects/intro_to_ecology\"\n\n\nso when I do that, you can see my working directory is the one for this book.\nBefore you proceed, make sure your working directory is your Rwork directory.\nSecond, use RStudio to create a new file of the type “R script”. Save it using a name that reflects this chapter, and end the file name with “.R” or “.r”.\nThird, add a comment as a brief description of the script, and load any R packages you know you will need.\n\n## This script is for chapter XX in Hank's Intro to Ecology primer.\n\n## We always use...\nlibrary(tidyverse)\n## or usually just ggplot2 and dplyr packages within the tidyverse.\n\nIn this chapter, we need a new package called deSolve. This package solves differential equations and so will let us implement the differential equations of our predator-prey model. First use code below, or the Tools menu in RStudio to install deSolve. Don’t do both.\n\n## For this chapter we also use deSolve\ninstall.packages(\"deSolve\")\n\nThen load the package.\n\nlibrary(deSolve)\n\n\n11.6.1 Load the data\nMake sure that your data file is in your Rwork directory. and is still just a CSV file.\nOpen the data file (.csv file) in a spreadsheet application, a text editor, or in RStudio. Do not save it the file the spreadsheet application because it will try to change the format.\n\nWith the file open, learn what is on the first several lines. Often, the first line or two will have metadata or information about the data (data about the data).\nBelow the metadata, you will see column headings, separated by commas, because the data are CSV or comma-separated-values.\nBelow the column headings are the data, with columns separated by commas.\n\nClose the data file, and do not save it. If you save it, chances are good that the application will try to save it in a different format.\nImport the data or read the data into R. Here is code for that. You will notice that we use a function that expects a CSV file. You will also notice that we use an argument to tell R how many lines of metadata to skip so it reads only the data and its column headings.\n\n## NOTE that we skip the two lines because they are metadata\nd &lt;- read.csv(\"isleRoyaleData.csv\",\n              skip=2)\n\nLook at your data with one of these two:\n\n# glimpse(d)\n# or \nstr(d)\n\n'data.frame':   106 obs. of  3 variables:\n $ Year   : int  1959 1960 1961 1962 1963 1964 1965 1966 1967 1968 ...\n $ Species: chr  \"Moose\" \"Moose\" \"Moose\" \"Moose\" ...\n $ N      : int  560 600 625 640 660 700 720 760 900 1050 ...\n\n\nA time series graph of the our data reveal how the populations change over time (Fig Figure 11.2).\n\nggplot(d, aes(Year, N, colour=Species)) + geom_line() + \n  facet_grid(Species~., scales = \"free\") + \n  geom_smooth( se=FALSE, span=.2, color=\"red\", linewidth=.5) + \n  geom_smooth( se=FALSE, span=.7, color=\"black\", linewidth=.5) \nggsave(\"MooseWolfTS.png\", height=5, width=6)\n\n\n\n\n\n\n\nFigure 11.2: Natural populations undergo fluctuations. Here we smooth the data over different proportions of the time series to reveal different patterns of squiggliness.\n\n\n\n\n\nNext, let’s describe a model of predator and prey interaction. Refer back to the lectures for more information.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#population-growth-models",
    "href": "11-predator-prey.html#population-growth-models",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.7 Population growth models",
    "text": "11.7 Population growth models\nAll of our mathematical and conceptual models of populations have the same form:\nRate of change = rate of gains - rate of losses\nSometimes these gains and losses are combined:\nRate of change = net rate of gains\n\n11.7.1 Examples of population growth models\nExponential growth: \\[\\frac{dN}{dt} = bN-dN = (b-d)N = rN\\]\nLogistic growth (density-dependence): \\[\\frac{dN}{dt} = rN\\left((1-\\frac{N}{K}\\right) = rN - \\frac{r}{K}N^2\\]\nMechanistic models such as there have parameters and state variables. State variables are the quantities that vary through time, such as population size. In contrast, parameters are constants that determine how fast the state variables change. In our exponential growth equation, \\(dN/dt=rN\\), \\(N\\) is the state variable, and \\(r\\) is the parameter.\nNext we create a pair of rate equations where one species’ loss is another’s gain.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#predator-prey-equations",
    "href": "11-predator-prey.html#predator-prey-equations",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.8 Predator-prey equations",
    "text": "11.8 Predator-prey equations\nMaybe the simplest predator prey equation is essentially two-species exponential growth, where exponentially growing prey, \\(N\\), is partly eaten by exponentially growing predators, \\(P\\). First the prey,\n\\[\\frac{dN}{dt} = rN - aN\\] where \\(aN\\) is the rate of loss of prey to predators; this is the rate at which predators attack and kill prey. The units of \\(r\\) and \\(d\\) are individuals per individual per unit time.\nThe predators increase only because they kill and eat prey, \\(aN\\), and only a fraction of these, \\(b\\), get converted into new predators, \\[\\frac{dP}{dt} = baN - mP\\] and predators die at rate \\(mP\\). The parameter \\(b\\) is the efficiency with which prey are converted into predators, that is, are ingested, assimilated by the predator, and actually lead to growth and reproduction rather than cellular respiration. The units of \\(b\\) are predators per prey per unit time, and the units of \\(m\\) are the same as those of \\(r\\) and \\(d\\), individuals per individual per unit time.\nIf we made all these assumptions, and did some algebraic rearrangement, we would learn that predators abundance is predicted to be a constant fraction of prey abundance, \\[P = \\frac{ba}{m}N\\] where both populations will grow exponentially as long as \\(r&gt;d\\) (why?).\nThis model is sometimes referred to as ratio-dependent predation a completely different reason: predation rates can be expressed in terms of the number of prey per predator time number of predators, or \\[aN = a\\frac{N}{P}P\\] .",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#lotka-volterra-prey-dependent-predation",
    "href": "11-predator-prey.html#lotka-volterra-prey-dependent-predation",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.9 Lotka-Volterra prey-dependent predation",
    "text": "11.9 Lotka-Volterra prey-dependent predation\nThe most widely taught predator-prey equation was developed independently by Vito Volterra and Alfred Lotka. Here, the predation rate is expressed as a function of prey density rather than the ratio of prey to predators.\n\\[\\frac{dN}{dt} = rN-aNP\\] \\[\\frac{dP}{dt} = baNP  -mP\\] In the above equations,\n\n\\(r\\) is the intrinsic rate of increase.\n\\(a\\) is the attack rate, or the rate at which a predator kills a prey, given the prey density.\n\\(b\\) is the conversion efficiency, or the rate at which predators makes more babies out of all the prey they kills.\n\\(m\\) is per capita mortality rate of the predators.\n\n\nHow would you characterize the growth of the prey in the absence of predators? (Pretend \\(P=0\\) and solve \\(dN/dt\\))\nHow would you characterize the growth of the predator in the absence of prey? (Pretend \\(N=0\\), and solve \\(dP/dt\\)).\n\nThis model is famous for its oscillations. Do our data show evidence of oscillations? Yes they do. Look at the figures below to estimate how often they undergo a cycle.\n\ndw &lt;- pivot_wider(d, names_from=Species, values_from=N)\nggplot(dw, aes(Moose, Wolf, colour=Year)) + \n  geom_path(arrow=arrow(length=unit(3, \"mm\"), angle = 15, type = \"open\")) + \n  labs(subtitle=\"Each arrow is one annual time step.\")\nggsave(\"MooseWolfPP.png\", height=5, width=5.5)\n\n\n\n\n\n\n\nFigure 11.3: Use this phase plane plot to count how many times the populations undergo a complete counterclockwise cycle.\n\n\n\n\n\n\n11.9.1 Equilbria\nOne thing we can learn from simple models are the equilibria they predict. An equilibrium is a point when the populations stop bouncing around. At these points, the populations stop changing - their growth rates equal zero. By setting growth rates equal to zero, we can use the model to make predictions about what those equilibria are.\nAnother name for an equilibrium is an attractor. We call it an attractor because the population appears to be attracted to it. If some event pushes the abundance of a population away from an equilibrium, the equilibrium seems to attract the population back to it.\nHere we solve for the equilibria of the Lotka-Volterra predator-prey model. We set the prey population growth rate equal to zero, and then use algebra to simplify the expression. This is one way we learn the logical consequences of prey growth being zero.\n\\[0 = rN-aNP\\] If we divide both sides by \\(N\\), we get \\[0 = r-aP\\] and rearranging we get \\[P=r/a\\] This means that the prey population growth rate will be zero when the predator population size is \\(r/a\\). This happens to be the intrinsic rate of increase divided by the attack rate.\nIf the prey population stops changing when \\(P=r/a\\), do you think the predator population will stop growth too?\nNext, we set the predator population growth rate equal to zero, and then use algebra to simplify the expression.\n\\[0 = baNP - mP\\]\n\nSimplify this expression on your own. What do you get? What will \\(N\\) be equal to?\n\n\nIf the prey population stops changing when \\(P=r/a\\) and the predator population stops changing when \\(N=m/(ba)\\), this means that at these two abundances, the population sizes will not change. Births and deaths will continue to occur, and they will perfectly balance each other. These are the expected equilibria for these two populations under this set of assumptions. Something different happens when \\(N\\) and \\(P\\) are not at these values.\nWe abbreviate these equilibria as \\(N^*\\) and \\(P^*\\), which we refer to as “N star” and “P star”.\nIf our populations are regulated approximately according to these rules, we might expect that the average abundances of these populations are approximately equal to these values.\n\nFind the average or mean population size of the wolf population in our data set. Look at the figure and try to guess.\nFind the average or mean population size of the moose population in our data set. Look at the figure and try to guess.\n\nUse R to see how close your guess is.\n\nView(dw)\nmean(dw$Wolf)\nmean(dw$Moose)\n\nNext we find values for the model parameters. It will help to have just pieces of our data sets:\n\n# the number of observations or rows of data\nn &lt;- nrow(dw)\n\n# predator and prey numbers for all years except the last.\nPt &lt;- dw$Wolf[-n]\nNt &lt;- dw$Moose[-n]\n\n# predator and prey numbers for all years except the first\nPt1 &lt;- dw$Wolf[-1]\nNt1 &lt;- dw$Moose[-1]\n\n\n\n11.9.2 Intrinsic rate of increase, r\nOne way to think about the intrinsic rate of increase of a population, \\(r\\), is that it is the maximum per capita growth rate. A crude way to estimate that is to find the maximum observed value in our data.\n\nEstimate \\(r\\) as the maximum annual per capita rate of increase. Recall that \\[r = \\log_e \\frac{N_{t+1}}{N_t}\\]\n\n\n# each year's r\nr &lt;- log(Pt1/Pt)\nr\n\n [1]  0.09531018  0.00000000  0.04445176 -0.13976194  0.26236426  0.07410797\n [7] -0.07410797 -0.16705408  0.00000000 -0.25782911  0.05715841  0.10536052\n[13]  0.13976194  0.04255961  0.25593337  0.27958486  0.07061757 -0.25782911\n[19]  0.16251893  0.07232066  0.15082289 -0.51082562 -0.76214005  0.49643689\n[25]  0.04255961 -0.08701138 -0.09531018 -0.22314355 -0.28768207  0.00000000\n[31]  0.22314355 -0.22314355  0.00000000  0.08004271  0.26826399 -0.06062462\n[37]  0.31845373  0.08701138 -0.53899650  0.57981850  0.14842001 -0.42285685\n[43] -0.11122564  0.11122564  0.42285685  0.03390155  0.00000000 -0.35667494\n[49]  0.09097178  0.04255961 -0.23361485 -0.17185026\n\n# the maximum\nrMax &lt;- max(r)\nrMax\n\n[1] 0.5798185\n\n\n\n\n11.9.3 Attack rate, a\nIt is worth noting that \\(aN\\) is the rate at which the average wolf kills moose. We will estimate the attack rate, \\(a\\), by realizing that the predator equilibrium equals \\(r/a\\), or \\[a = r/P^*\\] where our estimate of \\(P^*\\) is the average size of the wolf population.\n\nEstimate \\(a\\) using your above estimates of \\(r\\) and \\(P^*\\).\n\n\na &lt;- rMax / mean(dw$Wolf)\na\n\n[1] 0.0248829\n\n\n\n\n11.9.4 Predator mortality rate, m\nOne way to think about the predator mortality rate, \\(m\\), is that it is the maximum rate per capita rate of decline. Put another way, it is the minimum per capita population growth rate, and this will be a negative number.\n\nEstimate \\(m\\). Find the minimum \\(r\\) for the wolf population across all years. Let that the absolute value of that minimum be \\(m\\). Remember that \\(m\\) by itself is a positive number….\n\n\n# mortality, estimated as the minimum log( P[t+1] / P[t] )\nm &lt;- abs( min(r) )\nm\n\n[1] 0.7621401\n\n\n\n\n11.9.5 Conversion efficiency, b\nThe predator conversion efficiency is the prey-dependent birth rate of predators. Thus, for each prey killed, an average predator will produce and successfully rear \\(b\\) offspring. Given that only a few females in a population produce pups, and that number is averaged across the entire wolf population, that number is relatively small. However, a single moose is pretty big and so goes a long way.\nHere we use our previous estimates of \\(a\\), \\(m\\), and \\(N^*\\) to estimate \\(b\\), where \\[N^* = \\frac{m}{ba}\\] and \\[b=\\frac{m}{aN^*}\\]\n\nUse the above expression to estimate \\(b\\).\n\n\nb &lt;- m / (a * mean(dw$Moose))\nb\n\n[1] 0.03036836",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#predicting-population-dynamics",
    "href": "11-predator-prey.html#predicting-population-dynamics",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.10 Predicting population dynamics",
    "text": "11.10 Predicting population dynamics\nThis is how you tell R what the differential growth equations are.\n\npredpreyLV &lt;- function(t, y, p) {\n    with( as.list( c(y,p) ), {\n      dN &lt;- r*N - a*N*P\n      dP &lt;- b*a*N*P - m*P\n      return( list( c(dN, dP) ))\n    })\n}\n\nHere you tell R what the parameters, initial abundances, and years are.\n\nparms &lt;- c(r = rMax, a=a, b=b, m=m)\ny0 &lt;- c(N=560, P=20)\ntimes &lt;- seq(0, 52, by=0.1)\n\nHere you use the deSolve package to integrate the rate equations over our time points.\n\nout &lt;- ode(y=y0, t=times, fun=predpreyLV, parms=parms)\n\nNext we rearrange the data, and graph the time series.\n\nop &lt;- out %&gt;% as.data.frame() %&gt;%\n  pivot_longer(cols=N:P, names_to = \"Populations\", \n                   values_to=\"Number\")\n\nggplot(op, aes(x=time, y=Number, colour=Populations)) + geom_line() +\n      labs(x=\"Years\") + scale_color_discrete(breaks=c(\"N\",\"P\")) + \n      facet_grid(Populations~., scales=\"free\")\n\nggsave(\"LV_MooseWolfTS.png\", height=5, width=6)\n\n\n\n\n\n\n\nFigure 11.4: Predicted Lotka-Volterra dynamics based on the Isle Royale moose-wolf data.\n\n\n\n\n\n\nOnce you do this, you should get something that looks like Fig. Figure 11.4, or about 3-6 cycles over 52 years, and the minimum and maximum population sizes should differ tremendously from the observed data. If you get something wackier than that, you’ve gone astray. If so, ask for help.\n\nWe can rearrange the data, and graph the phase plane plot (Fig. Figure 11.5).\n\noutw &lt;- out %&gt;% as.data.frame() \n\nggplot(outw, aes(N, P, linewidth= -time, color=time)) + \n  geom_path() + \n  labs(x=\"Moose population size\", y=\"Wolf population size\" )\nggsave(\"LV_MooseWolfPP.png\", height=5, width=6)\n\n\n\n\n\n\n\nFigure 11.5: Phase plane diagram of the Lotka-Volterra model of moose wolf dynamics. Once the paramters are fixed and the initial abundances are selected, then the dynamics are completely determined. Initial abundances are moose (560) and wolves (20). The line is black and widest in 1959, and becomes progressively more narrow and blue over time.\n\n\n\n\n\nOnce you are confident that you got something reasonably correct, assess the predicted dynamics.\n\nFor both the moose and the wolf populations and both the (i) original data and (ii) the Lotka-Volterra model, list the following:\n\n\nthe number of cycles,\nthe heights of the peaks and troughs, and\nthe averages.\n\nWrite a sentence or two describing these data in your list.\n\nIn a short paragraph, explain what you think we can learn from the match (or lack thereof) between the data and the model. Considering only what we have covered in this course, what would you use as an alternative to the Lotka-Volterra model, and how do those compare?",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#discussion-questions",
    "href": "11-predator-prey.html#discussion-questions",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.11 Discussion questions",
    "text": "11.11 Discussion questions\nHow could you test the effect of the parvovirus that began to affect the wolves in 1981?\nFor the next exam, be able to,\n\nExplain the meanings of the Lotka-Volterra model parameters.\nDerive the prey and predator isoclines.\nExplain neutral stability.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "11-predator-prey.html#sec-deliverables",
    "href": "11-predator-prey.html#sec-deliverables",
    "title": "11  Of wolves and moose, on Isle Royale",
    "section": "11.12 Deliverables",
    "text": "11.12 Deliverables\nTurn in two documents.\nThe first document is your R script.\nIn the second document, provide\n\nPhase plane diagram of raw data (x-axis, moose; y-axis, wolves),\nTime series graph of model output (x-axis, years; y-axes, moose and wolves)\nanswers to questions 11 and 12 above.\n\n\n\n\n\nVucetich, John A., and Rolf O. Peterson. 2009. “Recovery of Gray Wolves in the Great Lakes Region of the United States.” In, edited by A. P. Wydeven et al., 35–48. Springer.",
    "crumbs": [
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Of wolves and moose, on Isle Royale</span>"
    ]
  },
  {
    "objectID": "13-diversity.html",
    "href": "13-diversity.html",
    "title": "12  Determinants of local butterfly species diversity",
    "section": "",
    "text": "12.1 Goals\nIn this chapter, you will,",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Determinants of local butterfly species diversity</span>"
    ]
  },
  {
    "objectID": "13-diversity.html#goals",
    "href": "13-diversity.html#goals",
    "title": "12  Determinants of local butterfly species diversity",
    "section": "",
    "text": "Develop a multilevel hypothesis about what controls the number of butterfly species in a prairie remnant.\nDraw a picture of your hypothesis using a causal diagram.\nWrite an explain your hypothesis.\nTest each part of your hypothesis using linear regression.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Determinants of local butterfly species diversity</span>"
    ]
  },
  {
    "objectID": "13-diversity.html#preparatory-steps",
    "href": "13-diversity.html#preparatory-steps",
    "title": "12  Determinants of local butterfly species diversity",
    "section": "12.2 Preparatory steps",
    "text": "12.2 Preparatory steps\n\nGeneral background lectures: Download the PDF slides and watch the video on species diversity before proceeding.\nData: go to our class data repository, and download butterflies.csv.\n\nMake sure the file remains in the same simple format, “comma separated values” (.csv).\nPut butterflies.csv in your data directory, data which should be inside Rwork.\nContinue to make sure the file remains in the same simple format, “comma separated values” (.csv).\n\nFind out what you need for the deliverables.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Determinants of local butterfly species diversity</span>"
    ]
  },
  {
    "objectID": "13-diversity.html#background",
    "href": "13-diversity.html#background",
    "title": "12  Determinants of local butterfly species diversity",
    "section": "12.3 Background",
    "text": "12.3 Background\nHere we investigate determinants of local biodiversity. As you learned in the lecture, many ecological and evolutionary forces contribute to the diversity a local community. From a hierarchial perspective, we’ve seen that the number of species in a local community is influenced by,\n\nthe diversity of the region within which it resides,\nrates of dispersal immigration into the local habitat,\nthe environmental conditions of the local habitat, and\nspecies interactions within the local habitat.\n\nThe data we will explore comes from research by David Stasek, Caitlin Bean and Thomas Crist, a graduate student, an undergraduate, and faculty member of Miami University at the time (Stasek et al. 2008. Environ. Entomol. 37:897-906).",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Determinants of local butterfly species diversity</span>"
    ]
  },
  {
    "objectID": "13-diversity.html#causal-inference",
    "href": "13-diversity.html#causal-inference",
    "title": "12  Determinants of local butterfly species diversity",
    "section": "12.4 Causal inference",
    "text": "12.4 Causal inference\nCausal inference is the practice of estimating what happens to a response variable when another variable is changed. It is an academic discipline and area of research.\nAn important tool in causal inference is the causal graph, which is a box-and-arrow figure that illustrates putative causal relations. Most often a causal graph is a directed acyclic graph, or DAG.\nFor example, the following causal diagrams show factors that affect how much plants grow.\n\n\n\n\n\n\n\n\n\nFigure 12.2: The simplest causal graph or DAG, in which soil moisture affects plant growth.\n\n\n\n\n\n\n\n\n\n\n\nFigure 12.3: A more complicated causal graph (DAG), showing only an indirect effect of rain on growth, and two variables each having a direct effect on growth.\n\n\n\n\n\n\nNotice that rain is not predicted to have a direct effect on plant growth but does have an indirect effect via its effect on soil moisture.\nIn the next section, you will use causal graphs to illustrate relationships among factors controlling butterfly diversity.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Determinants of local butterfly species diversity</span>"
    ]
  },
  {
    "objectID": "13-diversity.html#working-with-data-and-ideas-from-stasek-and-colleagues",
    "href": "13-diversity.html#working-with-data-and-ideas-from-stasek-and-colleagues",
    "title": "12  Determinants of local butterfly species diversity",
    "section": "12.5 Working with data and ideas from Stasek and colleagues",
    "text": "12.5 Working with data and ideas from Stasek and colleagues\nDavid Stasek and colleagues collected a lot of data at the Edge of Appalachia Preserve. We will use a subset of their data to assess how butterfly species diversity within a priariew patch (local diversity) may depend directly or indirectly on the size of the patch, how close the patch is to other patches, and the density of flowering plants upon which the butterflies depend.\nSpecifically, the data set includes the following variables:\n\nID of remnant prairie cluster to which the patch belongs (cluster)\nID of the individual prairie patch (patch)\nsize of the prairie patch in hectares (ha, area)\nConnectivity of that patch to other patches (connect).\nDensity of potential nectar plants (#/100 sq m, flowers)\nDensity of potential host plants (#/100 sq m, hosts)\nand then the other 49 columns are butterfly species densities (#/100 sq m), where the column name is the first two letters of the genus plus the first two letters of the species.\n\nBelow, you will calculate for each prairie patch,\n\ntotal number of butterflies of all species observed,\nspecies richness observed, and\nSimpson’s diversity of the observed butterflies.\n\nHowever, before we do that, we have to create a working hypothesis.\n\n12.5.1 Connectivity\nAs you saw in lecture, dispersal and immigration from one patch into another can influence local diversity. Connectivity is a measure of how likely dispersal might be into a patch. The connectivity of a patch depends on the number, sizes, and distances away other patches patches are.\n\n\n\n\n\n\n\n\n\n(a) Connectivity of two different patches.\n\n\n\n\n\nFigure 12.4: Connectivity is estimated for each patch, and is the sum of area (\\(A\\)) times distance, \\(d\\) (weighted: \\(exp(-\\alpha d)\\)) of all other patches.\n\n\n\n\n\n12.5.2 Construct a DAG of your own\nWork alone or with a partner to come up with a hypothesis of what you think will control the species richness OR the species diversity (Simpson’s diversity) in prairie patches from the EoA.\n\nConsider everything you learned in lecture about how habitats, resources, and abundance all affect estimates of richness and diversity.\nDecide to predict either species richness OR Simpson’s diversity as your dependent variable.\nConsider the variables you have in this data set, and decide which 2-3 variables are most likely to directly or indirectly affect diversity.\nDraw by hand causal graph (DAG) that represents your hypothesis, and take a picture of it.\n\nThis DAG will be your working hypothesis\n\n\n12.5.3 Getting going in R\nWe always start the same way: open the relevant project, confirm the location of our working directory, and load packages we’ll need. After all that we’ll begin to read in data and assess our ideas.\nYour project should be Rwork, and your working directory should be called Rwork. You should also have a folder inside Rwork called data.\nLet’s see Hank’s working directory, which will differ from yours:\n\n## GET Hank's working directory\ngetwd()\n\n[1] \"/Users/stevenmh/projects/intro_to_ecology\"\n\n## that will differ from yours!\n\nMake sure that when you run getwd(), you get something that ends with /Rwork\nNow we load packages we’ll need:\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ lubridate 1.9.4     ✔ tibble    3.3.0\n✔ purrr     1.1.0     ✔ tidyr     1.3.1\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks ggdag::filter(), stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\n…and now we’re ready.\n\n\n12.5.4 Reading and and wrangling the data\n\nmake sure you put the data set (butterflies.csv) in your data folder that is inside your BIO209W folder.\n\nRead the data, and view the column names.\n\nbfly &lt;- read_csv(\"data/butterflies.csv\")\n\nRows: 26 Columns: 55\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): cluster, patch\ndbl (53): area, connect, flowers, hosts, EUMA, PAPO, PACR, PAGL, PATR, BAPH,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nnames(bfly)\n\n [1] \"cluster\" \"patch\"   \"area\"    \"connect\" \"flowers\" \"hosts\"   \"EUMA\"   \n [8] \"PAPO\"    \"PACR\"    \"PAGL\"    \"PATR\"    \"BAPH\"    \"COPH\"    \"COEU\"   \n[15] \"PHSE\"    \"EULI\"    \"PIRA\"    \"DAPL\"    \"ENAN\"    \"CYGE\"    \"MECY\"   \n[22] \"HESO\"    \"CEPE\"    \"ASCE\"    \"JUCO\"    \"LIAR\"    \"POIN\"    \"POCO\"   \n[29] \"PHTH\"    \"SPCY\"    \"SPAP\"    \"CHNY\"    \"SACA\"    \"CACE\"    \"STME\"   \n[36] \"EVCO\"    \"CELA\"    \"CABO\"    \"ANNU\"    \"POPE\"    \"POTH\"    \"POOR\"   \n[43] \"WAEG\"    \"POVE\"    \"ATCA\"    \"ATLO\"    \"POZA\"    \"EUVE\"    \"NAIL\"   \n[50] \"AMVI\"    \"EPCL\"    \"THPY\"    \"THBA\"    \"ERSP\"    \"ERHO\"   \n\n\n\n12.5.4.1 Calculate aggregate variables\nOur data set has the densities of each species, but we don’t have aggregate community-level variables. We would like simply the number of observed butterflies, regardless of their identities, that is, just the total butterfly density. We also need the number of species, or species richness. Last, we will calculate a measure of species diversity called Simpson’s diversity, an index that takes into account both the number of different species as well as their relative abundances.\n\n\n\n12.5.5 Writing our own functions\nBelow, we calculate total butterfly density, butterfly species richness, and Simpson’s diversity. To do that, we need to create our own little functions in R to calculate those things. (After you copy and paste these functions into your script, make sure you run them in this session so that R learns them in this session.)\nSpecies richness is just the number of species whose abundances are greater than zero. Here is a function that takes a vector of data (x) as input and returns the number of non-zero items.\n\nrichness &lt;- function(x) { sum( x &gt; 0 ) }\n\nSimpson’s diversity is probability that two individuals selected at random are different species. This is mathematically equivalent to the arithmetic complement (\\(1-x\\)) of the probability that two individuals selected at random are the same species (\\(\\sum_i^S p_i^2\\)), or \\[\\mathrm{Simpson's\\,\\,diversity} = 1 - \\sum_i^S p_i^2\\]\n\nsimpsons = function(x) {\n  # convert density into proportion\n  p &lt;- x / sum(x)\n  # calculate simpson's diversity\n  1 - sum( p^2 )\n}\n\nNow we use these functions to actually calculate the quantities we want with our data.\n\n# we start with our data,...\nbfly2 &lt;- bfly %&gt;%\n  # operate across each row, one row at a time, ...\n  rowwise() %&gt;%\n  # operating across only these columns, from EUMA to ERHO, and then\n  mutate(\n    total_N =  sum(c_across(EUMA:ERHO)),\n    richness = richness(c_across(EUMA:ERHO)),\n    simpsons = simpsons( c_across(EUMA:ERHO) )\n  ) %&gt;%\n  # keep the columns we want, i.e., \n  # get rid of all the columns of particular species ...\n  select ( cluster, patch, area, connect, flowers, hosts, total_N, richness, simpsons )\n\n## and glimpse the remaing data set\nglimpse(bfly2)\n\nRows: 26\nColumns: 9\nRowwise: \n$ cluster  &lt;chr&gt; \"BR\", \"BR\", \"BR\", \"BR\", \"HP\", \"HP\", \"HP\", \"CH\", \"CH\", \"CH\", \"…\n$ patch    &lt;chr&gt; \"p1BR\", \"p2BR\", \"p3BR\", \"p4BR\", \"p5HP\", \"p6HP\", \"p7HP\", \"p8CH…\n$ area     &lt;dbl&gt; 1.838, 0.087, 0.063, 0.331, 0.026, 0.035, 0.250, 0.666, 0.371…\n$ connect  &lt;dbl&gt; 1.487, 2.662, 2.446, 1.870, 1.772, 1.752, 1.238, 1.444, 1.595…\n$ flowers  &lt;dbl&gt; 218, 178, 160, 269, 42, 52, 249, 230, 143, 142, 140, 32, 34, …\n$ hosts    &lt;dbl&gt; 17, 13, 15, 18, 16, 15, 19, 19, 22, 19, 22, 17, 14, 29, 19, 1…\n$ total_N  &lt;dbl&gt; 73, 30, 27, 55, 30, 21, 64, 41, 66, 22, 52, 20, 28, 46, 84, 5…\n$ richness &lt;int&gt; 18, 15, 14, 18, 14, 10, 18, 18, 21, 14, 19, 9, 16, 17, 20, 12…\n$ simpsons &lt;dbl&gt; 0.8639520, 0.8955556, 0.8943759, 0.9104132, 0.8644444, 0.8027…\n\n\n\n\n12.5.6 Evaluate your hypotheses\nAbove you created your own DAG for your own working hypothesis. Now you will assess the weight of evidence in favor of each part of your hypothesis.\n\n12.5.6.1 Create a scatterplot of each relationship\nCreate a scatterplot of each relationship in your DAG. Make sure each axis is clearly labelled. Put the response on the y-axis, and the cause on the x-axis. Here is an example of a scatterplot in which we assume that height influences volume.\n\n# scatterplot\nggplot(data = trees, aes(x = Height, y = Volume) ) +\n         geom_point() +\n         labs(x = \"Height (ft)\",\n              y = \"Volume (cubic ft)\")\n\n\n\n\n\n\n\n# save my graph with whatever name I choose.\nggsave(\"my_scatterplot_trees.png\", width=5, height=5)\n\nTweak the above code to makes scatterplots of each relationship in your DAG.\n\n\n12.5.6.2 Measure the degree of association\nYou will use correlation to assess the degree of association between each variable. The correlation we will use is the Pearson product moment correlation, r, which varies from -1 to 1, indicating perfect negative correlation to perfect positive correlation. The Pearson correlation coefficient measure the degree of linear relationship between two variables.\nCorrelation does not guarantee that one variable causes a change in the other. We need other lines of evidence for that.\nThe key output of the correlation will be the confidence interval of the estimate r. A 95% confidence interval of r is the range of values of r that we would be expected to see if we re-ran the same data collection or experiment millions of times and examined the central 95% of those estimates.\nIn R, you do that using cor.test(). Here is an example using made-up variables, x and y.\n\ncor.test(x, y)\n\n\n    Pearson's product-moment correlation\n\ndata:  x and y\nt = 6.1227, df = 23, p-value = 3.026e-06\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.5691639 0.9018451\nsample estimates:\n      cor \n0.7872474 \n\n\nThe main result is that the 95% confidence interval of the correlation coefficient r is from 0.569 to 0.902, indicting a strong positive association between these variables.\nTo do this with variables in our data set, we will use the dollar sign, $, to tell R which variables from bfly2 to use. For instance, here is the correlation between connectivity and density of host plants.\n\ncor.test(bfly2$connect, bfly2$hosts)\n\n\n    Pearson's product-moment correlation\n\ndata:  bfly2$connect and bfly2$hosts\nt = 0.57468, df = 24, p-value = 0.5709\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.2836463  0.4821015\nsample estimates:\n      cor \n0.1165063 \n\n\nThis indicates that the 95% confidence interval lies from -0.28 to +0.48, suggesting that the relationship is highly uncertain and is almost as likely to be negative as it is to be positive.\nFor each relationship you hypothesized,\n\ncreate a scatterplot in which you label the axes and use ggsave() to save the figure,\nperform a correlation test, and\ninterpret the strength of association between the two variables.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Determinants of local butterfly species diversity</span>"
    ]
  },
  {
    "objectID": "13-diversity.html#deliverables",
    "href": "13-diversity.html#deliverables",
    "title": "12  Determinants of local butterfly species diversity",
    "section": "12.6 Deliverables",
    "text": "12.6 Deliverables\nTurn in two documents, your R script (with lots of comments!!), and one document that includes,\n\na written explanation of the ecology underlying your hypothesis,\nyour DAG (causal diagram) of your working hypothesis drawn by hand,\nfor each pairwise relationship,\n\none scatterplot,\nthe estimate and confidence interval for the correlation coefficient, r,\n\na written assessment of your entire working hypothesis that includes short interpretations of the confidence intervals of each relationship, and a short overall summary.",
    "crumbs": [
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Determinants of local butterfly species diversity</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html",
    "href": "20-ecosystem-intro.html",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "",
    "text": "13.1 Goals\nIn this chapter, you will, address three related questions:\nTo address these questions, we will\nOne of the main the points of doing these activities is to help to develop an intuition for system thinking. Systems are “a group of interacting, interdependent parts that form a complex whole” and ecosystem ecology is a central subdisicpline of ecology and the one that has contributed the most to our understanding of climate change and ecosystem services.\nThe other main point of these activities is to reinforce simple ideas related to the global carbon cycle and global warming.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#goals",
    "href": "20-ecosystem-intro.html#goals",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "",
    "text": "Why do we have so much carbon in the atmosphere?\nHow does including the physical process of diffusion of alter predictions about future atmospheric carbon?\nWhat is the connection between atmospheric CO\\(_2\\) and temperature, and how does that relationship affect our appreciation of Earth’s current and future status?\n\n\n\npractice building a simple ecosystem budget with steady fluxes and changing pools, 1 create a dynamic ecosystem in which the fluxes change, depending on the amount in pools, and 1 investigate how matter can relate dynamically to energy.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#preparatory-steps",
    "href": "20-ecosystem-intro.html#preparatory-steps",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "13.2 Preparatory steps",
    "text": "13.2 Preparatory steps\n\nGeneral background lectures: Download the slides and watch the video on at least the carbon cycle before proceeding.\nWe will not need data for this chapter.\nFind out what you need for the deliverables parts 1 (Section 13.7) and 2 (Section 13.10).\nGet R ready for work - see the next section.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#get-r-ready-for-work",
    "href": "20-ecosystem-intro.html#get-r-ready-for-work",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "13.3 Get R ready for work",
    "text": "13.3 Get R ready for work\nOpen R using RStudio, and set your working directory. You can do this in two ways:\n\nusing the Session menu in RStudio, or\nwith code such as this, in which you customize it to your computer:\n\nsetwd(\"C:/Users/chenjoe/BIO209W/Rwork\")\nYou can confirm or get your current working directory using this:\n\ngetwd()\n\n[1] \"/Users/stevenmh/projects/intro_to_ecology\"\n\n\nso when I do that, you can see my working directory is the one for this book.\nBefore you proceed, make sure your working directory is your Rwork directory.\nNext, use RStudio to create a new file of the type R script. Save it using a name that reflects this chapter, and end the file name with “.R” or “.r”.\nThird, add a comment as a brief description of the script, and load any R packages you know you will need.\n\n## This script is for chapter XX in Hank's Intro to Ecology primer.\n\n## We always use...\nlibrary(tidyverse)\n## or usually just ggplot2 and dplyr packages within the tidyverse.\n## In this chapter we also need\nlibrary(deSolve)\n# for solving or integrating differential equations",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#background-on-ecosystems",
    "href": "20-ecosystem-intro.html#background-on-ecosystems",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "13.4 Background on ecosystems",
    "text": "13.4 Background on ecosystems\nAn ecosystem is a biological community of interacting organisms and their physical environment. Ecosystem ecologists study an ecosystem by tracking a particular chemical element such as carbon (C) or nitrogen (N) through the environment. We conceive of the environment in terms of compartments that contain the element (a.k.a. pools, stocks) and movement between compartments (fluxes, inflows, outflows).\nExamples of ecosystem budgets:\n\nPhosphorus budget of a lake ecosystem. Phosphorus (P) flows in via a stream coming into the lake, and discharges in a stream leaving the lake.\nCarbon budget of Earth’s atmosphere.: Carbon enters as CO\\(_2\\) via biological respiration and fossil fuel combustion and exits via uptake in photosynthesis in land plants and aquatic algae, and also via diffusion into oceans.\nEnergy budget of mountain stream. Energy is captured from sunlight via photosynthesis in aquatic algae and falls in as dead leaves, and exits via molecules of CO\\(_2\\) respired by organisms and as organic molecules and particles flowing flowing downstream.\n\nThe ecosystem paradigm connects energy and matter to the evolution and ecology of life. Ecosystem scientists focus on the flow of energy or matter through all parts of the environment, especially as those flows are mediated by living organisms.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#a-simple-budget-provides-one-explanation-for-why-we-have-so-much-carbon-in-the-atmosphere",
    "href": "20-ecosystem-intro.html#a-simple-budget-provides-one-explanation-for-why-we-have-so-much-carbon-in-the-atmosphere",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "13.5 A simple budget provides one explanation for why we have so much carbon in the atmosphere",
    "text": "13.5 A simple budget provides one explanation for why we have so much carbon in the atmosphere\nWhy do we have so much carbon in the atmosphere? One answer to that question comes from simply tallying up the inputs and the outflows. In this sense, it is a lot like our household budget.\nEcosystem budgets are simple1, at least conceptually. An ecosystem budget is just like your household budget or bank account: if more money goes in than goes out, you accumulate money. In contrast, if you spend more money than you bring in, your wealth declines.\nAn ecosystem budget simply keeps track of the amount of a chemical element, such as nitrogen or carbon, that, is in a compartment, goes into a compartment, and leaves a compartment, over a specified time interval such as a year. The size of a pool or compartment is the amount of an element in that pool.\n\n13.5.1 Rate of change\nFor a simple ecosystem carbon budget, the rate of change of the size of a pool is the difference between the input and the output over a specified time interval,\n\\[\\Delta~\\mathrm{Pool} = \\mathrm{Inputs} - \\mathrm{Outputs}\\]\nFor instance, consider the carbon budget for Earth’s atmosphere from the 1990’s that we described in lecture. We had these inputs and outputs (units are petagrams, 10\\(^{15}\\) g):\n\nInputs to the atmosphere\n\ndiffusion from the ocean (respiration, 91 Pg/y)\nRiver outgassing (1 Pg/y)\nFire (4 Pg/y)\nCement production (0.1 Pg/y)\nFossil fuel (7.6 Pg/y)\nLand use change (1.5 Pg/y)\nTerrestrial respiration (mostly soil microbes 56 Pg/y)\n\nOutputs from the atmosphere\n\ndiffusion into the ocean (photosynthesis, and carbonic acid formation 92 Pg/y)\nWeathering (0.2 Pg/y)\nLand sink (2.8 Pg/y)\nNPP on land (60 Pg/y)\n\n\nAt the time, the atmosphere held 762 Pg C mostly in the forms of carbon dioxide, carbon monoxide, and methane (CO\\(_2\\), CO, CH\\(_4\\)).\nGiven this budget, how much carbon would be in the atmosphere,\n\none year later?\ntwo years later?\nfifty years later?\n\nTo figure this out with a simple budget, we simply start with the pool, add the inputs and subtract the outputs. \\[\\mathrm{Atmosphere_{t+1}} = \\mathrm{Atmosphere_{t}} + \\mathrm{inputs} -  \\mathrm{outputs}\\]\n\n# the pool\nAt &lt;- 762\n\n# fluxes\n# separate statements with semicolons\nor &lt;- 91; ro &lt;- 1; fi &lt;- 4; cp &lt;- 0.1; ff &lt;- 7.6; lu &lt;- 1.5; tr &lt;- 56\ninputs &lt;- or + ro + fi + cp + ff + lu + tr\n\nnpp.o &lt;- 92; we &lt;- 0.2; ls &lt;- 2.8; npp.l &lt;- 60\noutputs &lt;- npp.o + we + ls + npp.l\n\nnet.flux &lt;- inputs - outputs\nnet.flux\n\n[1] 6.2\n\nAtp1 &lt;- At + net.flux\nAtp1\n\n[1] 768.2\n\n\nWhat about two years later? What about 3 or 25 or 75 years later? If we choose to assume that these rates won’t change, the answer is easy, but only because we are working with a simple budget. We simply add the annual flux for each year, starting at year 0.\n\\[\\mathrm{Atmosphere_{t}} = \\mathrm{Atmosphere_{0}} + \\mathrm{net~flux} + \\mathrm{net~flux} + \\ldots + \\mathrm{net~flux}\\] That is equivalent to multiplying the annual flux by the number of years, \\(t\\). \\[\\mathrm{Atmosphere_{t}} = \\mathrm{Atmosphere_{0}} + \\mathrm{net~flux}\\cdot t\\]\nNow it is your turn to do that next for two years and for 25 years.\n\n## write code two years and for 25 years\n## \n\nNote that as long as these fluxes remain constant the system will continue to change at this rate. There is no equilibrium or balance of nature.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#simple-dynamics-emerge-from-processes-like-diffusion-and-complicate-prediction",
    "href": "20-ecosystem-intro.html#simple-dynamics-emerge-from-processes-like-diffusion-and-complicate-prediction",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "13.6 Simple dynamics emerge from processes like diffusion and complicate prediction",
    "text": "13.6 Simple dynamics emerge from processes like diffusion and complicate prediction\nHow does including the physical process of diffusion of alter predictions about future atmospheric carbon? A simple budget is a great starting place, but it ignores a lot of biological and physical reality. Here we add one piece of that reality: diffusion of CO\\(_2\\) between the air and water.\nIn the above example, carbon went into the atmosphere at a constant rate and left at a constant rate. What if a flux depends on the amount in the pool? It’s actually very common for a flux to depend on the amount in one or more pools. Here are some examples:\n\nThe flux of water leaving a bathtub depends on the height of water in the bathtub.\nThe flux of radiant heat from the body of a basking lizard depends on the temperature (or amount of heat energy) of the lizard.\nRate of diffusion of CO\\(2\\) into the oceans depends on the concentration in the atmosphere, due to a concentration gradient.\nRate of carbon capture by plants depends on the amount of vegetation (compare a potted plant in a parking lot to an intact forest).\n\n\n13.6.1 A first order flux\nA first order flux is one in which each term in the rate equation depends on no more than one pool.\nImagine we have bathtub that we are filling with water, and that the drain has a leak. Just like with our simple budget above, rate of change in the depth (or height) of the water is \\[\\Delta \\mathrm{height} = \\mathrm{inflow} -\\mathrm{outflow}.\\]\n\n\n\n\n\n\nFigure 13.2: Filling a bathtub with a leaky drain.\n\n\n\nComplication: while the inflow is fixed by the faucet, the outflow is determined by two things: how big the leak is, and how deep the water is or the height of the water in the tub. The deeper the water, the more pressure there is that pushes the water out faster. We can approximate that as \\[\\mathrm{Outflow} = e \\cdot \\mathrm{height}\\] where \\(e\\) is a constant that depends on the size of the leak. As the height decreases, the outflow rate will decrease. With this detail, the rate equation is now, \\[\\Delta \\mathrm{height} = \\mathrm{inflow} -e \\cdot \\mathrm{height}\\] and when the change in the height slows to zero (\\(\\Delta \\mathrm{height} = 0\\)), that means the depth will stop changing. That happens when, \\[\\mathrm{inflow}  = e \\cdot \\mathrm{height}.\\] We can solve for height to figure out what the height will be. Rearranging, we get,\n\\[\\mathrm{height} = \\frac{\\mathrm{inflow}}{e}.\\] We refer to this height as an equilibrium because it is predicted to not change.\nLet’s see this operate in an ecosystem.\n\n\n13.6.2 Earth’s atmosphere as a first order equation\nLet’s assume that at first approximation, the diffusion of CO\\(_2\\) from the atmosphere into the ocean is a first order process - that it is proportional to the amount of CO\\(_2\\) in the atmosphere. We can represent that in the differential rate equation \\[\\frac{dA}{dt} = I - eA\\] where \\(A\\) is the amount of CO\\(_2\\) in the atmosphere, \\(I\\) is a constant flux, and \\(e\\) is the diffusion rate into the ocean.\nNote that all of the uptake by the ocean is via diffusion, because it has to leave the air and move into the water in the process of diffusion. However, most of what moves into the water is captured via photosynthesis, by phytoplankton2, coral symbionts3, and kelp. The CO\\(_2\\) that is not captured this way increases in concentration and acidifies the ocean, as\n\\[\\mathrm{CO_2 + H_2O \\rightarrow H_2CO_3 \\rightleftharpoons HCO_3^- + H^+ }\\].\nIf we assume that in the ocean, photosynthesis is balanced by respiration, then we can pretend that the difference leads to ocean acidification. Using data presented above, that means that\n\nrespiration &lt;- 91 # Pg\nphotosynthesis &lt;- 91 # Pg\ncarbonic_acid &lt;- 1 #Pg\n\nWe will estimate the approximate value of \\(e\\) using the net carbon flux.\n\\[F_{oa} = \\mathrm{photosynthesis }\\]\nIf the net flux into the atmosphere were \\(I=6.2\\) Pg C/y, and the current diffusion rate out of the atmosphere is \\(e=0.008\\)/y4, what would happen? What is the predicted equilibrium and how fast would it get there?\nLet’s ask R to show us the dynamics. First, we make an R function with the rate equation.\n\n## simple first order equation.\n## start\natmosphere1 &lt;- function(t,y,p){\n  with( as.list(c(y, p)), {\n    \n    ## this is the bit to recognize\n    dA.dt &lt;- I - e*A\n    \n    return(list( c(dA.dt), \n                 ## convert gigatonnes C to CO2 equivalent mass \n                 CO2_global_mass = A * (12 + 2*16)/12,\n                 ## convert gigatonnes C to CO2 equivalent ppm\n                 CO2_ppm = A / 2.13\n    ) )\n  })\n}\n## end\n\nNext, we tell R what parameters to use, and the initial amount of carbon in the atmosphere at time zero.\n\n# Constant influx, and diffusion rate\np1 &lt;- c(I=6.2, e=0.008)\n# starting atmospheric carbon pool\ny0 &lt;- c(A=762);\n\nNext we tell R the time points we want it to show us. Let’s get annual estimates for 1000 years.\n\n# from zero to 100, by steps of one year\nt &lt;- seq(from=0, to=1000, by=1)\n# integrate the rate equation for all time points, \n# starting with y0 at time zero, using our function and parameters.\noutput &lt;- ode(y=y0, times=t, func=atmosphere1, parms=p1)\n\nNext we plot the dynamics of the atmospheric carbon. I have hidden the graphic in order to allow you to create it on your own.\n\n# Finally, we plot the output.\nout_df &lt;- as.data.frame(output) \nfirstorderA &lt;- ggplot(out_df, aes(time, A)) + geom_line() + \n  labs(y=\"Atmospheric carbon pool (Pg)\",\n       x=\"Year\") + \n  theme_bw()\nfirstorderA\n\n\n\n\n\n\n\nggsave(\"firstOrderAtmosphere.png\", width=5, height=4)\n\nNext, solve the rate equation directly by setting \\(\\frac{dA}{dt} = 0 = I - eA\\) and solving for \\(A^*\\), the equilibrium. \\[A^* = \\mathrm{?}\\]\nWhat does the above solution tell us should happen if \\(e\\) gets smaller? gets larger?",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#sec-deliverables1",
    "href": "20-ecosystem-intro.html#sec-deliverables1",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "13.7 Deliverables, part 1",
    "text": "13.7 Deliverables, part 1\nTwo documents:\nThe first document is your R script (just the R script - do not save it in any other format).\nThe second document should provide the following written responses and quantities you calculated in R:\n\nQuantities from the simple budget, including units:\n\nthe annual flux\nthe size of the pool in years 2 and 25.\n\nQuantities from the simple dynamic model, including units:\n\nthe graph of atmospheric carbon dynamics.\nsolution to the dynamic rate equation (i.e. what is \\(A^*\\) predicted to be at equilibrium?). Show your work.\n\nState what the above solution tells us should happen the \\(A^*\\) if \\(e\\) gets smaller and also if it gets larger.\nCompare and contrast the simple budget and the simple dynamic system above, in terms of how they represent a system, and in what they predict about future atmospheric carbon levels.\nExplain what the simple dynamic system would predict about the ocean acidification due to fossil fuel emissions?\nWarmer water holds lower concentrations of gases such as oxygen and carbon dioxide than does colder water. Explain how this might alter predictions about ocean acidification assuming the atmosphere and oceans continue to warm. If you know a little about chemistry, include anything you know about the effect of temperature on the dissociation of acids.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#linking-two-different-ecosystem-processes-shows-lagged-effects",
    "href": "20-ecosystem-intro.html#linking-two-different-ecosystem-processes-shows-lagged-effects",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "13.8 Linking two different ecosystem processes shows lagged effects",
    "text": "13.8 Linking two different ecosystem processes shows lagged effects\n\n\n\n\n\n\nFigure 13.3: Earth is approximately a black body absorbing and emitting radiant energy. Straight-ish and curved lines indicate high energy, shortwave radiation. Wiggly lines indicate lower energy infrared radiation emitted from the warmed surface of Earth. Greenhouse gases (not illustrated here), would slow the escape of infrared radiation, by absorbing and re-emitting it.\n\n\n\nIn this section we connect the carbon cycle to an entirely different set of fluxes, those of heat, or radiant energy.\nWhat is the connection between atmospheric CO\\(_2\\) and temperature, and how does that relationship affect our appreciation of Earth’s current and future status? Most of us don’t care much about the amount of CO\\(_2\\) in the atmosphere (per se), but we care a lot about how CO\\(_2\\) and other greenhouse gases trap and re-radiate heat. In this section, we quantify this connection.\nNearly all of the heating of Earth’s atmosphere occurs when warmed land or ocean surface emits infrared radiation that is then captured by greenhouse gases which then re-radiate this energy. This all starts when our sun radiates energy that travels through space (Fig. Figure 13.3) and eventually encounters Earth’s atmosphere. That incoming radiation is high energy short-wave radiation which penetrates and passes through the atmosphere, and hits Earth’s surface. Most of this energy is absorbed, and then re-emitted as long-wave infrared radiation which we can experience as heat. It is this infrared radiation that is trapped by greenhouse gases prior to eventually exiting, back out into space (not shown in Fig. Figure 13.3).\nGreenhouse gases re-radiate the heat they absorb. In doing so, they heat up Earth’s surface even more. Because of that, Earth’s surface never has a chance to really cool down, because it is always being re-warmed by the atmosphere that it made warm in the first place. The energy is bouncing back and forth between the atmosphere and the Earth’s surface (land and oceans). It also bounces back and forth between layers of the atmosphere. The energy will eventually find its way back into outer space, but not before it has bounced around a lot.\nThe flux of solar radiation (Fig. Figure 13.3) coming at Earth is about \\(\\Omega = 1372\\) W/m\\(^2\\)5. However, because Earth is round, that energy get spread out and each square meter would receive only about a fourth of that, or \\(\\Omega/4\\), if it all reached the surface. Thus, the effective incoming flux is \\(F_{in} = \\Omega/4\\).\nUnlike the incoming flux, the outgoing flux comprises two basic types of radiation (Fig. Figure 13.3). About 30% the incoming radiation is reflected back out into space, unchanged. It bounces off of clouds and snow and ice, and we refer to this reflectance as albedo. Thus, part of the outgoing flux is \\(F_{out1} = a\\cdot1372/4\\), where \\(a\\) is for albedo which is about 0.3.\nThe second part of the outgoing flux is the infrared radiation that first bounces around the atmosphere before it makes its way out into the universe (Fig. Figure 13.3). The rate rate which that happens is proportional to the Stefan-Boltzmann constant6, \\(\\sigma\\), which quantifies radiation emitted from a perfect black body in relation to it’s temperature. Needless to say, we won’t get into why it happens at that rate. What we will say is that the second part of the outgoing energy flux is \\(F_{out2} = \\sigma T^4\\), where \\(T\\) is temperature in degrees Kelvin, and sigma is the Stefan-Boltzmann constant, \\(\\sigma \\approx 5.67 \\times 10^{-8}\\). Or, at least it would be if we ignored greenhouse gases.\nAll together, we might approximate Earth’s energy flux as \\[\\Delta E_E = F_{in} - F_{out1} - F_{out2} = \\frac{\\Omega}{4} - a\\frac{\\Omega}{4} - \\sigma T^4\\] if we ignore the effect of greenhouse gases.\nIf we want to express temperature at equilibrium in terms of fluxes, we set \\(\\Delta E_E = 0\\) and solve for \\(T\\), \\[F_{in} = F_{out1} + F_{out2}\\] and using algebra to rearrange, and we get \\[T^4 = \\left(1-a\\right)\\frac{\\Omega}{4\\sigma}\\] or,\n\\[T = \\left[ \\left(1-a\\right)\\frac{\\Omega}{4\\sigma} \\right] ^{1/4}\\] where \\(T\\) is degrees Kelvin.\nIf we calculate the predicted temperature, what would we get? Here is code that can help you answer that.\n\nOmega &lt;- 1372\nsigma &lt;- 5.67e-8\nalbedo &lt;- 0.3\n\ntemp_K &lt;- ( (1-albedo) * Omega/(4*sigma) )^(1/4)\ntemp_K\n\n\n13.8.1 Adding greenhouse (heat-trapping) gases\nAs we mentioned, the above approximation ignores the effect of greenhouse gases. Thousands of scientists around the world are attempting to model Earth’s energy balance, including the dynamics and effects of greenhouse gases that trap outgoing radiation. That research is well beyond the scope of this class, but we will approximate the relationship.\nWe will approximate the effect of greenhouse gases by merely adjusting the Stefan-Boltzmann constant by an amount related to the amount of CO\\(_2\\) in the atmosphere, \\(A^g\\), where \\(A\\) is the CO\\(_2\\) concentration in parts per million (~420 ppm in 2023), and \\(g\\) is what I call Hank’s greenhouse constant. This gives us \\(F_{out2} = \\sigma A^g T^4\\).\nWe can now rewrite the predicted atmospheric temperature as\n\\[T = \\left[ \\left(1-a\\right)\\frac{\\Omega}{4}\\frac{A^g}{\\sigma} \\right] ^{1/4} + \\epsilon\\] where \\(\\epsilon\\) is statistical error or residual.\n\n13.8.1.1 Intuition about \\(T = F(A)\\)\nLet’s use the above equation to reinforce our understanding of how atmospheric temperature is a function7 of the amount of carbon compounds in the atmosphere (\\(T = F(A)\\)).\nFirst, we re-inject meaning into the equation:\n\n\\((1-a)\\): fraction of incoming radiation initially absorbed.\n\\(\\Omega/4\\): incoming radiation.\n\\(\\sigma\\): scales the relationship between radiant energy and temperature as well as the radiant loss of heat energy escaping the atmosphere into the universe.\n\\(A\\): CO\\(_2\\) concentration in the atmosphere.\n\\(g\\): scaling constant that quantifies the heat trapping relation between CO\\(_2\\) in parts per million (ppm) and temperature.\n\nRe-writing the equation, we have \\[ \\mathrm{temp = fraction \\times incoming~rad \\times} \\frac{\\mathrm{CO}_2~ \\mathrm{heat~trapping}}{\\mathrm{radiant~loss}}\\]\nHank’s greenhouse constant \\(g\\) is just a statistically-fitted constant to draw a smooth curve through known temperatures that researchers have shown would occur at CO\\(_2\\) concentrations of (0, 280, 450 ppm). These concentrations reflect zero, pre-industrial, and near future CO\\(_2\\) predictions. These concentrations have been shown to result in predicted temperatures 255, 288, and 290 deg K.\nNote that we can represent heat trapping gases in the atmosphere as “CO2-equivalents”, which represent all of the carbon based molecules that help trap heat, especially carbon dioxide (CO2) and methane (CH4). These relate directly to the total amount of carbon in the atmosphere. The total mass of carbon in gigatonnes is about 2.13 times the CO2 concentration in ppm (parts per million). The total mass of carbon dioxide (CO2) in gigatonnes is about 7.82 times the CO2 concentration in ppm (source ).\nHank’s greenhouse constant is related to the radiative forcing of greenhouse gases. Radiative forcing is the potential for a system to undergo energy change.\nUsing the fitted expectation of \\(g = 0.0849\\) gives us the following:\n\n## graphing the curve of temperature vs. CO2\ng &lt;- 0.08488\nOmega &lt;- 1372\nsigma &lt;- 5.67e-8\nalbedo &lt;- 0.3\n\n# function to describe the relationship\npredict.warming &lt;- \n  function(x, g, Omega, sigma, albedo){ \n    ((1-albedo)*Omega/(4*sigma)*x^g )^(1/4)\n    }\n\nbase &lt;- ggplot() + lims(x=c(0, 500), y=c(250,300))\nbase + \n  geom_function(fun = predict.warming, \n                     args = list(g = g, Omega, sigma, albedo),\n                n=5001) +\n  annotate(geom=\"point\", x=c(0, 280, 450), \n           y=c(250, 288, 290) ) +\n  labs(\n    x=\"Carbon dioxide (ppm)\", \n      y=\"Predicted temperatures\",\n  ) + \n  theme_bw()\n\n\n\n\n\n\n\nFigure 13.4: Temperatures predicted from first principles and using Hank’s greenhouse constant, \\(g\\), which adjusts for observed and predicted temperatures, based on actual CO2 and temperature data and extremely complex and well-tested models used in IPCC reports.\n\n\n\n\n\n\n\n\n13.8.2 Why is all this math important?\nAll this math is important for several reasons.\nFirst, we want to estimate both the expected temperatures now, and also what the temperature would become even if we stop emitting any greenhouse gases today.\nSecond, we all need practice understanding quantitative approximations. Also known as “back of the envelope calculations”, these rough estimates give us approximate information about our world so that we can make timely decisions. We cannot wait for answers with ten sig-figs of precision. Here are some important questions to which there is no single answer, but for which approximations can help:\n\nWhat is my relative risk of dying if I drive 500 miles to my wife’s house vs. if I flew?\nWhat is the probability that this stranger I am with will give me a disease?\nIf I add $25 dollars to my IRA every month, what would that be worth in 20 years?\nIf the planet warms by 2 deg C, how big of a change is that, relative to its usual temperature?\nIf I get a positive HIV test result, what is the probability that I am actually infected with HIV?\n\nWe live better lives when we are comfortable with good quantitative approximations.\nThird, and finally, it’s just nerdy-fun to realize that this is really how the planet works!\n\n\n13.8.3 Expected temperatures now, and also what the temperature would become\nOne important reason that we are creating rate equations is because what we observe now is not what we will get in the future. Solving rate equations over time shows us change through time, not just the end result.\nBecause the amount of atmospheric CO\\(_2\\) is constantly increasing, the temperature has never caught up to what it would become if CO\\(_2\\) weren’t steadily increasing.\nHere is an analogy. You put a pot of cold water on the stove. You turn the burner to “high” and the gas ignites or the coils start to glow red. The burner is emitting heat, but the water is not yet boiling. In this analogy, the water is the atmosphere and the burner is the increasing greenhouse gases. The temperature difference between the burner and the water is the radiative forcing. On Earth, the greenhouse gases are accumulating and trapping lots of heat energy, but Earth has not yet warmed up as much as it would given the current levels of greenhouse gases.\nSo, now we know there is a lag or delay between greenhouse gas concentrations and atmsopheric temperatures. What we DON’T know is how big is this lag between CO\\(_2\\) concentration and temperature actually is. Is the lag only a day, or year, or is it longer, like a decade or a century? Quantifying the importance of the lag is the kind of thing that only a quantitative model can tell us.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#simulations-in-silico-experiments",
    "href": "20-ecosystem-intro.html#simulations-in-silico-experiments",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "13.9 Simulations: in silico experiments",
    "text": "13.9 Simulations: in silico experiments\nIn order to explore these connections between greenhouse gases and global temperatures, and the lag between them, we will do several simulations to examine the consequences of our assumptions. In each case, we will track atmospheric carbon concentration and temperature to 2100. This interval of less than 80 years is likely to be about the life span of you, or your children if you have any, or your young nieces and nephews.\n\nBusiness as usual anthropogenic carbon emissions.\nKeep atmospheric CO2 at the 2023 level by reducing anthropogenic inputs to \\(I=0.5\\).\nReduce anthropogenic carbon emissions to 1980 levels (338 ppm) by reducing anthropogenic inputs to \\(I=0.357\\).\n\nFor each simulation, you will run the simulation, make a graph of its outputs, and extract certain data from the output data sets, specifically,\n\natmospheric CO2 concentration at the start and end of your simulation.\nmodeled “observed” or contemporaneous temperature (deg C) at the start and end of your simulation.\nequilibrium temperature (deg C) at the start and end of your simulation.\ncalculated difference between the contemporaneous and equilibrium temperatures at the start and end of your simulation.\n\nRemember that the equilibrium temperature is the temperature to which the atmosphere will eventually rise if kept at a particular CO2 concentration. In contrast the modeled “observed” or contemporaneous temperature is the temperature that we are predicted to experience at any moment in time, given the changing CO2 concentrations and background uptake rates.\n\nTo do these simulations, we need a set of rate equations that incorporate everything we have covered above. Here they are, in one R function. Copy and paste this into your R script, and run it so that R creates this function in its working memory.\n\nEarth1 &lt;- function(t,y,p){\n  with( as.list(c(y, p)), {\n    ## hypothesized relation of carbon inputs and outputs for \n    ## the atmosphere\n    ## constant input I, diffusion loss out eA\n    ## CO2 rate equation, units CO2 / year\n    dA.dt &lt;- I + (1-A/280)\n    \n    ## incoming radiant energy\n    F.in &lt;- Omega/4 \n    ## outgoing radiant energy\n    F.out &lt;- a*Omega/4 + (sigma/A^g)*K^4\n    ## heat energy rate equation\n    dK.dt &lt;- (F.in - F.out)/lag\n    \n    ## What the temperature WOULD be, \n    ## without a lag \n    Equilibrium_K = ( (1-a) * Omega / (4*(sigma)) * A^g )^(1/4)\n    \n    ### Have R return these results to us\n    return(list( c(dA.dt, dK.dt) , \n                 K_eq = Equilibrium_K\n    ) )\n  })\n}\n\nFor all our simulations, we’ll simulate the years from 2023 to 2100. We will consider 2023 to be time zero (\\(t=0\\)), and project every week until 2100 (\\(t=77\\)).\n\nt &lt;- seq(0, 77, 1/52)\n\nNext, we specify initial state of the system, including carbon concentration and temperature.\n\ny0 &lt;- c(A=420, # CO2 equivalents in ppm in 2023\n        K=289 # degrees Kelvin in 2023\n        )\n\nFinally, and as always, make sure that you have loaded functions we will need, as you did for the beginning of this chapter.\n\nlibrary(tidyverse) # data wrangling and graphics\nlibrary(deSolve) # for numerical integration of ODE models\n\n\n13.9.1 Experiment 1: Business as usual\nHere we simulate some of the situations we discussed above. First, let’s assume business as usual, that our net greenhouse emissions continue as they have been. Those emissions result in a net increase of about 2.1 ppm (\\(I=2.1\\)). We specify particular constants or parameters for our equations. We create a vector of those here.\n\nparameters1 &lt;- c(Omega = 1372, # incoming solar radiative forcing\n       a=0.3, # albedo\n       sigma = 5.67e-8, # Stefan-Boltzmann constant for radiative loss\n       g = 0.08488, # greenhouse constant\n       I = 2.1, # increase in CO2 ppm per year\n       lag = 50 # lag time to partial temp equilibration\n)\n\nNext we project the dynamics of atmospheric carbon and temperature, starting at a particular concentration and temperature (y0), for particular times in the future (t), using our system of equations (Earth), and particular values of each parameter (parameters1, including I=2.1).\n\noutput1 &lt;- ode(y=y0, \n               times=t, \n               func=Earth1, \n               parms=parameters1)\nhead(output1)\n\n           time        A        K     K_eq\n[1,] 0.00000000 420.0000 289.0000 289.9797\n[2,] 0.01923077 420.0308 289.0012 289.9802\n[3,] 0.03846154 420.0615 289.0025 289.9806\n[4,] 0.05769231 420.0923 289.0037 289.9811\n[5,] 0.07692308 420.1231 289.0050 289.9815\n[6,] 0.09615385 420.1538 289.0062 289.9820\n\n\nThe first six lines of data show us daily predicted changes in atmospheric carbon (A), temperature (K), and what the temperature would be at equilibrium *if the temperature could catch up to the increasing CO2 concentrations (K_eq).\nWhat is the equilibrium temperature for 2023, and how much higher is it compared to the current temperature?\nHere are the last six lines of the data set, leading up to the year 2100.\n\ntail(output1)\n\n            time        A        K     K_eq\n[4000,] 76.90385 527.5948 291.1446 291.3865\n[4001,] 76.92308 527.6182 291.1449 291.3868\n[4002,] 76.94231 527.6416 291.1452 291.3871\n[4003,] 76.96154 527.6649 291.1455 291.3874\n[4004,] 76.98077 527.6883 291.1459 291.3876\n[4005,] 77.00000 527.7117 291.1462 291.3879\n\n\nBased on these data, what is the equilibrium temperature for 2100, and how much higher is it compared to theobserved temperature predicted for 2100?\nUse this code to make a graph of this output.\n\np1.1 &lt;- output1 %&gt;% as.data.frame() %&gt;%\n  mutate(\n    Year = time + 2023\n  ) %&gt;%\n  ggplot(aes(x=Year, y=A)) + \n  geom_line() + labs(y=\"Atmospheric CO2 (ppm)\") +\n  theme_bw()\np1.1\n\n\n\n\n\n\n\nggsave(\"Exp1_CO2.png\", plot=p1.1)\n\nSaving 7 x 5 in image\n\n\nNow make a graph of temperatures.\n\nout.long1 &lt;- output1 %&gt;% as.data.frame() %&gt;%\n  select(time, K, K_eq) %&gt;%\n  transmute(\n    Year = time + 2023,\n    degC = K -273,\n    degC_eq = K_eq -273\n  ) %&gt;%\n  pivot_longer(cols=-Year, names_to = \"State_variable\", \n               values_to=\"Value\")\n\np2.1 &lt;- ggplot(out.long1, aes(x=Year, y=Value, color=State_variable)) + \n  geom_line() + \n  labs(y=\"Degrees Celcius\")  +\n  theme_bw()\np2.1\n\n\n\n\n\n\n\nggsave(\"Exp1_temps.png\", plot=p2.1)\n\nSaving 7 x 5 in image\n\n\nIf you want to put two graphs together, I recommend you install the patchwork package, and then load it.\n\n# eval: false\n# uncomment and run\n# install.package(\"patchwork\", dep=TRUE)\n\n# after installation, load it:\nlibrary(patchwork)\n\n# use it.\n# try\np2.1 / p1.1\n\n\n\n\n\n\n\n# or \np1.1 + p2.1\n\n\n\n\n\n\n\nggsave(\"Exp1_CO2andK.png\", height=4, width=8)\n\n\n\n13.9.2 Experiment 2: Keep CO2 at 2023 levels (420 ppm)\nHere we make one change: \\(I=0.5\\) in the parameters so that we keep CO2 at 420 ppm.\n\nparameters2 &lt;- c(Omega = 1372, # incoming solar radiative forcing\n       a=0.3, # albedo\n       sigma = 5.67e-8, # Stefan-Boltzmann constant for radiative loss\n       g = 0.08492, # greenhouse constant\n       I = 0.5, # increase in CO2 ppm per year\n       lag = 50 # lag time to partial temp equilibration\n)\n\nRerun the model, keeping everything else the same.\n\noutput2 &lt;- ode(y=y0, times=t, func=Earth1, parms=parameters2)\ntail(output2)\n\n            time   A        K     K_eq\n[4000,] 76.90385 420 289.9911 289.9972\n[4001,] 76.92308 420 289.9911 289.9972\n[4002,] 76.94231 420 289.9911 289.9972\n[4003,] 76.96154 420 289.9911 289.9972\n[4004,] 76.98077 420 289.9911 289.9972\n[4005,] 77.00000 420 289.9911 289.9972\n\n\nUse this code to make a graph of this output.\n\np1.2 &lt;- output2 %&gt;% as.data.frame() %&gt;%\n  mutate(\n    Year = time + 2023\n  ) %&gt;%\n  ggplot(aes(x=Year, y=A)) + \n  geom_line() + labs(y=\"Atmospheric CO2 (ppm)\") +\n  theme_bw()\np1.2\nggsave(\"Exp2_CO2.png\", plot=p1.2)\n\nNow make a graph of temperatures.\n\nout.long2 &lt;- output2 %&gt;% as.data.frame() %&gt;%\n  select(time, K, K_eq) %&gt;%\n  transmute(\n    Year = time + 2023,\n    degC = K -273,\n    degC_eq = K_eq -273\n  ) %&gt;%\n  pivot_longer(cols=-Year, names_to = \"State_variable\", \n               values_to=\"Value\")\n\np2.2 &lt;- ggplot(out.long2, aes(x=Year, y=Value, color=State_variable)) + \n  geom_line() + \n  labs(y=\"Degrees Celcius\")  +\n  theme_bw()\np2.2\nggsave(\"Exp2_temps.png\")\n\n\n\n13.9.3 Experiment 3: Reduce CO2 to 1980 levels (338 ppm)\nHere we make one change: \\(I=0.357\\) in the parameters so that we begin to drive atmospheric CO2 concentration down toward 1980 levels (338 ppm).\n\nparameters3 &lt;- c(Omega = 1372, # incoming solar radiative forcing\n       a=0.3, # albedo\n       sigma = 5.67e-8, # Stefan-Boltzmann constant for radiative loss\n       g = 0.08492, # greenhouse constant\n       I = 0.357, # increase in CO2 ppm per year\n       lag = 50 # lag time to partial temp equilibration\n)\n\nRerun the model, keeping everything else the same.\n\noutput3 &lt;- ode(y=y0, times=t, func=Earth1, parms=parameters3)\ntail(output3)\n\n            time        A        K     K_eq\n[4000,] 76.90385 410.3837 289.8742 289.8547\n[4001,] 76.92308 410.3816 289.8742 289.8546\n[4002,] 76.94231 410.3795 289.8742 289.8546\n[4003,] 76.96154 410.3774 289.8741 289.8546\n[4004,] 76.98077 410.3754 289.8741 289.8545\n[4005,] 77.00000 410.3733 289.8741 289.8545\n\n\nUse this code to make a graph of this output.\n\np1.3 &lt;- output3 %&gt;% as.data.frame() %&gt;%\n  mutate(\n    Year = time + 2023\n  ) %&gt;%\n  ggplot(aes(x=Year, y=A)) + \n  geom_line() + labs(y=\"Atmospheric CO2 (ppm)\") +\n  theme_bw()\np1.3\nggsave(\"Exp3_CO2.png\", plot=p1.3)\n\nNow make a graph of temperatures.\n\nout.long3 &lt;- output3 %&gt;% as.data.frame() %&gt;%\n  select(time, K, K_eq) %&gt;%\n  transmute(\n    Year = time + 2023,\n    degC = K -273,\n    degC_eq = K_eq -273\n  ) %&gt;%\n  pivot_longer(cols=-Year, names_to = \"State_variable\", \n               values_to=\"Value\")\n\np2.3 &lt;- ggplot(out.long3, aes(x=Year, y=Value, color=State_variable)) + \n  geom_line() + \n  labs(y=\"Degrees Celcius\")  +\n  theme_bw()\np2.3\nggsave(\"Exp3_temps.png\", plot=p2.3)",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#sec-deliverables2",
    "href": "20-ecosystem-intro.html#sec-deliverables2",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "13.10 Deliverables, part 2",
    "text": "13.10 Deliverables, part 2\nInclude two documents; the first is your R script.\nIn the second document, provide results for each experiment (1-3). For each experiment include a graph of CO2 concentration and a graph of observed and equilibrium temperatures, as well as these data:\n\n\\(A\\), atmospheric CO2 concentration at the start and end of your simulation.\n\\(K\\), modeled “observed” or contemporaneous temperature (deg C) at the start and end of your simulation.\n\\(K_eq\\), equilibrium temperature (deg C) at the start and end of your simulation.\n\\(K_eq-K\\), calculated difference between the contemporaneous and equilibrium temperatures at the start and end of your simulation.\n\nAt the end, use your data and figures to tell the story of how our activities alter the planet. Be sure to mention how we have not yet experience the consequences of greenhouse gases that we have already produced.\nIn sum, your one document should include results of three experiments and then a short narrative or story explaining what your simulations show.",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "20-ecosystem-intro.html#footnotes",
    "href": "20-ecosystem-intro.html#footnotes",
    "title": "13  An Introduction to the Carbon Cycle and Global Heating",
    "section": "",
    "text": "A zeroth order flux is one in which the rate depends on the amounts in zero pools - it doesn’t depend on pools.↩︎\nfloating single-celled algae↩︎\ndinoflagellates Symbiodinium↩︎\nUnits for e are Pg C lost per Pg C in the atmosphere per y; the Pg/Pg cancels out, leaves “per year” or 1/y.↩︎\na watt is a energy per second, technically one Joule per second, J/s↩︎\nThis constant derives from Plank’s constant, the speed of light in a vacuum, Boltzmann’s constant relating temperature to kinetic energy, and of course, \\(\\pi\\), the ratio of the diameter of a circle to its circumference. Well, of course it does….↩︎\nWe can represent any function with ‘F()’, so “some function of X” could be written as F(X).↩︎",
    "crumbs": [
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>An Introduction to the Carbon Cycle and Global Heating</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Caswell, H. 2001. Matrix Population Models:\nConstruction, Analysis, and Interpretation. Second.\nSinauer Associates, Inc., Sunderland, MA, USA.\n\n\nChamaillé-Jammes, Simon, Hervé Fritz, Marion Valeix, Felix Murindagomo,\nand Jean Clobert. 2008. “Resource\nVariability, Aggregation and Direct Density Dependence in an Open\nContext: The Local Regulation of an African\nElephant Population.” Journal of Animal Ecology 77\n(1): 135–44.\n\n\nCrouse, D T, L B Crowder, and H Caswell. 1987. “A Stage-Based\nPopulation Model for Loggerhead Sea Turtles and Implications for\nConservation.” Ecology 68: 1412–23.\n\n\nFehling, Laura Sharon. 2022. “Reward Complementarity\nand Context Dependency in Multispecies Mutualist\nInteractions in Partridge Pea\n(Chamaecrista Fasciculata).” PhD thesis, Miami\nUniversity.\n\n\nFranklin, Deborah. 2012. “Nature That Nutures.”\nScientific American 306 (3): 24–25.\n\n\nHastings, A. 2011. “Single Species Population Dynamics and Its\nTheoretical Underpinnings.” In, edited by S. M. Scheiner and M.\nR. Willig. Chicago, IL, USA: University of Chicago\nPress.\n\n\nKappeler, Peter M. 2019. “A Framework for Studying Social\nComplexity.” Behavioral Ecology and Sociobiology 73 (1):\n13. https://doi.org/10.1007/s00265-018-2601-8.\n\n\nLee, Ronald. 2011. “The Outlook for Population\nGrowth.” Science 333 (6042): 569–73. https://doi.org/10.1126/science.1208859.\n\n\nLivdahl, Todd P., and Michelle S. Willey. 1991. “Prospects for an\nInvasion: Competition Between\nAedes Albopictus and\nNative Aedes\nTriseriatus.” Science 253 (5016):\n189–91. https://doi.org/10.1126/science.1853204.\n\n\nMcElreath, Richard. 2020. Statistical Rethinking:\nA Bayesian Course with Examples in\nR and Stan. Second Edition. Texts in\nStatistical Science. Boca Raton, FL: CRC\nPress.\n\n\nMorin, P J. 1999. Community Ecology. Malden,\nMA: Blackwell Science, Inc.\n\n\nNordell, Shawn E., and Thomas J. Valone. 2014. Animal\nBehavior: Concepts, Methods, and\nApplications. New York: Oxford\nUniversity Press.\n\n\nNowak, Martin A, Corina E Tarnita, and Edward O Wilson. 2010. “The\nEvolution of Eusociality.” Nature 466 (7310): 1057–62.\n\n\nOdling-Smee, J, and DH Erwin. 2013. “Niche Construction Theory:\nA Practical Guide for Ecologists.” The Quarterly\nReview of Biology 88 (1): 3–28. https://www.jstor.org/stable/10.1086/669266.\n\n\nSchnitzer, S A. 2005. “A Mechanistic Explanation for Global\nPatterns of Liana Abundance and Distribution.” American\nNaturalist 166 (2): 262–76.\n\n\nSmith-Martin, Chris M., Carolina L. Bastos, Omar R. Lopez, Jennifer S.\nPowers, and Stefan A. Schnitzer. 2019. “Effects of Dry-Season\nIrrigation on Leaf Physiology and Biomass Allocation in Tropical Lianas\nand Trees.” Ecology 100.\n\n\nSolomon, Nancy G., and Brian Keane. 2018. “Dispatches from the\nField: Sociality and Reproductive Success in Prairie Voles.”\nAnimal Behaviour 143 (September): 193–203. https://doi.org/10.1016/j.anbehav.2018.07.001.\n\n\nStephens, D W, and J R Krebs. 1986. Foraging\nTheory. Edited by J. R. Krebs and T. H. Clutton-Brock.\nMonographs in Behavior and Ecology. Princeton, University Press,\nPrinceton, NJ, USA: Princeton University Press.\n\n\nVucetich, John A., and Rolf O. Peterson. 2009. “Recovery of Gray\nWolves in the Great Lakes Region of the United States.” In,\nedited by A. P. Wydeven et al., 35–48. Springer.\n\n\nWickham, Hadley. 2016. Ggplot2: Elegant Graphics for\nData Analysis. New York, NY:\nSpringer-Verlag.\n\n\nWilkinson, Leland. 2005. The Grammar of\nGraphics. Second. Statistics and Computing. New\nYork, NY: Spinger.\n\n\nWilson, Edward O. 1984. Biophiia. Cambridge, MA:\n: Harvard University Press.",
    "crumbs": [
      "References"
    ]
  }
]