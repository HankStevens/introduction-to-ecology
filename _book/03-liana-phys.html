<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Basic Ecological Concepts and Data in R - 4&nbsp; Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-extrapair_copulation.html" rel="next">
<link href="./02-global_temp_anomalies.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Basic Ecological Concepts and Data in R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-computer-setup.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Computer setup and first R script</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-trees_and_people.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Environmental Justice: How income relates to environment.</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-global_temp_anomalies.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Physical Environment: A Fate of Earth</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-liana-phys.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-extrapair_copulation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Behavior: Extra-pair copulation in a monogamous species</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-DI-pop-growth.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Density-independent Population Growth: Humans on the rise</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-structured-pop-growth_v2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Structured demography: How a graduate student helped save the loggerhead sea turtle</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-density-dep-pop-growth.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Density-dependence in population growth</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-direct-interactions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Direct species interactions: understanding mechanisms of invasion in mosquitoes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-mutualisms.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mutualisms: Do ants protect pea plants?</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-predator-prey.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Of wolves and moose, on Isle Royale</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20-ecosystem-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">An Introduction to the Carbon Cycle and Global Heating</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#goals" id="toc-goals" class="nav-link active" data-scroll-target="#goals"><span class="toc-section-number">4.1</span>  Goals</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background"><span class="toc-section-number">4.2</span>  Background</a>
  <ul class="collapse">
  <li><a href="#predictions" id="toc-predictions" class="nav-link" data-scroll-target="#predictions"><span class="toc-section-number">4.2.1</span>  Predictions</a></li>
  </ul></li>
  <li><a href="#predictions-1" id="toc-predictions-1" class="nav-link" data-scroll-target="#predictions-1"><span class="toc-section-number">4.3</span>  Predictions</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods"><span class="toc-section-number">4.4</span>  Methods</a>
  <ul class="collapse">
  <li><a href="#getting-organized" id="toc-getting-organized" class="nav-link" data-scroll-target="#getting-organized"><span class="toc-section-number">4.4.1</span>  Getting organized</a></li>
  <li><a href="#import-the-data" id="toc-import-the-data" class="nav-link" data-scroll-target="#import-the-data"><span class="toc-section-number">4.4.2</span>  Import the data</a></li>
  </ul></li>
  <li><a href="#graphics" id="toc-graphics" class="nav-link" data-scroll-target="#graphics"><span class="toc-section-number">4.5</span>  Graphics</a>
  <ul class="collapse">
  <li><a href="#anatomy-of-ggplot" id="toc-anatomy-of-ggplot" class="nav-link" data-scroll-target="#anatomy-of-ggplot"><span class="toc-section-number">4.5.1</span>  Anatomy of <code>ggplot()</code></a></li>
  <li><a href="#examples-of-ggplot" id="toc-examples-of-ggplot" class="nav-link" data-scroll-target="#examples-of-ggplot"><span class="toc-section-number">4.5.2</span>  Examples of <code>ggplot()</code></a></li>
  </ul></li>
  <li><a href="#deliverables" id="toc-deliverables" class="nav-link" data-scroll-target="#deliverables"><span class="toc-section-number">4.6</span>  Deliverables</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Individual responses to the environment: What makes lianas relatively successful in stressful habitats?</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/lianas.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Lianas are woody tropical vines, and can be really common in some tropical forests.</figcaption><p></p>
</figure>
</div>
<section id="goals" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="goals"><span class="header-section-number">4.1</span> Goals</h2>
<p>In this assignment, you will</p>
<ul>
<li>Investigate reasons for the unreasonable success of lianas.</li>
<li>Develop and use your understanding of plant growth and responses to water deficits to help make predictions about the relative success of lianas and trees.</li>
<li>Evaluate scientific hypotheses and predictions by (i) enhancing your data visualization skills using <code>ggplot()</code>, and (ii) making graphs of your own design.</li>
</ul>
</section>
<section id="background" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="background"><span class="header-section-number">4.2</span> Background</h2>
<ul>
<li>Watch videos on responses by organisms to temperature and water <a href="https://drive.google.com/drive/folders/1nWLoEGuWKIWdul9Uvse5qiB1Hf8MCwUv?usp=sharing" target="_blank">(videos 1e and 1f)</a></li>
<li>Download Smith-Martin et al.&nbsp;(2019), which is available in <a href="https://drive.google.com/drive/folders/1opLlrmF7kfo0FtWwwJ1CbfPWIyuaISC1?usp=share_link" target="_blank">our PDF archive</a>. Read the introduction to help you understand the context of this chapter.</li>
</ul>
<p>The term “liana” refers to tropical woody vines, which can be very common and can account for as much as 25% of the woody plant biodiversity in some tropical forests. They achieve some of their highest abundance in seasonal subtropical forests <a href="#fig-lianas">Figure&nbsp;<span>4.1</span></a>. These are regions with distinct wet and dry seasons; why are lianas successful in these seasonal subtropical forests?</p>
<div id="fig-lianas" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-fig1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/schnitzer1.png" class="img-fluid figure-img" data-ref-parent="fig-lianas"></p>
<p></p><figcaption class="figure-caption">(a) Lianas across a gradient</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-figs-2-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/schnitzer2.png" class="img-fluid figure-img" data-ref-parent="fig-lianas"></p>
<p></p><figcaption class="figure-caption">(b) Lianas vs.&nbsp;trees</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.1: Lianas increase in abundance and grow better than trees in the the dry season in seasonal subtropical forests. Figures 1-3 from Schnitzer (2005).</figcaption><p></p>
</figure>
</div>
<p>One possible explanation for lianas’ success in sesonal forests might have to do with their physiology and architecture <span class="citation" data-cites="schnitzer2005">(<a href="references.html#ref-schnitzer2005" role="doc-biblioref">Schnitzer 2005</a>)</span>. Lianas may possess an unusual ability to regulate their water potential <span class="citation" data-cites="smithmartin:2019aa">(<a href="references.html#ref-smithmartin:2019aa" role="doc-biblioref">Smith-Martin et al. 2019</a>)</span>. In order for plants to grow and reproduce, they undergo photosynthesis, and maintaining a less negative water potential may help lianas perform better than trees in seasonal environments. (See video lectures on soils, plant photosynthesis, water potential, and heat regulation). This ability may come from the depth at which their roots grow and forage for water, their very large vessels (xylem) that carry water up through the stems, or it could be something else.</p>
<p>Christine Smith-Martin and her colleagues (2019, <a href="#fig-sm1">Figure&nbsp;<span>4.2</span></a>) <strong>hypothesized that lianas can photosynthesize and grow better than trees during the dry season because lianas can maintain a less negative water potential than trees</strong>. To test their ideas, they set up a common garden experiment with, six liana and six tree species in replicate plots, in region of Panama with highly seasonal precipitation (<a href="#fig-sm1">Figure&nbsp;<span>4.2</span></a>). They watered half of the plots, and measured a wide variety of variables including photosynthetic rate, pre-dawn and midday leaf water potential, water use efficiency, many other variables about lianas and trees.</p>
<div id="fig-sm1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="figs/smithmartin1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.2: Geographic location of study sites in Smith-Martin et al.&nbsp;(2019). Inset, Chris Smith-Martin, seen here in a tree crane. There is a strong seasonality gradient from the Atlantic to Pacific coasts of Panama.</figcaption><p></p>
</figure>
</div>
<p>You will evaluate the hypothesis proposed by Smith-Martin and her colleagues using their publicly available data. These data are also available in the data repository for this book.</p>
<section id="predictions" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="predictions"><span class="header-section-number">4.2.1</span> Predictions</h3>
<p>A <strong>hypothesis</strong> is an educated guess about a <strong>mechanism</strong>. The mechanism should be relatively general and could apply to a variety of species or ecosystems. In contrast, a <em>prediction</em> is a specific <strong>measurable result</strong> that will occur in your system <em>if the hypothesis is correct</em>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>If the hypothesis of Smith-Martin and her colleagues is correct, what should happen in their experiment? What does the hypothesis will predict should happen?</p>
<p>Remember, they set up an outdoor experiment using lianas and trees. The factors that they controlled included,</p>
<ul>
<li>the growth habit (lianas and trees),</li>
<li>species of the lianas and trees, and</li>
<li>whether they watered to plants or not (all plants were outside and received ambient rainfall).</li>
</ul>
<p>Of course, they had replicate plants in every condition.</p>
<p>In each plot and for each plant, they measured,</p>
<ul>
<li>pre-dawn water potential,</li>
<li>midday water potential,</li>
<li>difference between pre-dawn and midday water potential</li>
<li>photosynthetic rate</li>
</ul>
<p>They collected these observations in five different months:</p>
<ul>
<li>during the dry season (March and April),</li>
<li>in the transition period between dry wet seasons (May), and</li>
<li>during the wet season (September and October).</li>
</ul>
</section>
</section>
<section id="predictions-1" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="predictions-1"><span class="header-section-number">4.3</span> Predictions</h2>
<p><strong>First</strong>, describe the hypothesis (i.e.&nbsp;how lianas vs.&nbsp;tress cope with dry periods) in your own words.</p>
<p><strong>Second</strong>, state two different predictions about how the factors they controlled would influence the responses they measured. Each prediction should</p>
<ol type="1">
<li>be consistent with the hypothesis, and</li>
<li>show the <em>differences</em> between lianas and trees.</li>
</ol>
<p>Remember, they were trying to figure out why lianas are so successful in highly seasonal environments. Explain the logic of each prediction.</p>
<p><strong>Third</strong>, draw with with pen(cil) and paper graphs illustrating your predictions. Take pictures of these graphs so that you can include them in your deliverables. The goal is to place side-by-side the independent variables that should differ - perhaps lianas and trees side-by-side, in a variety of situations.</p>
<p>Your job is to summarize the data in a way to evaluate and communicate the hypotheses. Think about how you can represent the prediction in a graph. <em>Each graph should use variables that you think will show lianas outperforming trees under the relevant conditions.</em></p>
<p>To evaluate a hypothesis and display it visually, we generally put a cause or independent variable on the horizontal <span class="math inline">\(x\)</span>-axis and the response or dependent variable on the <span class="math inline">\(y\)</span>-axis. For example, in the graphs above (<a href="#fig-lianas">Figure&nbsp;<span>4.1</span></a>), Schnitzer evaluated and then revealed to us the relations between deterministic causes on the <em>x</em>-axes and the biological responses on the <em>y</em>-axes.</p>
</section>
<section id="methods" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="methods"><span class="header-section-number">4.4</span> Methods</h2>
<section id="getting-organized" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="getting-organized"><span class="header-section-number">4.4.1</span> Getting organized</h3>
<p>First, we need to confirm that we are in the <code>Rwork</code> working directory, and import data. In RStudio, you should open your <code>Rwork</code> project.</p>
<p>Check the working directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Your working directory should be <code>Rwork</code>.</p>
<p>Load packages you need.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## alternatively you could load the entire tidyverse,</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">## which includes ggplot2 and dplyr</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidyverse)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-the-data" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="import-the-data"><span class="header-section-number">4.4.2</span> Import the data</h3>
<ol type="1">
<li>Go to our <a href="https://drive.google.com/drive/u/1/folders/1FR2FLiW3xyD4Er52YzVTToPZuXXReGRo" target="_blank">class data repository</a>, and download <code>SmithMartin.csv</code>.</li>
<li>Make sure the file remains in the same simple format, “comma separated values” (.csv).</li>
<li>Put <code>SmithMartin.csv</code> in your working directory, <code>Rwork</code>.</li>
<li>Continue to make sure the file remains in the same simple format, “comma separated values” (.csv).</li>
</ol>
<p>The first five lines contain metadata, so we skip those when we load the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>liana <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"SmithMartin.csv"</span>, <span class="co"># the CSV file name</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">skip=</span><span class="dv">5</span> <span class="co"># skip the 5 lines of metadata</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Check the names of variables in the data frame </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## so you know what you have</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(liana)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Plot"                  "Tag"                   "Season"               
 [4] "Month"                 "Treatment"             "Habit"                
 [7] "Species"               "PredawnMPa"            "MiddayMPa"            
[10] "MiddayMinusPredawnMPa" "Photo.umolCO2"        </code></pre>
</div>
</div>
<p>See for yourself the range in the numeric variables in the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>NumericVars <span class="ot">&lt;-</span> liana[, <span class="dv">8</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(NumericVars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   PredawnMPa        MiddayMPa      MiddayMinusPredawnMPa Photo.umolCO2    
 Min.   :-3.5500   Min.   :-4.942   Min.   :-3.3510       Min.   : 0.0483  
 1st Qu.:-0.6990   1st Qu.:-1.918   1st Qu.:-1.3690       1st Qu.: 4.9650  
 Median :-0.3940   Median :-1.472   Median :-1.0000       Median : 8.9600  
 Mean   :-0.5411   Mean   :-1.578   Mean   :-1.0365       Mean   : 8.9573  
 3rd Qu.:-0.2060   3rd Qu.:-1.105   3rd Qu.:-0.6438       3rd Qu.:12.6500  
 Max.   :-0.0200   Max.   :-0.197   Max.   : 0.0420       Max.   :21.6000  
 NA's   :11        NA's   :11       NA's   :11            NA's   :912      </code></pre>
</div>
</div>
<p>See for yourself the species of lianas and trees in the data set. This <code>table()</code> will count the number of rows associated with each species, whether it is a tree or a liana.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use 'with' to name a data frame</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>( liana,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>      <span class="co"># do something with variables in that data frame</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">table</span>(Species, Habit) </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># close the parenthesis</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Habit
Species                  liana tree
  Callichlamyslatifolia     83    0
  Crescentiacujete           0   78
  Davillakunthii           118    0
  Dipteryxoleifera           0   89
  Doliocarpusmajor         114    0
  Hieronymaalchorneoides     1   81
  Huracrepitans              0   65
  Machaeriummilleflorum    116    0
  Maripapanamensis         105    0
  Paulliniapinnata          98    0
  Swieteniamacrophylla       0   97
  Terminaliaamazonia         0  118</code></pre>
</div>
</div>
<p>Unless we tell it otherwise, R tends to sort words alphabetically. Months (January, February,…) have an order that is not alphabetical. Here, we make the variable <code>Month</code> a little more useful to us by turning it into a <em>factor</em> so that we can tell R how to order months.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>liana <span class="ot">&lt;-</span> liana <span class="sc">%&gt;%</span> <span class="co"># Start with your data frame</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## and make the change we want to the Month variable</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Month =</span> <span class="fu">factor</span>(Month, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Mar"</span>, <span class="st">"Apr"</span>, <span class="st">"May"</span>, <span class="st">"Sep"</span>, <span class="st">"Oct"</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="do">##...and show the unique values in Month, and also </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="do">## show us the sequential order</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(liana<span class="sc">$</span>Month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Apr Mar May Oct Sep
Levels: Mar Apr May Sep Oct</code></pre>
</div>
</div>
</section>
</section>
<section id="graphics" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="graphics"><span class="header-section-number">4.5</span> Graphics</h2>
<p>In this section, we continue to develop our expertise and comfort in making graphs of predictions and also in using the grammer of the <code>ggplot2</code> package <span class="citation" data-cites="wilkinson2005 wickham2016">(<a href="references.html#ref-wilkinson2005" role="doc-biblioref">Wilkinson 2005</a>; <a href="references.html#ref-wickham2016" role="doc-biblioref">Wickham 2016</a>)</span>. <code>ggplot()</code> graphics are designed for</p>
<ul>
<li>maximum communication: the goal of data display is communication, to ourselves and others,</li>
<li>transparency of coding: the code should be easy to read, so that the analyst and others can see what has been done, and</li>
<li>ease of use: the analyst and do a lot of different things relatively easily.</li>
</ul>
<section id="anatomy-of-ggplot" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="anatomy-of-ggplot"><span class="header-section-number">4.5.1</span> Anatomy of <code>ggplot()</code></h3>
<p>In making a graph, we specify,</p>
<ol type="1">
<li>the main function: <code>ggplot()</code></li>
<li>the data frame: <code>data=</code></li>
<li>the variables for each axis and any conditioning (these are named, oddly, “aesthetics”): <code>aes(...)</code></li>
<li>x and y variables: <code>aes(x=, y=)</code></li>
<li>conditioning variables, which allow us to show differences between levels of an independent variable : <code>aes(x=, y=, color=, linetype=,...)</code></li>
<li>the type of geometric display (e.g., box-and-whisker plot, scatterplot, columns, histogram, line graph, etc.): <code>geom_boxplot</code>, <code>geom_point()</code>, <code>geom_line()</code>, etc.</li>
<li>axis labels and other annotations: <code>labs(x=, y=,...)</code></li>
<li>facets (how we cut the data up top show different sides of the data): <code>facet_wrap( ~ groups)</code> or <code>facet_grid(row_groups ~ column_groups)</code>.</li>
</ol>
<p>So, let’s try some of this.</p>
</section>
<section id="examples-of-ggplot" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="examples-of-ggplot"><span class="header-section-number">4.5.2</span> Examples of <code>ggplot()</code></h3>
<p>Here we go.</p>
<p>A simple plot.</p>
<div class="cell" data-fig.label="fig_simple">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>liana, <span class="co"># we specify the data frame</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="co"># x-axis</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span> PredawnMPa <span class="co"># y-axis</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>          ) ) <span class="sc">+</span> <span class="co"># close parentheses and add a plus sign to add box and whisker plot </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-liana-phys_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Example of a simple box and whisker plot in ggplot(). Note the correspondance between the code and the figure. The data frame is ‘liana’. The x-axis is defined by x = Month. The y-axis (predawn water potential, in megapascals) is defined by y=PredawnMPa.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><em>Coding</em>: Note the correspondence between the graph and the elements of the code that made the graph.</p>
<p><em>Ecology</em>: Note the difference in predawn water potential in March and April, compared to September and Oct.&nbsp;What is water potential, and how does it change from the soil, to the root, stem, and leaf, and finally to the air? Remember that water moves from areas of higher moisture to areas of lower moisture, that is, <em>down gradients of water potential</em> from higher values to lower value, just like a ball rolling downhill. In which months is the soil driest?</p>
<p>Now let’s try a more complex figure, in which we add two conditioning variables, and more description label on the <span class="math inline">\(y\)</span>-axis. We color-code the first conditioning variable is the <em>treatment</em>, in which plants are watered or not. The second conditioning variable is <em>season</em> (dry, wet or transition), and we make separate <em>facets</em> or panels for that.</p>
<div class="cell" data-fig.label="fig-plotex">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## specifiy the data and most of the variables</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>liana, <span class="co"># we specify the data frame</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> Habit, <span class="co"># x-axis</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span> MiddayMPa, <span class="co"># y-axis</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> Treatment <span class="co"># conditioning variable. Examine the output to figure out what this does.</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>          ) ) <span class="sc">+</span> <span class="co"># close parentheses and add a plus sign to add box and whisker plot </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> <span class="co"># and add "faceting" to break it up by season.</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Season) <span class="sc">+</span> <span class="co"># the season</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Midday water potential (MPa)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03-liana-phys_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Example of a box and whisker plot in ggplot(). Note the correspondance between the code and the figure. The x-axis is defined by x = Habit. The y-axis (midday water potential, in megapascals) is defined by y=MiddayMPa. The data are further split by experimental treatment (watered vs.&nbsp;not watered), and that is defined by color = Treatment.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>And remember that you can save a graph to your wrorking directory using <code>ggsave()</code> right after you make your graph, like this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>liana, <span class="co"># we specify the data frame</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> Month, <span class="co"># x-axis</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">y=</span> MiddayMPa, <span class="co"># y-axis</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>          ) ) <span class="sc">+</span> <span class="co"># close parentheses and add a plus sign to add box and whisker plot </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03-liana-phys_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"myMiddayPlot.png"</span>, <span class="at">width=</span><span class="dv">4</span>, <span class="at">height=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 11 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
</div>
<p>The dimensions (in inches) of your <em>saved</em> graph dictate how big the labels and points look. If you make a small graph (e.g., width=3, height=3), the labels will look big by comparison. If you make a small graph (e.g., width=10, height=10), the labels will look small by comparison. Try it, and see for yourself.</p>
</section>
</section>
<section id="deliverables" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="deliverables"><span class="header-section-number">4.6</span> Deliverables</h2>
<p>Two documents:</p>
<p>A. The first document will contain:</p>
<ol type="1">
<li>A restatement, in your own words, of the hypothesis of Smith-Martin and her colleagues.</li>
<li>Two predictions of the hypothesis that you can evaluate using the data we have (see above).</li>
<li>Two graphs done in R that evaluate the hypothesis of Smith-Martin and her colleagues. The variables in the graphs must match the variables in you predictions.</li>
<li>For each graph, identify the independent variable(s) and the dependent variable(s).</li>
<li>For each graph, explain what the graph shows and what it tells us about the hypothesis. We can’t draw firm conclusions, so use terms such as “suggests”, “is consistent with”, “seems to show”, or others, which help avoid expressing unwarranted certainty. Even with careful analysis, we always have to be cautious.</li>
</ol>
<p>B. Your second document is your R script.</p>
<div class="cell">

</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-schnitzer2005" class="csl-entry" role="doc-biblioentry">
Schnitzer, S A. 2005. <span>“A Mechanistic Explanation for Global Patterns of Liana Abundance and Distribution.”</span> <em>American Naturalist</em> 166 (2): 262–76.
</div>
<div id="ref-smithmartin:2019aa" class="csl-entry" role="doc-biblioentry">
Smith-Martin, Chris M., Carolina L. Bastos, Omar R. Lopez, Jennifer S. Powers, and Stefan A. Schnitzer. 2019. <span>“Effects of Dry-Season Irrigation on Leaf Physiology and Biomass Allocation in Tropical Lianas and Trees.”</span> <em>Ecology</em> 100.
</div>
<div id="ref-wickham2016" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2016. <em>Ggplot2: <span>Elegant Graphics</span> for <span>Data Analysis</span></em>. <span>New York, NY</span>: <span>Springer-Verlag</span>.
</div>
<div id="ref-wilkinson2005" class="csl-entry" role="doc-biblioentry">
Wilkinson, Leland. 2005. <em>The <span>Grammar</span> of <span>Graphics</span></em>. Second. Statistics and Computing. <span>New York, NY</span>: <span>Spinger</span>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Note these explanations for hypothesis and prediction may differ from those often described in statistics classes.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-global_temp_anomalies.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Physical Environment: A Fate of Earth</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-extrapair_copulation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Behavior: Extra-pair copulation in a monogamous species</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>